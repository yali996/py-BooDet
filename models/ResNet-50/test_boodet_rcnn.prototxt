name: "ResNet-50"

input: "data"
input_shape {
  dim: 1
  dim: 3
  dim: 600
  dim: 800
}

input: "im_info"
input_shape {
  dim: 1
  dim: 3
}

# ---------- conv1 -----------------
layer {
	bottom: "data"
	top: "conv1"
	name: "conv1"
	type: "Convolution"
	convolution_param {
		num_output: 64
		kernel_size: 7
		pad: 3
		stride: 2
	}
    param { lr_mult: 0.0 }
    param { lr_mult: 0.0 }
}

layer {
	bottom: "conv1"
	top: "conv1"
	name: "bn_conv1"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "conv1"
	top: "conv1"
	name: "scale_conv1"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "conv1"
	top: "conv1"
	name: "conv1_relu"
	type: "ReLU"
}

layer {
	bottom: "conv1"
	top: "pool1"
	name: "pool1"
	type: "Pooling"
	pooling_param {
		kernel_size: 3
		stride: 2
		pool: MAX
                pad: 1
	}
}

layer {
	bottom: "pool1"
	top: "res2a_branch1"
	name: "res2a_branch1"
	type: "Convolution"
	convolution_param {
		num_output: 256
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
    param { lr_mult: 0.0 }
}

layer {
	bottom: "res2a_branch1"
	top: "res2a_branch1"
	name: "bn2a_branch1"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res2a_branch1"
	top: "res2a_branch1"
	name: "scale2a_branch1"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "pool1"
	top: "res2a_branch2a"
	name: "res2a_branch2a"
	type: "Convolution"
	convolution_param {
		num_output: 64
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
    param { lr_mult: 0.0 }
}

layer {
	bottom: "res2a_branch2a"
	top: "res2a_branch2a"
	name: "bn2a_branch2a"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res2a_branch2a"
	top: "res2a_branch2a"
	name: "scale2a_branch2a"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res2a_branch2a"
	top: "res2a_branch2a"
	name: "res2a_branch2a_relu"
	type: "ReLU"
}

layer {
	bottom: "res2a_branch2a"
	top: "res2a_branch2b"
	name: "res2a_branch2b"
	type: "Convolution"
	convolution_param {
		num_output: 64
		kernel_size: 3
		pad: 1
		stride: 1
		bias_term: false
	}
    param { lr_mult: 0.0 }
}

layer {
	bottom: "res2a_branch2b"
	top: "res2a_branch2b"
	name: "bn2a_branch2b"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res2a_branch2b"
	top: "res2a_branch2b"
	name: "scale2a_branch2b"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res2a_branch2b"
	top: "res2a_branch2b"
	name: "res2a_branch2b_relu"
	type: "ReLU"
}

layer {
	bottom: "res2a_branch2b"
	top: "res2a_branch2c"
	name: "res2a_branch2c"
	type: "Convolution"
	convolution_param {
		num_output: 256
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
    param { lr_mult: 0.0 }
}

layer {
	bottom: "res2a_branch2c"
	top: "res2a_branch2c"
	name: "bn2a_branch2c"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res2a_branch2c"
	top: "res2a_branch2c"
	name: "scale2a_branch2c"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res2a_branch1"
	bottom: "res2a_branch2c"
	top: "res2a"
	name: "res2a"
	type: "Eltwise"
}

layer {
	bottom: "res2a"
	top: "res2a"
	name: "res2a_relu"
	type: "ReLU"
}

layer {
	bottom: "res2a"
	top: "res2b_branch2a"
	name: "res2b_branch2a"
	type: "Convolution"
	convolution_param {
		num_output: 64
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
    param { lr_mult: 0.0 }
}

layer {
	bottom: "res2b_branch2a"
	top: "res2b_branch2a"
	name: "bn2b_branch2a"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res2b_branch2a"
	top: "res2b_branch2a"
	name: "scale2b_branch2a"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res2b_branch2a"
	top: "res2b_branch2a"
	name: "res2b_branch2a_relu"
	type: "ReLU"
}

layer {
	bottom: "res2b_branch2a"
	top: "res2b_branch2b"
	name: "res2b_branch2b"
	type: "Convolution"
	convolution_param {
		num_output: 64
		kernel_size: 3
		pad: 1
		stride: 1
		bias_term: false
	}
    param { lr_mult: 0.0 }
}

layer {
	bottom: "res2b_branch2b"
	top: "res2b_branch2b"
	name: "bn2b_branch2b"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res2b_branch2b"
	top: "res2b_branch2b"
	name: "scale2b_branch2b"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res2b_branch2b"
	top: "res2b_branch2b"
	name: "res2b_branch2b_relu"
	type: "ReLU"
}

layer {
	bottom: "res2b_branch2b"
	top: "res2b_branch2c"
	name: "res2b_branch2c"
	type: "Convolution"
	convolution_param {
		num_output: 256
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
    param { lr_mult: 0.0 }
}

layer {
	bottom: "res2b_branch2c"
	top: "res2b_branch2c"
	name: "bn2b_branch2c"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res2b_branch2c"
	top: "res2b_branch2c"
	name: "scale2b_branch2c"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res2a"
	bottom: "res2b_branch2c"
	top: "res2b"
	name: "res2b"
	type: "Eltwise"
}

layer {
	bottom: "res2b"
	top: "res2b"
	name: "res2b_relu"
	type: "ReLU"
}

layer {
	bottom: "res2b"
	top: "res2c_branch2a"
	name: "res2c_branch2a"
	type: "Convolution"
	convolution_param {
		num_output: 64
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
    param { lr_mult: 0.0 }
}

layer {
	bottom: "res2c_branch2a"
	top: "res2c_branch2a"
	name: "bn2c_branch2a"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res2c_branch2a"
	top: "res2c_branch2a"
	name: "scale2c_branch2a"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res2c_branch2a"
	top: "res2c_branch2a"
	name: "res2c_branch2a_relu"
	type: "ReLU"
}

layer {
	bottom: "res2c_branch2a"
	top: "res2c_branch2b"
	name: "res2c_branch2b"
	type: "Convolution"
	convolution_param {
		num_output: 64
		kernel_size: 3
		pad: 1
		stride: 1
		bias_term: false
	}
    param { lr_mult: 0.0 }
}

layer {
	bottom: "res2c_branch2b"
	top: "res2c_branch2b"
	name: "bn2c_branch2b"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res2c_branch2b"
	top: "res2c_branch2b"
	name: "scale2c_branch2b"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res2c_branch2b"
	top: "res2c_branch2b"
	name: "res2c_branch2b_relu"
	type: "ReLU"
}

layer {
	bottom: "res2c_branch2b"
	top: "res2c_branch2c"
	name: "res2c_branch2c"
	type: "Convolution"
	convolution_param {
		num_output: 256
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
    param { lr_mult: 0.0 }
}

layer {
	bottom: "res2c_branch2c"
	top: "res2c_branch2c"
	name: "bn2c_branch2c"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res2c_branch2c"
	top: "res2c_branch2c"
	name: "scale2c_branch2c"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res2b"
	bottom: "res2c_branch2c"
	top: "res2c"
	name: "res2c"
	type: "Eltwise"
}

layer {
	bottom: "res2c"
	top: "res2c"
	name: "res2c_relu"
	type: "ReLU"
}

layer {
	bottom: "res2c"
	top: "res3a_branch1"
	name: "res3a_branch1"
	type: "Convolution"
	convolution_param {
		num_output: 512
		kernel_size: 1
		pad: 0
		stride: 2
		bias_term: false
	}
    param { lr_mult: 1.0 }
}

layer {
	bottom: "res3a_branch1"
	top: "res3a_branch1"
	name: "bn3a_branch1"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3a_branch1"
	top: "res3a_branch1"
	name: "scale3a_branch1"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res2c"
	top: "res3a_branch2a"
	name: "res3a_branch2a"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 128
		kernel_size: 1
		pad: 0
		stride: 2
		bias_term: false
	}
}

layer {
	bottom: "res3a_branch2a"
	top: "res3a_branch2a"
	name: "bn3a_branch2a"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3a_branch2a"
	top: "res3a_branch2a"
	name: "scale3a_branch2a"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3a_branch2a"
	top: "res3a_branch2a"
	name: "res3a_branch2a_relu"
	type: "ReLU"
}

layer {
	bottom: "res3a_branch2a"
	top: "res3a_branch2b"
	name: "res3a_branch2b"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 128
		kernel_size: 3
		pad: 1
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res3a_branch2b"
	top: "res3a_branch2b"
	name: "bn3a_branch2b"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3a_branch2b"
	top: "res3a_branch2b"
	name: "scale3a_branch2b"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3a_branch2b"
	top: "res3a_branch2b"
	name: "res3a_branch2b_relu"
	type: "ReLU"
}

layer {
	bottom: "res3a_branch2b"
	top: "res3a_branch2c"
	name: "res3a_branch2c"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 512
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res3a_branch2c"
	top: "res3a_branch2c"
	name: "bn3a_branch2c"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3a_branch2c"
	top: "res3a_branch2c"
	name: "scale3a_branch2c"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3a_branch1"
	bottom: "res3a_branch2c"
	top: "res3a"
	name: "res3a"
	type: "Eltwise"
}

layer {
	bottom: "res3a"
	top: "res3a"
	name: "res3a_relu"
	type: "ReLU"
}

layer {
	bottom: "res3a"
	top: "res3b_branch2a"
	name: "res3b_branch2a"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 128
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res3b_branch2a"
	top: "res3b_branch2a"
	name: "bn3b_branch2a"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3b_branch2a"
	top: "res3b_branch2a"
	name: "scale3b_branch2a"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3b_branch2a"
	top: "res3b_branch2a"
	name: "res3b_branch2a_relu"
	type: "ReLU"
}

layer {
	bottom: "res3b_branch2a"
	top: "res3b_branch2b"
	name: "res3b_branch2b"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 128
		kernel_size: 3
		pad: 1
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res3b_branch2b"
	top: "res3b_branch2b"
	name: "bn3b_branch2b"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3b_branch2b"
	top: "res3b_branch2b"
	name: "scale3b_branch2b"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3b_branch2b"
	top: "res3b_branch2b"
	name: "res3b_branch2b_relu"
	type: "ReLU"
}

layer {
	bottom: "res3b_branch2b"
	top: "res3b_branch2c"
	name: "res3b_branch2c"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 512
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res3b_branch2c"
	top: "res3b_branch2c"
	name: "bn3b_branch2c"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3b_branch2c"
	top: "res3b_branch2c"
	name: "scale3b_branch2c"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3a"
	bottom: "res3b_branch2c"
	top: "res3b"
	name: "res3b"
	type: "Eltwise"
}

layer {
	bottom: "res3b"
	top: "res3b"
	name: "res3b_relu"
	type: "ReLU"
}

layer {
	bottom: "res3b"
	top: "res3c_branch2a"
	name: "res3c_branch2a"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 128
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res3c_branch2a"
	top: "res3c_branch2a"
	name: "bn3c_branch2a"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3c_branch2a"
	top: "res3c_branch2a"
	name: "scale3c_branch2a"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3c_branch2a"
	top: "res3c_branch2a"
	name: "res3c_branch2a_relu"
	type: "ReLU"
}

layer {
	bottom: "res3c_branch2a"
	top: "res3c_branch2b"
	name: "res3c_branch2b"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 128
		kernel_size: 3
		pad: 1
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res3c_branch2b"
	top: "res3c_branch2b"
	name: "bn3c_branch2b"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3c_branch2b"
	top: "res3c_branch2b"
	name: "scale3c_branch2b"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3c_branch2b"
	top: "res3c_branch2b"
	name: "res3c_branch2b_relu"
	type: "ReLU"
}

layer {
	bottom: "res3c_branch2b"
	top: "res3c_branch2c"
	name: "res3c_branch2c"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 512
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res3c_branch2c"
	top: "res3c_branch2c"
	name: "bn3c_branch2c"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3c_branch2c"
	top: "res3c_branch2c"
	name: "scale3c_branch2c"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3b"
	bottom: "res3c_branch2c"
	top: "res3c"
	name: "res3c"
	type: "Eltwise"
}

layer {
	bottom: "res3c"
	top: "res3c"
	name: "res3c_relu"
	type: "ReLU"
}

layer {
	bottom: "res3c"
	top: "res3d_branch2a"
	name: "res3d_branch2a"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 128
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res3d_branch2a"
	top: "res3d_branch2a"
	name: "bn3d_branch2a"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3d_branch2a"
	top: "res3d_branch2a"
	name: "scale3d_branch2a"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3d_branch2a"
	top: "res3d_branch2a"
	name: "res3d_branch2a_relu"
	type: "ReLU"
}

layer {
	bottom: "res3d_branch2a"
	top: "res3d_branch2b"
	name: "res3d_branch2b"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 128
		kernel_size: 3
		pad: 1
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res3d_branch2b"
	top: "res3d_branch2b"
	name: "bn3d_branch2b"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3d_branch2b"
	top: "res3d_branch2b"
	name: "scale3d_branch2b"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3d_branch2b"
	top: "res3d_branch2b"
	name: "res3d_branch2b_relu"
	type: "ReLU"
}

layer {
	bottom: "res3d_branch2b"
	top: "res3d_branch2c"
	name: "res3d_branch2c"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 512
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res3d_branch2c"
	top: "res3d_branch2c"
	name: "bn3d_branch2c"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3d_branch2c"
	top: "res3d_branch2c"
	name: "scale3d_branch2c"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3c"
	bottom: "res3d_branch2c"
	top: "res3d"
	name: "res3d"
	type: "Eltwise"
}

layer {
	bottom: "res3d"
	top: "res3d"
	name: "res3d_relu"
	type: "ReLU"
}

layer {
	bottom: "res3d"
	top: "res4a_branch1"
	name: "res4a_branch1"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 1024
		kernel_size: 1
		pad: 0
		stride: 2
		bias_term: false
	}
}

layer {
	bottom: "res4a_branch1"
	top: "res4a_branch1"
	name: "bn4a_branch1"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4a_branch1"
	top: "res4a_branch1"
	name: "scale4a_branch1"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3d"
	top: "res4a_branch2a"
	name: "res4a_branch2a"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 256
		kernel_size: 1
		pad: 0
		stride: 2
		bias_term: false
	}
}

layer {
	bottom: "res4a_branch2a"
	top: "res4a_branch2a"
	name: "bn4a_branch2a"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4a_branch2a"
	top: "res4a_branch2a"
	name: "scale4a_branch2a"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4a_branch2a"
	top: "res4a_branch2a"
	name: "res4a_branch2a_relu"
	type: "ReLU"
}

layer {
	bottom: "res4a_branch2a"
	top: "res4a_branch2b"
	name: "res4a_branch2b"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 256
		kernel_size: 3
		pad: 1
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res4a_branch2b"
	top: "res4a_branch2b"
	name: "bn4a_branch2b"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4a_branch2b"
	top: "res4a_branch2b"
	name: "scale4a_branch2b"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4a_branch2b"
	top: "res4a_branch2b"
	name: "res4a_branch2b_relu"
	type: "ReLU"
}

layer {
	bottom: "res4a_branch2b"
	top: "res4a_branch2c"
	name: "res4a_branch2c"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 1024
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res4a_branch2c"
	top: "res4a_branch2c"
	name: "bn4a_branch2c"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4a_branch2c"
	top: "res4a_branch2c"
	name: "scale4a_branch2c"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4a_branch1"
	bottom: "res4a_branch2c"
	top: "res4a"
	name: "res4a"
	type: "Eltwise"
}

layer {
	bottom: "res4a"
	top: "res4a"
	name: "res4a_relu"
	type: "ReLU"
}

layer {
	bottom: "res4a"
	top: "res4b_branch2a"
	name: "res4b_branch2a"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 256
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res4b_branch2a"
	top: "res4b_branch2a"
	name: "bn4b_branch2a"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4b_branch2a"
	top: "res4b_branch2a"
	name: "scale4b_branch2a"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4b_branch2a"
	top: "res4b_branch2a"
	name: "res4b_branch2a_relu"
	type: "ReLU"
}

layer {
	bottom: "res4b_branch2a"
	top: "res4b_branch2b"
	name: "res4b_branch2b"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 256
		kernel_size: 3
		pad: 1
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res4b_branch2b"
	top: "res4b_branch2b"
	name: "bn4b_branch2b"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4b_branch2b"
	top: "res4b_branch2b"
	name: "scale4b_branch2b"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4b_branch2b"
	top: "res4b_branch2b"
	name: "res4b_branch2b_relu"
	type: "ReLU"
}

layer {
	bottom: "res4b_branch2b"
	top: "res4b_branch2c"
	name: "res4b_branch2c"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 1024
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res4b_branch2c"
	top: "res4b_branch2c"
	name: "bn4b_branch2c"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4b_branch2c"
	top: "res4b_branch2c"
	name: "scale4b_branch2c"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4a"
	bottom: "res4b_branch2c"
	top: "res4b"
	name: "res4b"
	type: "Eltwise"
}

layer {
	bottom: "res4b"
	top: "res4b"
	name: "res4b_relu"
	type: "ReLU"
}

layer {
	bottom: "res4b"
	top: "res4c_branch2a"
	name: "res4c_branch2a"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 256
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res4c_branch2a"
	top: "res4c_branch2a"
	name: "bn4c_branch2a"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4c_branch2a"
	top: "res4c_branch2a"
	name: "scale4c_branch2a"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4c_branch2a"
	top: "res4c_branch2a"
	name: "res4c_branch2a_relu"
	type: "ReLU"
}

layer {
	bottom: "res4c_branch2a"
	top: "res4c_branch2b"
	name: "res4c_branch2b"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 256
		kernel_size: 3
		pad: 1
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res4c_branch2b"
	top: "res4c_branch2b"
	name: "bn4c_branch2b"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4c_branch2b"
	top: "res4c_branch2b"
	name: "scale4c_branch2b"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4c_branch2b"
	top: "res4c_branch2b"
	name: "res4c_branch2b_relu"
	type: "ReLU"
}

layer {
	bottom: "res4c_branch2b"
	top: "res4c_branch2c"
	name: "res4c_branch2c"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 1024
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res4c_branch2c"
	top: "res4c_branch2c"
	name: "bn4c_branch2c"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4c_branch2c"
	top: "res4c_branch2c"
	name: "scale4c_branch2c"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4b"
	bottom: "res4c_branch2c"
	top: "res4c"
	name: "res4c"
	type: "Eltwise"
}

layer {
	bottom: "res4c"
	top: "res4c"
	name: "res4c_relu"
	type: "ReLU"
}

layer {
	bottom: "res4c"
	top: "res4d_branch2a"
	name: "res4d_branch2a"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 256
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res4d_branch2a"
	top: "res4d_branch2a"
	name: "bn4d_branch2a"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4d_branch2a"
	top: "res4d_branch2a"
	name: "scale4d_branch2a"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4d_branch2a"
	top: "res4d_branch2a"
	name: "res4d_branch2a_relu"
	type: "ReLU"
}

layer {
	bottom: "res4d_branch2a"
	top: "res4d_branch2b"
	name: "res4d_branch2b"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 256
		kernel_size: 3
		pad: 1
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res4d_branch2b"
	top: "res4d_branch2b"
	name: "bn4d_branch2b"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4d_branch2b"
	top: "res4d_branch2b"
	name: "scale4d_branch2b"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4d_branch2b"
	top: "res4d_branch2b"
	name: "res4d_branch2b_relu"
	type: "ReLU"
}

layer {
	bottom: "res4d_branch2b"
	top: "res4d_branch2c"
	name: "res4d_branch2c"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 1024
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res4d_branch2c"
	top: "res4d_branch2c"
	name: "bn4d_branch2c"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4d_branch2c"
	top: "res4d_branch2c"
	name: "scale4d_branch2c"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4c"
	bottom: "res4d_branch2c"
	top: "res4d"
	name: "res4d"
	type: "Eltwise"
}

layer {
	bottom: "res4d"
	top: "res4d"
	name: "res4d_relu"
	type: "ReLU"
}

layer {
	bottom: "res4d"
	top: "res4e_branch2a"
	name: "res4e_branch2a"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 256
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res4e_branch2a"
	top: "res4e_branch2a"
	name: "bn4e_branch2a"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4e_branch2a"
	top: "res4e_branch2a"
	name: "scale4e_branch2a"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4e_branch2a"
	top: "res4e_branch2a"
	name: "res4e_branch2a_relu"
	type: "ReLU"
}

layer {
	bottom: "res4e_branch2a"
	top: "res4e_branch2b"
	name: "res4e_branch2b"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 256
		kernel_size: 3
		pad: 1
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res4e_branch2b"
	top: "res4e_branch2b"
	name: "bn4e_branch2b"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4e_branch2b"
	top: "res4e_branch2b"
	name: "scale4e_branch2b"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4e_branch2b"
	top: "res4e_branch2b"
	name: "res4e_branch2b_relu"
	type: "ReLU"
}

layer {
	bottom: "res4e_branch2b"
	top: "res4e_branch2c"
	name: "res4e_branch2c"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 1024
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res4e_branch2c"
	top: "res4e_branch2c"
	name: "bn4e_branch2c"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4e_branch2c"
	top: "res4e_branch2c"
	name: "scale4e_branch2c"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4d"
	bottom: "res4e_branch2c"
	top: "res4e"
	name: "res4e"
	type: "Eltwise"
}

layer {
	bottom: "res4e"
	top: "res4e"
	name: "res4e_relu"
	type: "ReLU"
}

layer {
	bottom: "res4e"
	top: "res4f_branch2a"
	name: "res4f_branch2a"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 256
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res4f_branch2a"
	top: "res4f_branch2a"
	name: "bn4f_branch2a"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4f_branch2a"
	top: "res4f_branch2a"
	name: "scale4f_branch2a"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4f_branch2a"
	top: "res4f_branch2a"
	name: "res4f_branch2a_relu"
	type: "ReLU"
}

layer {
	bottom: "res4f_branch2a"
	top: "res4f_branch2b"
	name: "res4f_branch2b"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 256
		kernel_size: 3
		pad: 1
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res4f_branch2b"
	top: "res4f_branch2b"
	name: "bn4f_branch2b"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4f_branch2b"
	top: "res4f_branch2b"
	name: "scale4f_branch2b"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4f_branch2b"
	top: "res4f_branch2b"
	name: "res4f_branch2b_relu"
	type: "ReLU"
}

layer {
	bottom: "res4f_branch2b"
	top: "res4f_branch2c"
	name: "res4f_branch2c"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 1024
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res4f_branch2c"
	top: "res4f_branch2c"
	name: "bn4f_branch2c"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4f_branch2c"
	top: "res4f_branch2c"
	name: "scale4f_branch2c"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4e"
	bottom: "res4f_branch2c"
	top: "res4f"
	name: "res4f"
	type: "Eltwise"
}

layer {
	bottom: "res4f"
	top: "res4f"
	name: "res4f_relu"
	type: "ReLU"
}

layer {
	bottom: "res4f"
	top: "res5a_branch1"
	name: "res5a_branch1"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 2048
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res5a_branch1"
	top: "res5a_branch1"
	name: "bn5a_branch1"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res5a_branch1"
	top: "res5a_branch1"
	name: "scale5a_branch1"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4f"
	top: "res5a_branch2a"
	name: "res5a_branch2a"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 512
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res5a_branch2a"
	top: "res5a_branch2a"
	name: "bn5a_branch2a"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res5a_branch2a"
	top: "res5a_branch2a"
	name: "scale5a_branch2a"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res5a_branch2a"
	top: "res5a_branch2a"
	name: "res5a_branch2a_relu"
	type: "ReLU"
}

layer {
	bottom: "res5a_branch2a"
	top: "res5a_branch2b"
	name: "res5a_branch2b"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 512
		kernel_size: 3
		pad: 2 dilation: 2
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res5a_branch2b"
	top: "res5a_branch2b"
	name: "bn5a_branch2b"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res5a_branch2b"
	top: "res5a_branch2b"
	name: "scale5a_branch2b"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res5a_branch2b"
	top: "res5a_branch2b"
	name: "res5a_branch2b_relu"
	type: "ReLU"
}

layer {
	bottom: "res5a_branch2b"
	top: "res5a_branch2c"
	name: "res5a_branch2c"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 2048
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res5a_branch2c"
	top: "res5a_branch2c"
	name: "bn5a_branch2c"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res5a_branch2c"
	top: "res5a_branch2c"
	name: "scale5a_branch2c"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res5a_branch1"
	bottom: "res5a_branch2c"
	top: "res5a"
	name: "res5a"
	type: "Eltwise"
}

layer {
	bottom: "res5a"
	top: "res5a"
	name: "res5a_relu"
	type: "ReLU"
}

layer {
	bottom: "res5a"
	top: "res5b_branch2a"
	name: "res5b_branch2a"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 512
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res5b_branch2a"
	top: "res5b_branch2a"
	name: "bn5b_branch2a"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res5b_branch2a"
	top: "res5b_branch2a"
	name: "scale5b_branch2a"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res5b_branch2a"
	top: "res5b_branch2a"
	name: "res5b_branch2a_relu"
	type: "ReLU"
}

layer {
	bottom: "res5b_branch2a"
	top: "res5b_branch2b"
	name: "res5b_branch2b"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 512
		kernel_size: 3
		pad: 2 dilation: 2
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res5b_branch2b"
	top: "res5b_branch2b"
	name: "bn5b_branch2b"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res5b_branch2b"
	top: "res5b_branch2b"
	name: "scale5b_branch2b"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res5b_branch2b"
	top: "res5b_branch2b"
	name: "res5b_branch2b_relu"
	type: "ReLU"
}

layer {
	bottom: "res5b_branch2b"
	top: "res5b_branch2c"
	name: "res5b_branch2c"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 2048
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res5b_branch2c"
	top: "res5b_branch2c"
	name: "bn5b_branch2c"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res5b_branch2c"
	top: "res5b_branch2c"
	name: "scale5b_branch2c"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res5a"
	bottom: "res5b_branch2c"
	top: "res5b"
	name: "res5b"
	type: "Eltwise"
}

layer {
	bottom: "res5b"
	top: "res5b"
	name: "res5b_relu"
	type: "ReLU"
}

layer {
	bottom: "res5b"
	top: "res5c_branch2a"
	name: "res5c_branch2a"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 512
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res5c_branch2a"
	top: "res5c_branch2a"
	name: "bn5c_branch2a"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res5c_branch2a"
	top: "res5c_branch2a"
	name: "scale5c_branch2a"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}
layer {
	bottom: "res5c_branch2a"
	top: "res5c_branch2a"
	name: "res5c_branch2a_relu"
	type: "ReLU"
}
layer {
	bottom: "res5c_branch2a"
	top: "res5c_branch2b"
	name: "res5c_branch2b"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 512
		kernel_size: 3
		pad: 2 dilation: 2
		stride: 1
		bias_term: false
	}
}
layer {
	bottom: "res5c_branch2b"
	top: "res5c_branch2b"
	name: "bn5c_branch2b"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}
layer {
	bottom: "res5c_branch2b"
	top: "res5c_branch2b"
	name: "scale5c_branch2b"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}
layer {
	bottom: "res5c_branch2b"
	top: "res5c_branch2b"
	name: "res5c_branch2b_relu"
	type: "ReLU"
}

layer {
	bottom: "res5c_branch2b"
	top: "res5c_branch2c"
	name: "res5c_branch2c"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 2048
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res5c_branch2c"
	top: "res5c_branch2c"
	name: "bn5c_branch2c"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res5c_branch2c"
	top: "res5c_branch2c"
	name: "scale5c_branch2c"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res5b"
	bottom: "res5c_branch2c"
	top: "res5c"
	name: "res5c"
	type: "Eltwise"
}

layer {
	bottom: "res5c"
	top: "res5c"
	name: "res5c_relu"
	type: "ReLU"
}

#============== FPN ==============
layer {
  name: "fpn_pool5"
  type: "Convolution"
  bottom: "res5c"
  top: "fpn_conv5"
  param { lr_mult: 1 decay_mult: 1.0 }
  param { lr_mult: 2 decay_mult: 0.0 }
  convolution_param {
    num_output: 256
    kernel_size: 1
    stride: 1 pad: 0
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" std: 0 }
  }
}
layer {
  name: "fpn_P5"
  type: "Pooling"
  bottom: "fpn_conv5"
  top: "fpn_pool5"
  pooling_param {
     kernel_size: 2
     stride: 2
     pool: MAX
  }
}
layer {
  bottom: "fpn_pool5"
  top: "fpn_pool5"
  name: "fpn_pool5/gn"
  type: "GroupNorm"
} 
layer {
  name: "fpn_conv4"
  type: "Convolution"
  bottom: "res4f"
  top: "fpn_conv4"
  param { lr_mult: 1 }
  param { lr_mult: 2 }
  convolution_param {
    num_output: 256
    kernel_size: 1
    stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" std: 0 }
  }
}
layer { 
    name: "fpn_merge_conv4"
    bottom: "fpn_conv5"
    bottom: "fpn_conv4"
    top: "fpn_merge_conv4"
    type: "Eltwise"
}
layer {
  name: "fpn_pool4"
  type: "Convolution"
  bottom: "fpn_merge_conv4"
  top: "fpn_pool4"
  param { lr_mult: 1 }
  param { lr_mult: 2 }
  convolution_param {
    num_output: 256
    kernel_size: 3 stride: 1 pad: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" std: 0 }
  }
}
layer {
  bottom: "fpn_pool4"
  top: "fpn_pool4"
  name: "fpn_pool4/gn"
  type: "GroupNorm"
} 
layer {
  name: "fpn_upscore_conv4"
  type: "Upsample"
  bottom: "fpn_pool4"
  top: "fpn_upscore_conv4"
  upsample_param { scale: 2 }
}
layer {
  name: "fpn_conv3"
  type: "Convolution"
  bottom: "res3d"
  top: "fpn_conv3"
  param { lr_mult: 1 }
  param { lr_mult: 2 }
  convolution_param {
    num_output: 256 
    kernel_size: 1
    stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" std: 0 }
  }
}
layer {
  name: "fpn_upscore_conv4_crop"
  type: "Crop"
  bottom: "fpn_upscore_conv4"
  bottom: "fpn_conv3"
  top: "fpn_upscore_conv4_crop"
  crop_param { axis: 2 offset: 0 }
}
layer {
    name: "fpn_merge_conv3"
    bottom: "fpn_upscore_conv4_crop"
    bottom: "fpn_conv3"
    top: "fpn_merge_conv3"
    type: "Eltwise"
}
layer {
  name: "fpn_pool3"
  type: "Convolution"
  bottom: "fpn_merge_conv3"
  top: "fpn_pool3"
  param { lr_mult: 1 }
  param { lr_mult: 2 }
  convolution_param {
    num_output: 256
    kernel_size: 3 stride: 1 pad: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" std: 0 }
  }
}
layer {
  bottom: "fpn_pool3"
  top: "fpn_pool3"
  name: "fpn_pool3/gn"
  type: "GroupNorm"
} 
layer {
  name: "fpn_pool6"
  type: "Convolution"
  bottom: "res5c"
  top: "fpn_pool6"
  param { lr_mult: 1 }
  param { lr_mult: 2 }
  convolution_param {
    num_output: 256
    kernel_size: 3 stride: 4 pad: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" std: 0 }
  }
}
layer {
  bottom: "fpn_pool6"
  top: "fpn_pool6"
  name: "fpn_pool6/gn"
  type: "GroupNorm"
} 
layer {
   top: "fpn_relu6"
   bottom: "fpn_pool6"
   name: "fpn_relu6"
   type: "ReLU"
}

layer {
  name: "fpn_pool7"
  type: "Convolution"
  bottom: "fpn_relu6"
  top: "fpn_pool7"
  param { lr_mult: 1 }
  param { lr_mult: 2 }
  convolution_param {
    num_output: 256
    kernel_size: 3 stride: 2 pad: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" std: 0 }
  }
}
layer {
  bottom: "fpn_pool7"
  top: "fpn_pool7"
  name: "fpn_pool7/gn"
  type: "GroupNorm"
}

#============ RPN Pool3============
layer {
  name: "fpn_conv3x3_P3_CA1"
  type: "Convolution"
  bottom: "fpn_pool3"
  top: "fpn_conv3x3_P3_CA1"
  param { name: "fpn_conv3x3_cw1" lr_mult: 1.0 decay_mult: 1.0 }
  convolution_param {
    bias_term: false
    num_output: 256
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
  }
}
layer {
  name: "fpn_conv3x3_P3_CA1/gn"
  type: "GroupNorm"
  bottom: "fpn_conv3x3_P3_CA1"
  top: "fpn_conv3x3_P3_CA1"
}
layer {
  name: "fpn_conv3x3_P3_CA1/gn/scale"
  type: "Scale"
  bottom: "fpn_conv3x3_P3_CA1"
  top: "fpn_conv3x3_P3_CA1"
  scale_param {
    bias_term: true
    filler { type: "constant" value: 1 }
    bias_filler { type: "constant" value: 0 }
  }
  param { name: "fpn_conv3x3_cs1" lr_mult: 1.0 decay_mult: 0.0 }
  param { name: "fpn_conv3x3_cb1" lr_mult: 2.0 decay_mult: 0 }
}
layer {
  name: "fpn_relu3x3_P3_CA1"
  type: "ReLU"
  bottom: "fpn_conv3x3_P3_CA1"
  top: "fpn_conv3x3_P3_CA1"
}
layer {
  name: "fpn_conv3x3_P3_CA2"
  type: "Convolution"
  bottom: "fpn_conv3x3_P3_CA1"
  top: "fpn_conv3x3_P3_CA2"
  param { name: "fpn_conv3x3_cw2" lr_mult: 1.0 decay_mult: 1.0 }
  convolution_param {
    bias_term: false
    num_output: 256
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
  }
}
layer {
  name: "fpn_conv3x3_P3_CA2/gn"
  type: "GroupNorm"
  bottom: "fpn_conv3x3_P3_CA2"
  top: "fpn_conv3x3_P3_CA2"
}
layer {
  name: "fpn_conv3x3_P3_CA2/gn/scale"
  type: "Scale"
  bottom: "fpn_conv3x3_P3_CA2"
  top: "fpn_conv3x3_P3_CA2"
  scale_param {
    bias_term: true
    filler { type: "constant" value: 1 }
    bias_filler { type: "constant" value: 0 }
  }
  param { name: "fpn_conv3x3_cs2" lr_mult: 1.0 decay_mult: 0.0 }
  param { name: "fpn_conv3x3_cb2" lr_mult: 2.0 decay_mult: 0 }
}
layer {
  name: "fpn_relu3x3_P3_CA2"
  type: "ReLU"
  bottom: "fpn_conv3x3_P3_CA2"
  top: "fpn_conv3x3_P3_CA2"
}
layer {
  name: "fpn_conv3x3_P3_BA1"
  type: "Convolution"
  bottom: "fpn_pool3"
  top: "fpn_conv3x3_P3_BA1"
  param { name: "fpn_conv3x3_bw1" lr_mult: 1.0 decay_mult: 1.0 }
  convolution_param {
    bias_term: false
    num_output: 256
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
  }
}
layer {
  name: "fpn_conv3x3_P3_BA1/gn"
  type: "GroupNorm"
  bottom: "fpn_conv3x3_P3_BA1"
  top: "fpn_conv3x3_P3_BA1"
}
layer {
  name: "fpn_conv3x3_P3_BA1/gn/scale"
  type: "Scale"
  bottom: "fpn_conv3x3_P3_BA1"
  top: "fpn_conv3x3_P3_BA1"
  scale_param {
    bias_term: true
    filler { type: "constant" value: 1 }
    bias_filler { type: "constant" value: 0 }
  }
  param { name: "fpn_conv3x3_bs1" lr_mult: 1.0 decay_mult: 0.0 }
  param { name: "fpn_conv3x3_bb1" lr_mult: 2.0 decay_mult: 0 }
}
layer {
  name: "fpn_relu3x3_P3_BA1"
  type: "ReLU"
  bottom: "fpn_conv3x3_P3_BA1"
  top: "fpn_conv3x3_P3_BA1"
}
layer {
  name: "fpn_conv3x3_P3_BA2"
  type: "Convolution"
  bottom: "fpn_conv3x3_P3_BA1"
  top: "fpn_conv3x3_P3_BA2"
  param { name: "fpn_conv3x3_bw2" lr_mult: 1.0 decay_mult: 1.0 }
  convolution_param {
    bias_term: false
    num_output: 256
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
  }
}
layer {
  name: "fpn_conv3x3_P3_BA2/gn"
  type: "GroupNorm"
  bottom: "fpn_conv3x3_P3_BA2"
  top: "fpn_conv3x3_P3_BA2"
}
layer {
  name: "fpn_conv3x3_P3_BA2/gn/scale"
  type: "Scale"
  bottom: "fpn_conv3x3_P3_BA2"
  top: "fpn_conv3x3_P3_BA2"
  scale_param {
    bias_term: true
    filler { type: "constant" value: 1 }
    bias_filler { type: "constant" value: 0 }
  }
  param { name: "fpn_conv3x3_bs2" lr_mult: 1.0 decay_mult: 0.0 }
  param { name: "fpn_conv3x3_bb2" lr_mult: 2.0 decay_mult: 0 }
}
layer {
  name: "fpn_relu3x3_P3_BA2"
  type: "ReLU"
  bottom: "fpn_conv3x3_P3_BA2"
  top: "fpn_conv3x3_P3_BA2"
}
layer {
  name: "cls_score_P3"
  type: "Convolution"
  bottom: "fpn_conv3x3_P3_CA2"
  top: "cls_score_P3"
  param { name: "cls_score_w" lr_mult: 1.0 decay_mult: 1.0 }
  param { name: "cls_score_b" lr_mult: 2.0 decay_mult: 0.0 }
  convolution_param {
    num_output: 480   # 80 (classes) * 9(anchors)
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" value: -4.595 }
  }
}
layer {
  name: "bbox_pred_P3"
  type: "Convolution"
  bottom: "fpn_conv3x3_P3_BA2"
  top: "bbox_pred_P3"
  param { name: "bbox_pred_w" lr_mult: 1.0 decay_mult: 1.0 }
  param { name: "bbox_pred_b" lr_mult: 2.0 decay_mult: 0 }
  convolution_param {
    num_output: 24   # 4 * 9(anchors)
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" value: 0 }
  }
}

#============ RPN Pool4============
layer {
  name: "fpn_conv3x3_P4_CA1"
  type: "Convolution"
  bottom: "fpn_pool4"
  top: "fpn_conv3x3_P4_CA1"
  param { name: "fpn_conv3x3_cw1" lr_mult: 1.0 decay_mult: 1.0 }
  convolution_param {
    bias_term: false
    num_output: 256
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
  }
}
layer {
  name: "fpn_conv3x3_P4_CA1/gn"
  type: "GroupNorm"
  bottom: "fpn_conv3x3_P4_CA1"
  top: "fpn_conv3x3_P4_CA1"
}
layer {
  name: "fpn_conv3x3_P4_CA1/gn/scale"
  type: "Scale"
  bottom: "fpn_conv3x3_P4_CA1"
  top: "fpn_conv3x3_P4_CA1"
  scale_param {
    bias_term: true
    filler { type: "constant" value: 1 }
    bias_filler { type: "constant" value: 0 }
  }
  param { name: "fpn_conv3x3_cs1" lr_mult: 1.0 decay_mult: 0.0 }
  param { name: "fpn_conv3x3_cb1" lr_mult: 2.0 decay_mult: 0 }
}
layer {
  name: "fpn_relu3x3_P4_CA1"
  type: "ReLU"
  bottom: "fpn_conv3x3_P4_CA1"
  top: "fpn_conv3x3_P4_CA1"
}
layer {
  name: "fpn_conv3x3_P4_CA2"
  type: "Convolution"
  bottom: "fpn_conv3x3_P4_CA1"
  top: "fpn_conv3x3_P4_CA2"
  param { name: "fpn_conv3x3_cw2" lr_mult: 1.0 decay_mult: 1.0 }
  convolution_param {
    bias_term: false
    num_output: 256
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
  }
}
layer {
  name: "fpn_conv3x3_P4_CA2/gn"
  type: "GroupNorm"
  bottom: "fpn_conv3x3_P4_CA2"
  top: "fpn_conv3x3_P4_CA2"
}
layer {
  name: "fpn_conv3x3_P4_CA2/gn/scale"
  type: "Scale"
  bottom: "fpn_conv3x3_P4_CA2"
  top: "fpn_conv3x3_P4_CA2"
  scale_param {
    bias_term: true
    filler { type: "constant" value: 1 }
    bias_filler { type: "constant" value: 0 }
  }
  param { name: "fpn_conv3x3_cs2" lr_mult: 1.0 decay_mult: 0.0 }
  param { name: "fpn_conv3x3_cb2" lr_mult: 2.0 decay_mult: 0 }
}
layer {
  name: "fpn_relu3x3_P4_CA2"
  type: "ReLU"
  bottom: "fpn_conv3x3_P4_CA2"
  top: "fpn_conv3x3_P4_CA2"
}
layer {
  name: "fpn_conv3x3_P4_BA1"
  type: "Convolution"
  bottom: "fpn_pool4"
  top: "fpn_conv3x3_P4_BA1"
  param { name: "fpn_conv3x3_bw1" lr_mult: 1.0 decay_mult: 1.0 }
  convolution_param {
    bias_term: false
    num_output: 256
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
  }
}
layer {
  name: "fpn_conv3x3_P4_BA1/gn"
  type: "GroupNorm"
  bottom: "fpn_conv3x3_P4_BA1"
  top: "fpn_conv3x3_P4_BA1"
}
layer {
  name: "fpn_conv3x3_P4_BA1/gn/scale"
  type: "Scale"
  bottom: "fpn_conv3x3_P4_BA1"
  top: "fpn_conv3x3_P4_BA1"
  scale_param {
    bias_term: true
    filler { type: "constant" value: 1 }
    bias_filler { type: "constant" value: 0 }
  }
  param { name: "fpn_conv3x3_bs1" lr_mult: 1.0 decay_mult: 0.0 }
  param { name: "fpn_conv3x3_bb1" lr_mult: 2.0 decay_mult: 0 }
}
layer {
  name: "fpn_relu3x3_P4_BA1"
  type: "ReLU"
  bottom: "fpn_conv3x3_P4_BA1"
  top: "fpn_conv3x3_P4_BA1"
}
layer {
  name: "fpn_conv3x3_P4_BA2"
  type: "Convolution"
  bottom: "fpn_conv3x3_P4_BA1"
  top: "fpn_conv3x3_P4_BA2"
  param { name: "fpn_conv3x3_bw2" lr_mult: 1.0 decay_mult: 1.0 }
  convolution_param {
    bias_term: false
    num_output: 256
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
  }
}
layer {
  name: "fpn_conv3x3_P4_BA2/gn"
  type: "GroupNorm"
  bottom: "fpn_conv3x3_P4_BA2"
  top: "fpn_conv3x3_P4_BA2"
}
layer {
  name: "fpn_conv3x3_P4_BA2/gn/scale"
  type: "Scale"
  bottom: "fpn_conv3x3_P4_BA2"
  top: "fpn_conv3x3_P4_BA2"
  scale_param {
    bias_term: true
    filler { type: "constant" value: 1 }
    bias_filler { type: "constant" value: 0 }
  }
  param { name: "fpn_conv3x3_bs2" lr_mult: 1.0 decay_mult: 0.0 }
  param { name: "fpn_conv3x3_bb2" lr_mult: 2.0 decay_mult: 0 }
}
layer {
  name: "fpn_relu3x3_P4_BA2"
  type: "ReLU"
  bottom: "fpn_conv3x3_P4_BA2"
  top: "fpn_conv3x3_P4_BA2"
}
layer {
  name: "cls_score_P4"
  type: "Convolution"
  bottom: "fpn_conv3x3_P4_CA2"
  top: "cls_score_P4"
  param { name: "cls_score_w" lr_mult: 1.0 decay_mult: 1.0 }
  param { name: "cls_score_b" lr_mult: 2.0 decay_mult: 0.0 }
  convolution_param {
    num_output: 480   # 80 (classes) * 9(anchors)
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" value: -4.595 }
  }
}
layer {
  name: "bbox_pred_P4"
  type: "Convolution"
  bottom: "fpn_conv3x3_P4_BA2"
  top: "bbox_pred_P4"
  param { name: "bbox_pred_w" lr_mult: 1.0 decay_mult: 1.0 }
  param { name: "bbox_pred_b" lr_mult: 2.0 decay_mult: 0 }
  convolution_param {
    num_output: 24   # 4 * 9(anchors)
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" value: 0 }
  }
}

#============ RPN Pool5============
layer {
  name: "fpn_conv3x3_P5_CA1"
  type: "Convolution"
  bottom: "fpn_pool5"
  top: "fpn_conv3x3_P5_CA1"
  param { name: "fpn_conv3x3_cw1" lr_mult: 1.0 decay_mult: 1.0 }
  convolution_param {
    bias_term: false
    num_output: 256
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
  }
}
layer {
  name: "fpn_conv3x3_P5_CA1/gn"
  type: "GroupNorm"
  bottom: "fpn_conv3x3_P5_CA1"
  top: "fpn_conv3x3_P5_CA1"
}
layer {
  name: "fpn_conv3x3_P5_CA1/gn/scale"
  type: "Scale"
  bottom: "fpn_conv3x3_P5_CA1"
  top: "fpn_conv3x3_P5_CA1"
  scale_param {
    bias_term: true
    filler { type: "constant" value: 1 }
    bias_filler { type: "constant" value: 0 }
  }
  param { name: "fpn_conv3x3_cs1" lr_mult: 1.0 decay_mult: 0.0 }
  param { name: "fpn_conv3x3_cb1" lr_mult: 2.0 decay_mult: 0 }
}
layer {
  name: "fpn_relu3x3_P5_CA1"
  type: "ReLU"
  bottom: "fpn_conv3x3_P5_CA1"
  top: "fpn_conv3x3_P5_CA1"
}
layer {
  name: "fpn_conv3x3_P5_CA2"
  type: "Convolution"
  bottom: "fpn_conv3x3_P5_CA1"
  top: "fpn_conv3x3_P5_CA2"
  param { name: "fpn_conv3x3_cw2" lr_mult: 1.0 decay_mult: 1.0 }
  convolution_param {
    bias_term: false
    num_output: 256
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
  }
}
layer {
  name: "fpn_conv3x3_P5_CA2/gn"
  type: "GroupNorm"
  bottom: "fpn_conv3x3_P5_CA2"
  top: "fpn_conv3x3_P5_CA2"
}
layer {
  name: "fpn_conv3x3_P5_CA2/gn/scale"
  type: "Scale"
  bottom: "fpn_conv3x3_P5_CA2"
  top: "fpn_conv3x3_P5_CA2"
  scale_param {
    bias_term: true
    filler { type: "constant" value: 1 }
    bias_filler { type: "constant" value: 0 }
  }
  param { name: "fpn_conv3x3_cs2" lr_mult: 1.0 decay_mult: 0.0 }
  param { name: "fpn_conv3x3_cb2" lr_mult: 2.0 decay_mult: 0 }
}
layer {
  name: "fpn_relu3x3_P5_CA2"
  type: "ReLU"
  bottom: "fpn_conv3x3_P5_CA2"
  top: "fpn_conv3x3_P5_CA2"
}
layer {
  name: "fpn_conv3x3_P5_BA1"
  type: "Convolution"
  bottom: "fpn_pool5"
  top: "fpn_conv3x3_P5_BA1"
  param { name: "fpn_conv3x3_bw1" lr_mult: 1.0 decay_mult: 1.0 }
  convolution_param {
    bias_term: false
    num_output: 256
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
  }
}
layer {
  name: "fpn_conv3x3_P5_BA1/gn"
  type: "GroupNorm"
  bottom: "fpn_conv3x3_P5_BA1"
  top: "fpn_conv3x3_P5_BA1"
}
layer {
  name: "fpn_conv3x3_P5_BA1/gn/scale"
  type: "Scale"
  bottom: "fpn_conv3x3_P5_BA1"
  top: "fpn_conv3x3_P5_BA1"
  scale_param {
    bias_term: true
    filler { type: "constant" value: 1 }
    bias_filler { type: "constant" value: 0 }
  }
  param { name: "fpn_conv3x3_bs1" lr_mult: 1.0 decay_mult: 0.0 }
  param { name: "fpn_conv3x3_bb1" lr_mult: 2.0 decay_mult: 0 }
}
layer {
  name: "fpn_relu3x3_P5_BA1"
  type: "ReLU"
  bottom: "fpn_conv3x3_P5_BA1"
  top: "fpn_conv3x3_P5_BA1"
}
layer {
  name: "fpn_conv3x3_P5_BA2"
  type: "Convolution"
  bottom: "fpn_conv3x3_P5_BA1"
  top: "fpn_conv3x3_P5_BA2"
  param { name: "fpn_conv3x3_bw2" lr_mult: 1.0 decay_mult: 1.0 }
  convolution_param {
    bias_term: false
    num_output: 256
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
  }
}
layer {
  name: "fpn_conv3x3_P5_BA2/gn"
  type: "GroupNorm"
  bottom: "fpn_conv3x3_P5_BA2"
  top: "fpn_conv3x3_P5_BA2"
}
layer {
  name: "fpn_conv3x3_P5_BA2/gn/scale"
  type: "Scale"
  bottom: "fpn_conv3x3_P5_BA2"
  top: "fpn_conv3x3_P5_BA2"
  scale_param {
    bias_term: true
    filler { type: "constant" value: 1 }
    bias_filler { type: "constant" value: 0 }
  }
  param { name: "fpn_conv3x3_bs2" lr_mult: 1.0 decay_mult: 0.0 }
  param { name: "fpn_conv3x3_bb2" lr_mult: 2.0 decay_mult: 0 }
}
layer {
  name: "fpn_relu3x3_P5_BA2"
  type: "ReLU"
  bottom: "fpn_conv3x3_P5_BA2"
  top: "fpn_conv3x3_P5_BA2"
}
layer {
  name: "cls_score_P5"
  type: "Convolution"
  bottom: "fpn_conv3x3_P5_CA2"
  top: "cls_score_P5"
  param { name: "cls_score_w" lr_mult: 1.0 decay_mult: 1.0 }
  param { name: "cls_score_b" lr_mult: 2.0 decay_mult: 0.0 }
  convolution_param {
    num_output: 480   # 80 (classes) * 9(anchors)
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" value: -4.595 }
  }
}
layer {
  name: "bbox_pred_P5"
  type: "Convolution"
  bottom: "fpn_conv3x3_P5_BA2"
  top: "bbox_pred_P5"
  param { name: "bbox_pred_w" lr_mult: 1.0 decay_mult: 1.0 }
  param { name: "bbox_pred_b" lr_mult: 2.0 decay_mult: 0 }
  convolution_param {
    num_output: 24   # 4 * 9(anchors)
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" value: 0 }
  }
}

#============ RPN Pool6============
layer {
  name: "fpn_conv3x3_P6_CA1"
  type: "Convolution"
  bottom: "fpn_pool6"
  top: "fpn_conv3x3_P6_CA1"
  param { name: "fpn_conv3x3_cw1" lr_mult: 1.0 decay_mult: 1.0 }
  convolution_param {
    bias_term: false
    num_output: 256
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
  }
}
layer {
  name: "fpn_conv3x3_P6_CA1/gn"
  type: "GroupNorm"
  bottom: "fpn_conv3x3_P6_CA1"
  top: "fpn_conv3x3_P6_CA1"
}
layer {
  name: "fpn_conv3x3_P6_CA1/gn/scale"
  type: "Scale"
  bottom: "fpn_conv3x3_P6_CA1"
  top: "fpn_conv3x3_P6_CA1"
  scale_param {
    bias_term: true
    filler { type: "constant" value: 1 }
    bias_filler { type: "constant" value: 0 }
  }
  param { name: "fpn_conv3x3_cs1" lr_mult: 1.0 decay_mult: 0.0 }
  param { name: "fpn_conv3x3_cb1" lr_mult: 2.0 decay_mult: 0 }
}
layer {
  name: "fpn_relu3x3_P6_CA1"
  type: "ReLU"
  bottom: "fpn_conv3x3_P6_CA1"
  top: "fpn_conv3x3_P6_CA1"
}
layer {
  name: "fpn_conv3x3_P6_CA2"
  type: "Convolution"
  bottom: "fpn_conv3x3_P6_CA1"
  top: "fpn_conv3x3_P6_CA2"
  param { name: "fpn_conv3x3_cw2" lr_mult: 1.0 decay_mult: 1.0 }
  convolution_param {
    bias_term: false
    num_output: 256
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
  }
}
layer {
  name: "fpn_conv3x3_P6_CA2/gn"
  type: "GroupNorm"
  bottom: "fpn_conv3x3_P6_CA2"
  top: "fpn_conv3x3_P6_CA2"
}
layer {
  name: "fpn_conv3x3_P6_CA2/gn/scale"
  type: "Scale"
  bottom: "fpn_conv3x3_P6_CA2"
  top: "fpn_conv3x3_P6_CA2"
  scale_param {
    bias_term: true
    filler { type: "constant" value: 1 }
    bias_filler { type: "constant" value: 0 }
  }
  param { name: "fpn_conv3x3_cs2" lr_mult: 1.0 decay_mult: 0.0 }
  param { name: "fpn_conv3x3_cb2" lr_mult: 2.0 decay_mult: 0 }
}
layer {
  name: "fpn_relu3x3_P6_CA2"
  type: "ReLU"
  bottom: "fpn_conv3x3_P6_CA2"
  top: "fpn_conv3x3_P6_CA2"
}
layer {
  name: "fpn_conv3x3_P6_BA1"
  type: "Convolution"
  bottom: "fpn_pool6"
  top: "fpn_conv3x3_P6_BA1"
  param { name: "fpn_conv3x3_bw1" lr_mult: 1.0 decay_mult: 1.0 }
  convolution_param {
    bias_term: false
    num_output: 256
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
  }
}
layer {
  name: "fpn_conv3x3_P6_BA1/gn"
  type: "GroupNorm"
  bottom: "fpn_conv3x3_P6_BA1"
  top: "fpn_conv3x3_P6_BA1"
}
layer {
  name: "fpn_conv3x3_P6_BA1/gn/scale"
  type: "Scale"
  bottom: "fpn_conv3x3_P6_BA1"
  top: "fpn_conv3x3_P6_BA1"
  scale_param {
    bias_term: true
    filler { type: "constant" value: 1 }
    bias_filler { type: "constant" value: 0 }
  }
  param { name: "fpn_conv3x3_bs1" lr_mult: 1.0 decay_mult: 0.0 }
  param { name: "fpn_conv3x3_bb1" lr_mult: 2.0 decay_mult: 0 }
}
layer {
  name: "fpn_relu3x3_P6_BA1"
  type: "ReLU"
  bottom: "fpn_conv3x3_P6_BA1"
  top: "fpn_conv3x3_P6_BA1"
}
layer {
  name: "fpn_conv3x3_P6_BA2"
  type: "Convolution"
  bottom: "fpn_conv3x3_P6_BA1"
  top: "fpn_conv3x3_P6_BA2"
  param { name: "fpn_conv3x3_bw2" lr_mult: 1.0 decay_mult: 1.0 }
  convolution_param {
    bias_term: false
    num_output: 256
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
  }
}
layer {
  name: "fpn_conv3x3_P6_BA2/gn"
  type: "GroupNorm"
  bottom: "fpn_conv3x3_P6_BA2"
  top: "fpn_conv3x3_P6_BA2"
}
layer {
  name: "fpn_conv3x3_P6_BA2/gn/scale"
  type: "Scale"
  bottom: "fpn_conv3x3_P6_BA2"
  top: "fpn_conv3x3_P6_BA2"
  scale_param {
    bias_term: true
    filler { type: "constant" value: 1 }
    bias_filler { type: "constant" value: 0 }
  }
  param { name: "fpn_conv3x3_bs2" lr_mult: 1.0 decay_mult: 0.0 }
  param { name: "fpn_conv3x3_bb2" lr_mult: 2.0 decay_mult: 0 }
}
layer {
  name: "fpn_relu3x3_P6_BA2"
  type: "ReLU"
  bottom: "fpn_conv3x3_P6_BA2"
  top: "fpn_conv3x3_P6_BA2"
}
layer {
  name: "cls_score_P6"
  type: "Convolution"
  bottom: "fpn_conv3x3_P6_CA2"
  top: "cls_score_P6"
  param { name: "cls_score_w" lr_mult: 1.0 decay_mult: 1.0 }
  param { name: "cls_score_b" lr_mult: 2.0 decay_mult: 0.0 }
  convolution_param {
    num_output: 480   # 80 (classes) * 9(anchors)
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" value: -4.595 }
  }
}
layer {
  name: "bbox_pred_P6"
  type: "Convolution"
  bottom: "fpn_conv3x3_P6_BA2"
  top: "bbox_pred_P6"
  param { name: "bbox_pred_w" lr_mult: 1.0 decay_mult: 1.0 }
  param { name: "bbox_pred_b" lr_mult: 2.0 decay_mult: 0 }
  convolution_param {
    num_output: 24   # 4 * 9(anchors)
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" value: 0 }
  }
}

#============ RPN Pool7 ============
layer {
  name: "fpn_conv3x3_P7_CA1"
  type: "Convolution"
  bottom: "fpn_pool7"
  top: "fpn_conv3x3_P7_CA1"
  param { name: "fpn_conv3x3_cw1" lr_mult: 1.0 decay_mult: 1.0 }
  convolution_param {
    bias_term: false
    num_output: 256
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
  }
}
layer {
  name: "fpn_conv3x3_P7_CA1/gn"
  type: "GroupNorm"
  bottom: "fpn_conv3x3_P7_CA1"
  top: "fpn_conv3x3_P7_CA1"
}
layer {
  name: "fpn_conv3x3_P7_CA1/gn/scale"
  type: "Scale"
  bottom: "fpn_conv3x3_P7_CA1"
  top: "fpn_conv3x3_P7_CA1"
  scale_param {
    bias_term: true
    filler { type: "constant" value: 1 }
    bias_filler { type: "constant" value: 0 }
  }
  param { name: "fpn_conv3x3_cs1" lr_mult: 1.0 decay_mult: 0.0 }
  param { name: "fpn_conv3x3_cb1" lr_mult: 2.0 decay_mult: 0 }
}
layer {
  name: "fpn_relu3x3_P7_CA1"
  type: "ReLU"
  bottom: "fpn_conv3x3_P7_CA1"
  top: "fpn_conv3x3_P7_CA1"
}
layer {
  name: "fpn_conv3x3_P7_CA2"
  type: "Convolution"
  bottom: "fpn_conv3x3_P7_CA1"
  top: "fpn_conv3x3_P7_CA2"
  param { name: "fpn_conv3x3_cw2" lr_mult: 1.0 decay_mult: 1.0 }
  convolution_param {
    bias_term: false
    num_output: 256
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
  }
}
layer {
  name: "fpn_conv3x3_P7_CA2/gn"
  type: "GroupNorm"
  bottom: "fpn_conv3x3_P7_CA2"
  top: "fpn_conv3x3_P7_CA2"
}
layer {
  name: "fpn_conv3x3_P7_CA2/gn/scale"
  type: "Scale"
  bottom: "fpn_conv3x3_P7_CA2"
  top: "fpn_conv3x3_P7_CA2"
  scale_param {
    bias_term: true
    filler { type: "constant" value: 1 }
    bias_filler { type: "constant" value: 0 }
  }
  param { name: "fpn_conv3x3_cs2" lr_mult: 1.0 decay_mult: 0.0 }
  param { name: "fpn_conv3x3_cb2" lr_mult: 2.0 decay_mult: 0 }
}
layer {
  name: "fpn_relu3x3_P7_CA2"
  type: "ReLU"
  bottom: "fpn_conv3x3_P7_CA2"
  top: "fpn_conv3x3_P7_CA2"
}
layer {
  name: "fpn_conv3x3_P7_BA1"
  type: "Convolution"
  bottom: "fpn_pool7"
  top: "fpn_conv3x3_P7_BA1"
  param { name: "fpn_conv3x3_bw1" lr_mult: 1.0 decay_mult: 1.0 }
  convolution_param {
    bias_term: false
    num_output: 256
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
  }
}
layer {
  name: "fpn_conv3x3_P7_BA1/gn"
  type: "GroupNorm"
  bottom: "fpn_conv3x3_P7_BA1"
  top: "fpn_conv3x3_P7_BA1"
}
layer {
  name: "fpn_conv3x3_P7_BA1/gn/scale"
  type: "Scale"
  bottom: "fpn_conv3x3_P7_BA1"
  top: "fpn_conv3x3_P7_BA1"
  scale_param {
    bias_term: true
    filler { type: "constant" value: 1 }
    bias_filler { type: "constant" value: 0 }
  }
  param { name: "fpn_conv3x3_bs1" lr_mult: 1.0 decay_mult: 0.0 }
  param { name: "fpn_conv3x3_bb1" lr_mult: 2.0 decay_mult: 0 }
}
layer {
  name: "fpn_relu3x3_P7_BA1"
  type: "ReLU"
  bottom: "fpn_conv3x3_P7_BA1"
  top: "fpn_conv3x3_P7_BA1"
}
layer {
  name: "fpn_conv3x3_P7_BA2"
  type: "Convolution"
  bottom: "fpn_conv3x3_P7_BA1"
  top: "fpn_conv3x3_P7_BA2"
  param { name: "fpn_conv3x3_bw2" lr_mult: 1.0 decay_mult: 1.0 }
  convolution_param {
    bias_term: false
    num_output: 256
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
  }
}
layer {
  name: "fpn_conv3x3_P7_BA2/gn"
  type: "GroupNorm"
  bottom: "fpn_conv3x3_P7_BA2"
  top: "fpn_conv3x3_P7_BA2"
}
layer {
  name: "fpn_conv3x3_P7_BA2/gn/scale"
  type: "Scale"
  bottom: "fpn_conv3x3_P7_BA2"
  top: "fpn_conv3x3_P7_BA2"
  scale_param {
    bias_term: true
    filler { type: "constant" value: 1 }
    bias_filler { type: "constant" value: 0 }
  }
  param { name: "fpn_conv3x3_bs2" lr_mult: 1.0 decay_mult: 0.0 }
  param { name: "fpn_conv3x3_bb2" lr_mult: 2.0 decay_mult: 0 }
}
layer {
  name: "fpn_relu3x3_P7_BA2"
  type: "ReLU"
  bottom: "fpn_conv3x3_P7_BA2"
  top: "fpn_conv3x3_P7_BA2"
}
layer {
  name: "cls_score_P7"
  type: "Convolution"
  bottom: "fpn_conv3x3_P7_CA2"
  top: "cls_score_P7"
  param { name: "cls_score_w" lr_mult: 1.0 decay_mult: 1.0 }
  param { name: "cls_score_b" lr_mult: 2.0 decay_mult: 0.0 }
  convolution_param {
    num_output: 480   # 80 (classes) * 9(anchors)
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" value: -4.595 }
  }
}
layer {
  name: "bbox_pred_P7"
  type: "Convolution"
  bottom: "fpn_conv3x3_P7_BA2"
  top: "bbox_pred_P7"
  param { name: "bbox_pred_w" lr_mult: 1.0 decay_mult: 1.0 }
  param { name: "bbox_pred_b" lr_mult: 2.0 decay_mult: 0 }
  convolution_param {
    num_output: 24   # 4 * 9(anchors)
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" value: 0 }
  }
}

#============= refinement ==================
layer {
  name: "cls_score_P3_perm"
  type: "Permute"
  bottom: "cls_score_P3"
  top: "cls_score_P3_perm"
  permute_param { order: 0 order: 2 order: 3 order: 1 }
}
layer {
  name: "bbox_pred_P3_perm"
  type: "Permute"
  bottom: "bbox_pred_P3"
  top: "bbox_pred_P3_perm"
  permute_param { order: 0 order: 2 order: 3 order: 1 }
}
layer {
  name: 'proposal_P3'
  type: 'Proposal'
  bottom: 'cls_score_P3_perm'
  bottom: 'bbox_pred_P3_perm'
  bottom: 'im_info'
  top: 'dets_P3'
  top: 'det_scores_P3'
  propagate_down: false
  propagate_down: false
  propagate_down: false
  rpn_proposal_param {
    feat_stride: 8
    pre_nms_top_k: 250
    thresh: -3.5
    min_size: 4
    nms_thresh: 0.7
    keep_cls_info: false
  }
}
layer {
  name: "cls_score_P4_perm"
  type: "Permute"
  bottom: "cls_score_P4"
  top: "cls_score_P4_perm"
  permute_param { order: 0 order: 2 order: 3 order: 1 }
}
layer {
  name: "bbox_pred_P4_perm"
  type: "Permute"
  bottom: "bbox_pred_P4"
  top: "bbox_pred_P4_perm"
  permute_param { order: 0 order: 2 order: 3 order: 1 }
}

layer {
  name: 'proposal_P4'
  type: 'Proposal'
  bottom: 'cls_score_P4_perm'
  bottom: 'bbox_pred_P4_perm'
  bottom: 'im_info'
  top: 'dets_P4'
  top: 'det_scores_P4'
  propagate_down: false
  propagate_down: false
  propagate_down: false
  rpn_proposal_param {
    feat_stride: 16 
    pre_nms_top_k: 250 
    thresh: -3.5 
    min_size: 4
    keep_cls_info: false
    nms_thresh: 0.7
  }
}
layer {
  name: "cls_score_P5_perm"
  type: "Permute"
  bottom: "cls_score_P5"
  top: "cls_score_P5_perm"
  permute_param { order: 0 order: 2 order: 3 order: 1 }
}
layer {
  name: "bbox_pred_P5_perm"
  type: "Permute"
  bottom: "bbox_pred_P5"
  top: "bbox_pred_P5_perm"
  permute_param { order: 0 order: 2 order: 3 order: 1 }
}
layer {
  name: 'proposal_P5'
  type: 'Proposal'
  bottom: 'cls_score_P5_perm'
  bottom: 'bbox_pred_P5_perm'
  bottom: 'im_info'
  top: 'dets_P5'
  top: 'det_scores_P5'
  propagate_down: false
  propagate_down: false
  propagate_down: false
  rpn_proposal_param {
    feat_stride: 32 
    pre_nms_top_k: 250 
    thresh: -3.5 
    min_size: 4
    keep_cls_info: false
    nms_thresh: 0.7
  }
}
layer {
  name: "cls_score_P6_perm"
  type: "Permute"
  bottom: "cls_score_P6"
  top: "cls_score_P6_perm"
  permute_param { order: 0 order: 2 order: 3 order: 1 }
}
layer {
  name: "bbox_pred_P6_perm"
  type: "Permute"
  bottom: "bbox_pred_P6"
  top: "bbox_pred_P6_perm"
  permute_param { order: 0 order: 2 order: 3 order: 1 }
}
layer {
  name: 'proposal_P6'
  type: 'Proposal'
  bottom: 'cls_score_P6_perm'
  bottom: 'bbox_pred_P6_perm'
  bottom: 'im_info'
  top: 'dets_P6'
  top: 'det_scores_P6'
  propagate_down: false
  propagate_down: false
  propagate_down: false
  rpn_proposal_param {
    feat_stride: 64 
    pre_nms_top_k: 250 
    thresh: -3.5 
    min_size: 4
    keep_cls_info: false
    nms_thresh: 0.7
  }
}
layer {
  name: "cls_score_P7_perm"
  type: "Permute"
  bottom: "cls_score_P7"
  top: "cls_score_P7_perm"
  permute_param { order: 0 order: 2 order: 3 order: 1 }
}
layer {
  name: "bbox_pred_P7_perm"
  type: "Permute"
  bottom: "bbox_pred_P7"
  top: "bbox_pred_P7_perm"
  permute_param { order: 0 order: 2 order: 3 order: 1 }
}
layer {
  name: 'proposal_P7'
  type: 'Proposal'
  bottom: 'cls_score_P7_perm'
  bottom: 'bbox_pred_P7_perm'
  bottom: 'im_info'
  top: 'dets_P7'
  top: 'det_scores_P7'
  propagate_down: false
  propagate_down: false
  propagate_down: false
  rpn_proposal_param {
    feat_stride: 128 
    pre_nms_top_k: 250 
    thresh: -3.5 
    min_size: 4
    keep_cls_info: false
    nms_thresh: 0.7
  }
}
layer {
   name: "det_rois"
   type: "Concat"
   bottom: "dets_P3"
   bottom: "dets_P4"
   bottom: "dets_P5"
   bottom: "dets_P6"
   bottom: "dets_P7"
   top: "det_rois"
   concat_param { axis: 0 }
}
layer {
   name: "det_scores_all"
   type: "Concat"
   bottom: "det_scores_P3"
   bottom: "det_scores_P4"
   bottom: "det_scores_P5"
   bottom: "det_scores_P6"
   bottom: "det_scores_P7"
   top: "det_scores_all"
   concat_param { axis: 0 }
}
layer {
   name: "det_probs"
   bottom: "det_scores_all"
   top: "det_probs"
   type: "Sigmoid"
}

layer {
   name: "proposals"
   type: "Slice"
   bottom: "det_rois"
   top: "proposals"
   top: "det_cls_scores"
   slice_param { axis: 1 slice_point: 5 }
}

#================== CASCADE 1 =====================
layer {
  name: "cas_roi_grid_P3S1"
  type: "ROIAlign"
  bottom: "fpn_pool3"
  bottom: "proposals"
  top: "cas_roi_grid_P3S1"
  roi_pooling_param {
    pooled_w: 7
    pooled_h: 7
    spatial_scale: 0.125 # 1/8
  }
  propagate_down: 1
  propagate_down: 0
}
layer {
  name: "cas_roi_grid_P4S1"
  type: "ROIAlign"
  bottom: "fpn_pool4"
  bottom: "proposals"
  top: "cas_roi_grid_P4S1"
  roi_pooling_param {
    pooled_w: 7
    pooled_h: 7
    spatial_scale: 0.0625 # 1/16
  }
  propagate_down: 1
  propagate_down: 0
}
layer {
  name: "cas_roi_grid_P5S1"
  type: "ROIAlign"
  bottom: "fpn_conv5"
  bottom: "proposals"
  top: "cas_roi_grid_P5S1"
  roi_pooling_param {
    pooled_w: 7
    pooled_h: 7
    spatial_scale: 0.0625 # 1/16
  }
  propagate_down: 1
  propagate_down: 0
}
layer {
  bottom: "cas_roi_grid_P3S1"
  bottom: "cas_roi_grid_P4S1"
  bottom: "cas_roi_grid_P5S1"
  top: "cas_roi_grid_S1"
  name: "cas_roi_grid_S1"
  type: "Eltwise"
}
layer {
  name: "cas_conv1_3x3_S1"
  type: "Convolution"
  bottom: "cas_roi_grid_S1"
  top: "cas_conv1_3x3_S1"
  param { name: "cas_conv1_s1_w" lr_mult: 1.0 decay_mult: 1.0 }
  param { name: "cas_conv1_s1_b" lr_mult: 2.0 decay_mult: 0 }
  convolution_param {
    num_output: 1024
    kernel_size: 8 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" value: 0 }
  }
}
layer {
  name: "cas_conv1_3x3_S1/relu"
  type: "ReLU"
  bottom: "cas_conv1_3x3_S1"
  top: "cas_conv1_3x3_S1"
}
layer {
  name: "cas_conv2_3x3_S1"
  type: "Convolution"
  bottom: "cas_conv1_3x3_S1"
  top: "cas_conv2_3x3_S1"
  param { name: "cas_conv2_s1_w" lr_mult: 1.0 decay_mult: 1.0 }
  param { name: "cas_conv2_s1_b" lr_mult: 2.0 decay_mult: 0 }
  convolution_param {
    num_output: 1024
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" value: 0 }
  }
}
layer {
  name: "cas_conv2_3x3_S1/relu"
  type: "ReLU"
  bottom: "cas_conv2_3x3_S1"
  top: "cas_conv2_3x3_S1"
}
layer {
  name: "cls_pred_1st_g1"
  type: "Convolution"
  bottom: "cas_conv2_3x3_S1"
  top: "cls_pred_1st_g1"
  param { name: "cls_pred_1st_w1" lr_mult: 1.0 }
  param { name: "cls_pred_1st_b1" lr_mult: 2.0 }
  convolution_param {
    num_output: 80
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: -1.0 }
  }
}
layer {
  name: "bbox_pred_1st_g1"
  type: "Convolution"
  bottom: "cas_conv2_3x3_S1"
  top: "bbox_pred_1st_g1"
  param { name: "bbox_pred_1st_w1" lr_mult: 1.0 }
  param { name: "bbox_pred_1st_b1" lr_mult: 2.0 }
  convolution_param {
    num_output: 8
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: 0.0 }
  }
}
layer {
  name: "cls_pred_1st_g2"
  type: "Convolution"
  bottom: "cas_conv2_3x3_S1"
  top: "cls_pred_1st_g2"
  param { name: "cls_pred_1st_w2" lr_mult: 1.0 }
  param { name: "cls_pred_1st_b2" lr_mult: 2.0 }
  convolution_param {
    num_output: 80
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: -1.0 }
  }
}
layer {
  name: "bbox_pred_1st_g2"
  type: "Convolution"
  bottom: "cas_conv2_3x3_S1"
  top: "bbox_pred_1st_g2"
  param { name: "bbox_pred_1st_w2" lr_mult: 1.0 }
  param { name: "bbox_pred_1st_b2" lr_mult: 2.0 }
  convolution_param {
    num_output: 8
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: 0.0 }
  }
}
layer {
  name: "cas_conv3_3x3_S1"
  type: "Convolution"
  bottom: "cas_conv2_3x3_S1"
  top: "cas_conv3_3x3_S1"
  param { name: "cas_conv3_s1_w" lr_mult: 1.0 decay_mult: 1.0 }
  param { name: "cas_conv3_s1_b" lr_mult: 2.0 decay_mult: 0 }
  convolution_param {
    num_output: 512
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" value: 0 }
  }
}
layer {
  name: "cas_conv3_3x3_S1/relu"
  type: "ReLU"
  bottom: "cas_conv3_3x3_S1"
  top: "cas_conv3_3x3_S1"
}
layer {
  name: "cls_pred_1st_g3"
  type: "Convolution"
  bottom: "cas_conv2_3x3_S1"
  top: "cls_pred_1st_g3"
  param { name: "cls_pred_1st_w3" lr_mult: 1 }
  param { name: "cls_pred_1st_b3" lr_mult: 2 }
  convolution_param {
    num_output: 80
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: -1.0 }
  }
}
layer {
  name: "bbox_pred_1st_g3"
  type: "Convolution"
  bottom: "cas_conv2_3x3_S1"
  top: "bbox_pred_1st_g3"
  param { name: "bbox_pred_1st_w3" lr_mult: 1 }
  param { name: "bbox_pred_1st_b3" lr_mult: 2 }
  convolution_param {
    num_output: 8
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: 0.0 }
  }
}
layer {
  name: "cls_pred_1st_g4"
  type: "Convolution"
  bottom: "cas_conv3_3x3_S1"
  top: "cls_pred_1st_g4"
  param { name: "cls_pred_1st_w4" lr_mult: 1 }
  param { name: "cls_pred_1st_b4" lr_mult: 2 }
  convolution_param {
    num_output: 80
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: -1.0 }
  }
}
layer {
  name: "bbox_pred_1st_g4"
  type: "Convolution"
  bottom: "cas_conv3_3x3_S1"
  top: "bbox_pred_1st_g4"
  param { name: "bbox_pred_1st_w4" lr_mult: 1 }
  param { name: "bbox_pred_1st_b4" lr_mult: 1 }
  convolution_param {
    num_output: 8
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: 0.0 }
  }
}
layer {
  name: "cls_pred_1st"
  bottom: "cls_pred_1st_g1"
  bottom: "cls_pred_1st_g2"
  bottom: "cls_pred_1st_g3"
  bottom: "cls_pred_1st_g4"
  top: "cls_pred_1st"
  type: "Eltwise"
}
layer {
  name: "bbox_pred_1st"
  bottom: "bbox_pred_1st_g1"
  bottom: "bbox_pred_1st_g2"
  bottom: "bbox_pred_1st_g3"
  bottom: "bbox_pred_1st_g4"
  top: "bbox_pred_1st"
  type: "Eltwise"
}

#================== CASCADE 2 =====================
layer {
  name: "proposals_2nd"
  type: "DecodeBBox"
  bottom: "bbox_pred_1st"
  bottom: "proposals"
  top: "proposals_2nd"
  bbox_reg_param {
    bbox_mean: 0 bbox_mean: 0 bbox_mean: 0 bbox_mean: 0
    bbox_std: 0.1 bbox_std: 0.1 bbox_std: 0.2 bbox_std: 0.2
  }
  propagate_down: 0
  propagate_down: 0
}
layer {
  name: "cas_roi_grid_P3S2"
  type: "ROIAlign"
  bottom: "fpn_pool3"
  bottom: "proposals_2nd"
  top: "cas_roi_grid_P3S2"
  roi_pooling_param {
    pooled_w: 7
    pooled_h: 7
    spatial_scale: 0.125 # 1/8
  }
  propagate_down: 1
  propagate_down: 0
}
layer {
  name: "cas_roi_grid_P4S2"
  type: "ROIAlign"
  bottom: "fpn_pool4"
  bottom: "proposals_2nd"
  top: "cas_roi_grid_P4S2"
  roi_pooling_param {
    pooled_w: 7
    pooled_h: 7
    spatial_scale: 0.0625 # 1/16
  }
  propagate_down: 1
  propagate_down: 0
}
layer {
  name: "cas_roi_grid_P5S2"
  type: "ROIAlign"
  bottom: "fpn_conv5"
  bottom: "proposals_2nd"
  top: "cas_roi_grid_P5S2"
  roi_pooling_param {
    pooled_w: 7
    pooled_h: 7
    spatial_scale: 0.0625 # 1/16
  }
  propagate_down: 1
  propagate_down: 0
}
layer {
  bottom: "cas_roi_grid_P3S2"
  bottom: "cas_roi_grid_P4S2"
  bottom: "cas_roi_grid_P5S2"
  top: "cas_roi_grid_S2"
  name: "cas_roi_grid_S2"
  type: "Eltwise"
}
layer {
  name: "cas_conv1_3x3_S2"
  type: "Convolution"
  bottom: "cas_roi_grid_S2"
  top: "cas_conv1_3x3_S2"
  param { name: "cas_conv1_s2_w" lr_mult: 2.0 decay_mult: 1.0 }
  param { name: "cas_conv1_s2_b" lr_mult: 4.0 decay_mult: 0 }
  convolution_param {
    num_output: 1024
    kernel_size: 8 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" value: 0 }
  }
}
layer {
  name: "cas_conv1_3x3_S2/relu"
  type: "ReLU"
  bottom: "cas_conv1_3x3_S2"
  top: "cas_conv1_3x3_S2"
}
layer {
  name: "cas_conv2_3x3_S2"
  type: "Convolution"
  bottom: "cas_conv1_3x3_S2"
  top: "cas_conv2_3x3_S2"
  param { name: "cas_conv2_s2_w" lr_mult: 2.0 decay_mult: 1.0 }
  param { name: "cas_conv2_s2_b" lr_mult: 4.0 decay_mult: 0 }
  convolution_param {
    num_output: 1024
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" value: 0 }
  }
}
layer {
  name: "cas_conv2_3x3_S2/relu"
  type: "ReLU"
  bottom: "cas_conv2_3x3_S2"
  top: "cas_conv2_3x3_S2"
}
layer {
  name: "cls_pred_2nd_g1"
  type: "Convolution"
  bottom: "cas_conv2_3x3_S2"
  top: "cls_pred_2nd_g1"
  param { name: "cls_pred_2nd_w1" lr_mult: 2.0 }
  param { name: "cls_pred_2nd_b1" lr_mult: 4.0 }
  convolution_param {
    num_output: 80
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: -1.0 }
  }
}
layer {
  name: "bbox_pred_2nd_g1"
  type: "Convolution"
  bottom: "cas_conv2_3x3_S2"
  top: "bbox_pred_2nd_g1"
  param { name: "bbox_pred_2nd_w1" lr_mult: 2.0 }
  param { name: "bbox_pred_2nd_b1" lr_mult: 4.0 }
  convolution_param {
    num_output: 8
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: 0.0 }
  }
}
layer {
  name: "cls_pred_2nd_g2"
  type: "Convolution"
  bottom: "cas_conv2_3x3_S2"
  top: "cls_pred_2nd_g2"
  param { name: "cls_pred_2nd_w2" lr_mult: 2.0 }
  param { name: "cls_pred_2nd_b2" lr_mult: 4.0 }
  convolution_param {
    num_output: 80
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: -1.0 }
  }
}
layer {
  name: "bbox_pred_2nd_g2"
  type: "Convolution"
  bottom: "cas_conv2_3x3_S2"
  top: "bbox_pred_2nd_g2"
  param { name: "bbox_pred_2nd_w2" lr_mult: 2.0 }
  param { name: "bbox_pred_2nd_b2" lr_mult: 4.0 }
  convolution_param {
    num_output: 8
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: 0.0 }
  }
}
layer {
  name: "cas_conv3_3x3_S2"
  type: "Convolution"
  bottom: "cas_conv2_3x3_S2"
  top: "cas_conv3_3x3_S2"
  param { name: "cas_conv3_s2_w" lr_mult: 2.0 decay_mult: 1.0 }
  param { name: "cas_conv3_s2_b" lr_mult: 4.0 decay_mult: 0 }
  convolution_param {
    num_output: 512
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" value: 0 }
  }
}
layer {
  name: "cas_conv3_3x3_S2/relu"
  type: "ReLU"
  bottom: "cas_conv3_3x3_S2"
  top: "cas_conv3_3x3_S2"
}
layer {
  name: "cls_pred_2nd_g3"
  type: "Convolution"
  bottom: "cas_conv2_3x3_S2"
  top: "cls_pred_2nd_g3"
  param { name: "cls_pred_2nd_w3" lr_mult: 2 }
  param { name: "cls_pred_2nd_b3" lr_mult: 4 }
  convolution_param {
    num_output: 80
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: -1.0 }
  }
}
layer {
  name: "bbox_pred_2nd_g3"
  type: "Convolution"
  bottom: "cas_conv2_3x3_S2"
  top: "bbox_pred_2nd_g3"
  param { name: "bbox_pred_2nd_w3" lr_mult: 2 }
  param { name: "bbox_pred_2nd_b3" lr_mult: 4 }
  convolution_param {
    num_output: 8
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: 0.0 }
  }
}
layer {
  name: "cls_pred_2nd_g4"
  type: "Convolution"
  bottom: "cas_conv3_3x3_S2"
  top: "cls_pred_2nd_g4"
  param { name: "cls_pred_2nd_w4" lr_mult: 2 }
  param { name: "cls_pred_2nd_b4" lr_mult: 4 }
  convolution_param {
    num_output: 80
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: -1.0 }
  }
}
layer {
  name: "bbox_pred_2nd_g4"
  type: "Convolution"
  bottom: "cas_conv3_3x3_S2"
  top: "bbox_pred_2nd_g4"
  param { name: "bbox_pred_2nd_w4" lr_mult: 2 }
  param { name: "bbox_pred_2nd_b4" lr_mult: 4 }
  convolution_param {
    num_output: 8
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: 0.0 }
  }
}
layer {
  name: "cls_pred_2nd"
  bottom: "cls_pred_2nd_g1"
  bottom: "cls_pred_2nd_g2"
  bottom: "cls_pred_2nd_g3"
  bottom: "cls_pred_2nd_g4"
  top: "cls_pred_2nd"
  type: "Eltwise"
}
layer {
  name: "bbox_pred_2nd"
  bottom: "bbox_pred_2nd_g1"
  bottom: "bbox_pred_2nd_g2"
  bottom: "bbox_pred_2nd_g3"
  bottom: "bbox_pred_2nd_g4"
  top: "bbox_pred_2nd"
  type: "Eltwise"
}

#=================== CASCADE 3 ======================
layer {
  name: "proposals_3rd"
  type: "DecodeBBox"
  bottom: "bbox_pred_2nd"
  bottom: "proposals_2nd"
  top: "proposals_3rd"
  bbox_reg_param {
    bbox_mean: 0 bbox_mean: 0 bbox_mean: 0 bbox_mean: 0
    bbox_std: 0.05 bbox_std: 0.05 bbox_std: 0.1 bbox_std: 0.1
  }
  propagate_down: 0
  propagate_down: 0
}
layer {
  name: "cas_roi_grid_P3S3"
  type: "ROIAlign"
  bottom: "fpn_pool3"
  bottom: "proposals_3rd"
  top: "cas_roi_grid_P3S3"
  roi_pooling_param {
    pooled_w: 7
    pooled_h: 7
    spatial_scale: 0.125 # 1/8
  }
  propagate_down: 1
  propagate_down: 0
}
layer {
  name: "cas_roi_grid_P4S3"
  type: "ROIAlign"
  bottom: "fpn_pool4"
  bottom: "proposals_3rd"
  top: "cas_roi_grid_P4S3"
  roi_pooling_param {
    pooled_w: 7
    pooled_h: 7
    spatial_scale: 0.0625 # 1/16
  }
  propagate_down: 1
  propagate_down: 0
}
layer {
  name: "cas_roi_grid_P5S3"
  type: "ROIAlign"
  bottom: "fpn_conv5"
  bottom: "proposals_3rd"
  top: "cas_roi_grid_P5S3"
  roi_pooling_param {
    pooled_w: 7
    pooled_h: 7
    spatial_scale: 0.0625 # 1/16
  }
  propagate_down: 1
  propagate_down: 0
}
layer {
  bottom: "cas_roi_grid_P3S3"
  bottom: "cas_roi_grid_P4S3"
  bottom: "cas_roi_grid_P5S3"
  top: "cas_roi_grid_S3"
  name: "cas_roi_grid_S3"
  type: "Eltwise"
}
layer {
  name: "cas_conv1_3x3_S3"
  type: "Convolution"
  bottom: "cas_roi_grid_S3"
  top: "cas_conv1_3x3_S3"
  param { name: "cas_conv1_s3_w" lr_mult: 4.0 decay_mult: 1.0 }
  param { name: "cas_conv1_s3_b" lr_mult: 8.0 decay_mult: 0 }
  convolution_param {
    num_output: 1024
    kernel_size: 8 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" value: 0 }
  }
}
layer {
  name: "cas_conv1_3x3_S3/relu"
  type: "ReLU"
  bottom: "cas_conv1_3x3_S3"
  top: "cas_conv1_3x3_S3"
}
layer {
  name: "cas_conv2_3x3_S3"
  type: "Convolution"
  bottom: "cas_conv1_3x3_S3"
  top: "cas_conv2_3x3_S3"
  param { name: "cas_conv2_s3_w" lr_mult: 4.0 decay_mult: 1.0 }
  param { name: "cas_conv2_s3_b" lr_mult: 8.0 decay_mult: 0 }
  convolution_param {
    num_output: 1024
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" value: 0 }
  }
}
layer {
  name: "cas_conv2_3x3_S3/relu"
  type: "ReLU"
  bottom: "cas_conv2_3x3_S3"
  top: "cas_conv2_3x3_S3"
}
layer {
  name: "cls_pred_3rd_g1"
  type: "Convolution"
  bottom: "cas_conv2_3x3_S3"
  top: "cls_pred_3rd_g1"
  param { name: "cls_pred_3rd_w1" lr_mult: 4.0 }
  param { name: "cls_pred_3rd_b1" lr_mult: 8.0 }
  convolution_param {
    num_output: 80
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: -1.0 }
  }
}
layer {
  name: "bbox_pred_3rd_g1"
  type: "Convolution"
  bottom: "cas_conv2_3x3_S3"
  top: "bbox_pred_3rd_g1"
  param { name: "bbox_pred_3rd_w1" lr_mult: 4.0 }
  param { name: "bbox_pred_3rd_b1" lr_mult: 8.0 }
  convolution_param {
    num_output: 8
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: 0.0 }
  }
}
layer {
  name: "cls_pred_3rd_g2"
  type: "Convolution"
  bottom: "cas_conv2_3x3_S3"
  top: "cls_pred_3rd_g2"
  param { name: "cls_pred_3rd_w2" lr_mult: 4.0 }
  param { name: "cls_pred_3rd_b2" lr_mult: 8.0 }
  convolution_param {
    num_output: 80
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: -1.0 }
  }
}
layer {
  name: "bbox_pred_3rd_g2"
  type: "Convolution"
  bottom: "cas_conv2_3x3_S3"
  top: "bbox_pred_3rd_g2"
  param { name: "bbox_pred_3rd_w2" lr_mult: 4.0 }
  param { name: "bbox_pred_3rd_b2" lr_mult: 8.0 }
  convolution_param {
    num_output: 8
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: 0.0 }
  }
}
layer {
  name: "cas_conv3_3x3_S3"
  type: "Convolution"
  bottom: "cas_conv2_3x3_S3"
  top: "cas_conv3_3x3_S3"
  param { name: "cas_conv3_s3_w" lr_mult: 4.0 decay_mult: 1.0 }
  param { name: "cas_conv3_s3_b" lr_mult: 8.0 decay_mult: 0 }
  convolution_param {
    num_output: 512
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" value: 0 }
  }
}
layer {
  name: "cas_conv3_3x3_S3/relu"
  type: "ReLU"
  bottom: "cas_conv3_3x3_S3"
  top: "cas_conv3_3x3_S3"
}
layer {
  name: "cls_pred_3rd_g3"
  type: "Convolution"
  bottom: "cas_conv2_3x3_S3"
  top: "cls_pred_3rd_g3"
  param { name: "cls_pred_3rd_w3" lr_mult: 4 }
  param { name: "cls_pred_3rd_b3" lr_mult: 8 }
  convolution_param {
    num_output: 80
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: -1.0 }
  }
}
layer {
  name: "bbox_pred_3rd_g3"
  type: "Convolution"
  bottom: "cas_conv2_3x3_S3"
  top: "bbox_pred_3rd_g3"
  param { name: "bbox_pred_3rd_w3" lr_mult: 4 }
  param { name: "bbox_pred_3rd_b3" lr_mult: 8 }
  convolution_param {
    num_output: 8
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: 0.0 }
  }
}
layer {
  name: "cls_pred_3rd_g4"
  type: "Convolution"
  bottom: "cas_conv3_3x3_S3"
  top: "cls_pred_3rd_g4"
  param { name: "cls_pred_3rd_w4" lr_mult: 4 }
  param { name: "cls_pred_3rd_b4" lr_mult: 8 }
  convolution_param {
    num_output: 80
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: -1.0 }
  }
}
layer {
  name: "bbox_pred_3rd_g4"
  type: "Convolution"
  bottom: "cas_conv3_3x3_S3"
  top: "bbox_pred_3rd_g4"
  param { name: "bbox_pred_3rd_w4" lr_mult: 4 }
  param { name: "bbox_pred_3rd_b4" lr_mult: 8 }
  convolution_param {
    num_output: 8
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: 0.0 }
  }
}
layer {
  name: "cls_pred_3rd"
  bottom: "cls_pred_3rd_g1"
  bottom: "cls_pred_3rd_g2"
  bottom: "cls_pred_3rd_g3"
  bottom: "cls_pred_3rd_g4"
  top: "cls_pred_3rd"
  type: "Eltwise"
}
layer {
  name: "bbox_pred_3rd"
  bottom: "bbox_pred_3rd_g1"
  bottom: "bbox_pred_3rd_g2"
  bottom: "bbox_pred_3rd_g3"
  bottom: "bbox_pred_3rd_g4"
  top: "bbox_pred_3rd"
  type: "Eltwise"
}

#-----------------------output------------------------
layer {
  name: "output_bbox_1st"
  type: "DecodeBBox"
  bottom: "bbox_pred_1st"
  bottom: "proposals"
  top: "output_bbox_1st"
  bbox_reg_param {
    bbox_mean: 0 bbox_mean: 0 bbox_mean: 0 bbox_mean: 0
    bbox_std: 0.1 bbox_std: 0.1 bbox_std: 0.2 bbox_std: 0.2
  }
}
layer {
  name: "output_bbox_2nd"
  type: "DecodeBBox"
  bottom: "bbox_pred_2nd"
  bottom: "proposals_2nd"
  top: "output_bbox_2nd"
  bbox_reg_param {
    bbox_mean: 0 bbox_mean: 0 bbox_mean: 0 bbox_mean: 0
    bbox_std: 0.05 bbox_std: 0.05 bbox_std: 0.1 bbox_std: 0.1
  }
}
layer {
  name: "output_bbox_3rd"
  type: "DecodeBBox"
  bottom: "bbox_pred_3rd"
  bottom: "proposals_3rd"
  top: "output_bbox_3rd"
  bbox_reg_param {
    bbox_mean: 0 bbox_mean: 0 bbox_mean: 0 bbox_mean: 0
    bbox_std: 0.033 bbox_std: 0.033 bbox_std: 0.067 bbox_std: 0.067
  }
}

layer {
  name: "cls_prob_1st"
  type: "Sigmoid"
  bottom: "cls_pred_1st"
  top: "cls_prob_1st"
}
layer {
  name: "cls_prob_2nd"
  type: "Sigmoid"
  bottom: "cls_pred_2nd"
  top: "cls_prob_2nd"
}
layer {
  name: "cls_prob_3rd"
  type: "Sigmoid"
  bottom: "cls_pred_3rd"
  top: "cls_prob_3rd"
}
layer {
  name: "cls_prob_3rd_avg"
  type: "Eltwise"
  bottom: "cls_prob_1st"
  bottom: "cls_prob_2nd"
  bottom: "cls_prob_3rd"
  top: "cls_prob_3rd_avg"
  eltwise_param {
    operation: SUM
    coeff: 0.33333333
    coeff: 0.33333333
    coeff: 0.33333333
  }
}
