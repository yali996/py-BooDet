name: "ResNet-50"

layer {
  name: 'input-data'
  type: 'ROIData'
  top: 'data'
  top: 'label'
  transform_param {
    mean_value: 102.9801  mean_value: 115.9465  mean_value: 122.7717
  }
  image_data_param{
    source: 'data/cache/imglist_coco_2014_train+coco_2014_valminusminival_800_1200.txt'
    root_folder: '/home/liyl/Database/coco/'
    shuffle: true
    batch_size: 1
    info_size: 5
    roi_num: 95
  }
}

layer {
  name: 'anno_slice'
  type: 'Slice'
  bottom: 'label'
  top: 'im_info'
  top: 'gt_boxes_flatten'
  top: 'others'
  slice_param { axis: 1 slice_point: 4 slice_point: 479 }
}

layer {
  name: 'gt_boxes'
  type: 'Reshape'
  bottom: 'gt_boxes_flatten'
  top: 'gt_boxes'
  reshape_param { shape {dim: 0 dim: -1 dim: 5 dim: 1} }
}

# ---------- conv1 -----------------
layer {
	bottom: "data"
	top: "conv1"
	name: "conv1"
	type: "Convolution"
	convolution_param {
		num_output: 64
		kernel_size: 7
		pad: 3
		stride: 2
	}
    param { lr_mult: 0.0 }
    param { lr_mult: 0.0 }
}

layer {
	bottom: "conv1"
	top: "conv1"
	name: "bn_conv1"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "conv1"
	top: "conv1"
	name: "scale_conv1"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "conv1"
	top: "conv1"
	name: "conv1_relu"
	type: "ReLU"
}

layer {
	bottom: "conv1"
	top: "pool1"
	name: "pool1"
	type: "Pooling"
	pooling_param {
		kernel_size: 3
		stride: 2
		pool: MAX
                pad: 1
	}
}

layer {
	bottom: "pool1"
	top: "res2a_branch1"
	name: "res2a_branch1"
	type: "Convolution"
	convolution_param {
		num_output: 256
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
    param { lr_mult: 0.0 }
}

layer {
	bottom: "res2a_branch1"
	top: "res2a_branch1"
	name: "bn2a_branch1"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res2a_branch1"
	top: "res2a_branch1"
	name: "scale2a_branch1"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "pool1"
	top: "res2a_branch2a"
	name: "res2a_branch2a"
	type: "Convolution"
	convolution_param {
		num_output: 64
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
    param { lr_mult: 0.0 }
}

layer {
	bottom: "res2a_branch2a"
	top: "res2a_branch2a"
	name: "bn2a_branch2a"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res2a_branch2a"
	top: "res2a_branch2a"
	name: "scale2a_branch2a"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res2a_branch2a"
	top: "res2a_branch2a"
	name: "res2a_branch2a_relu"
	type: "ReLU"
}

layer {
	bottom: "res2a_branch2a"
	top: "res2a_branch2b"
	name: "res2a_branch2b"
	type: "Convolution"
	convolution_param {
		num_output: 64
		kernel_size: 3
		pad: 1
		stride: 1
		bias_term: false
	}
    param { lr_mult: 0.0 }
}

layer {
	bottom: "res2a_branch2b"
	top: "res2a_branch2b"
	name: "bn2a_branch2b"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res2a_branch2b"
	top: "res2a_branch2b"
	name: "scale2a_branch2b"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res2a_branch2b"
	top: "res2a_branch2b"
	name: "res2a_branch2b_relu"
	type: "ReLU"
}

layer {
	bottom: "res2a_branch2b"
	top: "res2a_branch2c"
	name: "res2a_branch2c"
	type: "Convolution"
	convolution_param {
		num_output: 256
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
    param { lr_mult: 0.0 }
}

layer {
	bottom: "res2a_branch2c"
	top: "res2a_branch2c"
	name: "bn2a_branch2c"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res2a_branch2c"
	top: "res2a_branch2c"
	name: "scale2a_branch2c"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res2a_branch1"
	bottom: "res2a_branch2c"
	top: "res2a"
	name: "res2a"
	type: "Eltwise"
}

layer {
	bottom: "res2a"
	top: "res2a"
	name: "res2a_relu"
	type: "ReLU"
}

layer {
	bottom: "res2a"
	top: "res2b_branch2a"
	name: "res2b_branch2a"
	type: "Convolution"
	convolution_param {
		num_output: 64
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
    param { lr_mult: 0.0 }
}

layer {
	bottom: "res2b_branch2a"
	top: "res2b_branch2a"
	name: "bn2b_branch2a"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res2b_branch2a"
	top: "res2b_branch2a"
	name: "scale2b_branch2a"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res2b_branch2a"
	top: "res2b_branch2a"
	name: "res2b_branch2a_relu"
	type: "ReLU"
}

layer {
	bottom: "res2b_branch2a"
	top: "res2b_branch2b"
	name: "res2b_branch2b"
	type: "Convolution"
	convolution_param {
		num_output: 64
		kernel_size: 3
		pad: 1
		stride: 1
		bias_term: false
	}
    param { lr_mult: 0.0 }
}

layer {
	bottom: "res2b_branch2b"
	top: "res2b_branch2b"
	name: "bn2b_branch2b"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res2b_branch2b"
	top: "res2b_branch2b"
	name: "scale2b_branch2b"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res2b_branch2b"
	top: "res2b_branch2b"
	name: "res2b_branch2b_relu"
	type: "ReLU"
}

layer {
	bottom: "res2b_branch2b"
	top: "res2b_branch2c"
	name: "res2b_branch2c"
	type: "Convolution"
	convolution_param {
		num_output: 256
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
    param { lr_mult: 0.0 }
}

layer {
	bottom: "res2b_branch2c"
	top: "res2b_branch2c"
	name: "bn2b_branch2c"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res2b_branch2c"
	top: "res2b_branch2c"
	name: "scale2b_branch2c"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res2a"
	bottom: "res2b_branch2c"
	top: "res2b"
	name: "res2b"
	type: "Eltwise"
}

layer {
	bottom: "res2b"
	top: "res2b"
	name: "res2b_relu"
	type: "ReLU"
}

layer {
	bottom: "res2b"
	top: "res2c_branch2a"
	name: "res2c_branch2a"
	type: "Convolution"
	convolution_param {
		num_output: 64
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
    param { lr_mult: 0.0 }
}

layer {
	bottom: "res2c_branch2a"
	top: "res2c_branch2a"
	name: "bn2c_branch2a"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res2c_branch2a"
	top: "res2c_branch2a"
	name: "scale2c_branch2a"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res2c_branch2a"
	top: "res2c_branch2a"
	name: "res2c_branch2a_relu"
	type: "ReLU"
}

layer {
	bottom: "res2c_branch2a"
	top: "res2c_branch2b"
	name: "res2c_branch2b"
	type: "Convolution"
	convolution_param {
		num_output: 64
		kernel_size: 3
		pad: 1
		stride: 1
		bias_term: false
	}
    param { lr_mult: 0.0 }
}

layer {
	bottom: "res2c_branch2b"
	top: "res2c_branch2b"
	name: "bn2c_branch2b"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res2c_branch2b"
	top: "res2c_branch2b"
	name: "scale2c_branch2b"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res2c_branch2b"
	top: "res2c_branch2b"
	name: "res2c_branch2b_relu"
	type: "ReLU"
}

layer {
	bottom: "res2c_branch2b"
	top: "res2c_branch2c"
	name: "res2c_branch2c"
	type: "Convolution"
	convolution_param {
		num_output: 256
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
    param { lr_mult: 0.0 }
}

layer {
	bottom: "res2c_branch2c"
	top: "res2c_branch2c"
	name: "bn2c_branch2c"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res2c_branch2c"
	top: "res2c_branch2c"
	name: "scale2c_branch2c"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res2b"
	bottom: "res2c_branch2c"
	top: "res2c"
	name: "res2c"
	type: "Eltwise"
}

layer {
	bottom: "res2c"
	top: "res2c"
	name: "res2c_relu"
	type: "ReLU"
}

layer {
	bottom: "res2c"
	top: "res3a_branch1"
	name: "res3a_branch1"
	type: "Convolution"
	convolution_param {
		num_output: 512
		kernel_size: 1
		pad: 0
		stride: 2
		bias_term: false
	}
    param { lr_mult: 1.0 }
}

layer {
	bottom: "res3a_branch1"
	top: "res3a_branch1"
	name: "bn3a_branch1"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3a_branch1"
	top: "res3a_branch1"
	name: "scale3a_branch1"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res2c"
	top: "res3a_branch2a"
	name: "res3a_branch2a"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 128
		kernel_size: 1
		pad: 0
		stride: 2
		bias_term: false
	}
}

layer {
	bottom: "res3a_branch2a"
	top: "res3a_branch2a"
	name: "bn3a_branch2a"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3a_branch2a"
	top: "res3a_branch2a"
	name: "scale3a_branch2a"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3a_branch2a"
	top: "res3a_branch2a"
	name: "res3a_branch2a_relu"
	type: "ReLU"
}

layer {
	bottom: "res3a_branch2a"
	top: "res3a_branch2b"
	name: "res3a_branch2b"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 128
		kernel_size: 3
		pad: 1
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res3a_branch2b"
	top: "res3a_branch2b"
	name: "bn3a_branch2b"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3a_branch2b"
	top: "res3a_branch2b"
	name: "scale3a_branch2b"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3a_branch2b"
	top: "res3a_branch2b"
	name: "res3a_branch2b_relu"
	type: "ReLU"
}

layer {
	bottom: "res3a_branch2b"
	top: "res3a_branch2c"
	name: "res3a_branch2c"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 512
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res3a_branch2c"
	top: "res3a_branch2c"
	name: "bn3a_branch2c"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3a_branch2c"
	top: "res3a_branch2c"
	name: "scale3a_branch2c"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3a_branch1"
	bottom: "res3a_branch2c"
	top: "res3a"
	name: "res3a"
	type: "Eltwise"
}

layer {
	bottom: "res3a"
	top: "res3a"
	name: "res3a_relu"
	type: "ReLU"
}

layer {
	bottom: "res3a"
	top: "res3b_branch2a"
	name: "res3b_branch2a"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 128
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res3b_branch2a"
	top: "res3b_branch2a"
	name: "bn3b_branch2a"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3b_branch2a"
	top: "res3b_branch2a"
	name: "scale3b_branch2a"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3b_branch2a"
	top: "res3b_branch2a"
	name: "res3b_branch2a_relu"
	type: "ReLU"
}

layer {
	bottom: "res3b_branch2a"
	top: "res3b_branch2b"
	name: "res3b_branch2b"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 128
		kernel_size: 3
		pad: 1
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res3b_branch2b"
	top: "res3b_branch2b"
	name: "bn3b_branch2b"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3b_branch2b"
	top: "res3b_branch2b"
	name: "scale3b_branch2b"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3b_branch2b"
	top: "res3b_branch2b"
	name: "res3b_branch2b_relu"
	type: "ReLU"
}

layer {
	bottom: "res3b_branch2b"
	top: "res3b_branch2c"
	name: "res3b_branch2c"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 512
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res3b_branch2c"
	top: "res3b_branch2c"
	name: "bn3b_branch2c"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3b_branch2c"
	top: "res3b_branch2c"
	name: "scale3b_branch2c"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3a"
	bottom: "res3b_branch2c"
	top: "res3b"
	name: "res3b"
	type: "Eltwise"
}

layer {
	bottom: "res3b"
	top: "res3b"
	name: "res3b_relu"
	type: "ReLU"
}

layer {
	bottom: "res3b"
	top: "res3c_branch2a"
	name: "res3c_branch2a"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 128
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res3c_branch2a"
	top: "res3c_branch2a"
	name: "bn3c_branch2a"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3c_branch2a"
	top: "res3c_branch2a"
	name: "scale3c_branch2a"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3c_branch2a"
	top: "res3c_branch2a"
	name: "res3c_branch2a_relu"
	type: "ReLU"
}

layer {
	bottom: "res3c_branch2a"
	top: "res3c_branch2b"
	name: "res3c_branch2b"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 128
		kernel_size: 3
		pad: 1
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res3c_branch2b"
	top: "res3c_branch2b"
	name: "bn3c_branch2b"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3c_branch2b"
	top: "res3c_branch2b"
	name: "scale3c_branch2b"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3c_branch2b"
	top: "res3c_branch2b"
	name: "res3c_branch2b_relu"
	type: "ReLU"
}

layer {
	bottom: "res3c_branch2b"
	top: "res3c_branch2c"
	name: "res3c_branch2c"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 512
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res3c_branch2c"
	top: "res3c_branch2c"
	name: "bn3c_branch2c"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3c_branch2c"
	top: "res3c_branch2c"
	name: "scale3c_branch2c"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3b"
	bottom: "res3c_branch2c"
	top: "res3c"
	name: "res3c"
	type: "Eltwise"
}

layer {
	bottom: "res3c"
	top: "res3c"
	name: "res3c_relu"
	type: "ReLU"
}

layer {
	bottom: "res3c"
	top: "res3d_branch2a"
	name: "res3d_branch2a"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 128
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res3d_branch2a"
	top: "res3d_branch2a"
	name: "bn3d_branch2a"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3d_branch2a"
	top: "res3d_branch2a"
	name: "scale3d_branch2a"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3d_branch2a"
	top: "res3d_branch2a"
	name: "res3d_branch2a_relu"
	type: "ReLU"
}

layer {
	bottom: "res3d_branch2a"
	top: "res3d_branch2b"
	name: "res3d_branch2b"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 128
		kernel_size: 3
		pad: 1
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res3d_branch2b"
	top: "res3d_branch2b"
	name: "bn3d_branch2b"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3d_branch2b"
	top: "res3d_branch2b"
	name: "scale3d_branch2b"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3d_branch2b"
	top: "res3d_branch2b"
	name: "res3d_branch2b_relu"
	type: "ReLU"
}

layer {
	bottom: "res3d_branch2b"
	top: "res3d_branch2c"
	name: "res3d_branch2c"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 512
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res3d_branch2c"
	top: "res3d_branch2c"
	name: "bn3d_branch2c"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3d_branch2c"
	top: "res3d_branch2c"
	name: "scale3d_branch2c"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3c"
	bottom: "res3d_branch2c"
	top: "res3d"
	name: "res3d"
	type: "Eltwise"
}

layer {
	bottom: "res3d"
	top: "res3d"
	name: "res3d_relu"
	type: "ReLU"
}

layer {
	bottom: "res3d"
	top: "res4a_branch1"
	name: "res4a_branch1"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 1024
		kernel_size: 1
		pad: 0
		stride: 2
		bias_term: false
	}
}

layer {
	bottom: "res4a_branch1"
	top: "res4a_branch1"
	name: "bn4a_branch1"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4a_branch1"
	top: "res4a_branch1"
	name: "scale4a_branch1"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res3d"
	top: "res4a_branch2a"
	name: "res4a_branch2a"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 256
		kernel_size: 1
		pad: 0
		stride: 2
		bias_term: false
	}
}

layer {
	bottom: "res4a_branch2a"
	top: "res4a_branch2a"
	name: "bn4a_branch2a"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4a_branch2a"
	top: "res4a_branch2a"
	name: "scale4a_branch2a"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4a_branch2a"
	top: "res4a_branch2a"
	name: "res4a_branch2a_relu"
	type: "ReLU"
}

layer {
	bottom: "res4a_branch2a"
	top: "res4a_branch2b"
	name: "res4a_branch2b"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 256
		kernel_size: 3
		pad: 1
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res4a_branch2b"
	top: "res4a_branch2b"
	name: "bn4a_branch2b"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4a_branch2b"
	top: "res4a_branch2b"
	name: "scale4a_branch2b"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4a_branch2b"
	top: "res4a_branch2b"
	name: "res4a_branch2b_relu"
	type: "ReLU"
}

layer {
	bottom: "res4a_branch2b"
	top: "res4a_branch2c"
	name: "res4a_branch2c"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 1024
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res4a_branch2c"
	top: "res4a_branch2c"
	name: "bn4a_branch2c"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4a_branch2c"
	top: "res4a_branch2c"
	name: "scale4a_branch2c"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4a_branch1"
	bottom: "res4a_branch2c"
	top: "res4a"
	name: "res4a"
	type: "Eltwise"
}

layer {
	bottom: "res4a"
	top: "res4a"
	name: "res4a_relu"
	type: "ReLU"
}

layer {
	bottom: "res4a"
	top: "res4b_branch2a"
	name: "res4b_branch2a"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 256
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res4b_branch2a"
	top: "res4b_branch2a"
	name: "bn4b_branch2a"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4b_branch2a"
	top: "res4b_branch2a"
	name: "scale4b_branch2a"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4b_branch2a"
	top: "res4b_branch2a"
	name: "res4b_branch2a_relu"
	type: "ReLU"
}

layer {
	bottom: "res4b_branch2a"
	top: "res4b_branch2b"
	name: "res4b_branch2b"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 256
		kernel_size: 3
		pad: 1
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res4b_branch2b"
	top: "res4b_branch2b"
	name: "bn4b_branch2b"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4b_branch2b"
	top: "res4b_branch2b"
	name: "scale4b_branch2b"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4b_branch2b"
	top: "res4b_branch2b"
	name: "res4b_branch2b_relu"
	type: "ReLU"
}

layer {
	bottom: "res4b_branch2b"
	top: "res4b_branch2c"
	name: "res4b_branch2c"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 1024
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res4b_branch2c"
	top: "res4b_branch2c"
	name: "bn4b_branch2c"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4b_branch2c"
	top: "res4b_branch2c"
	name: "scale4b_branch2c"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4a"
	bottom: "res4b_branch2c"
	top: "res4b"
	name: "res4b"
	type: "Eltwise"
}

layer {
	bottom: "res4b"
	top: "res4b"
	name: "res4b_relu"
	type: "ReLU"
}

layer {
	bottom: "res4b"
	top: "res4c_branch2a"
	name: "res4c_branch2a"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 256
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res4c_branch2a"
	top: "res4c_branch2a"
	name: "bn4c_branch2a"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4c_branch2a"
	top: "res4c_branch2a"
	name: "scale4c_branch2a"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4c_branch2a"
	top: "res4c_branch2a"
	name: "res4c_branch2a_relu"
	type: "ReLU"
}

layer {
	bottom: "res4c_branch2a"
	top: "res4c_branch2b"
	name: "res4c_branch2b"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 256
		kernel_size: 3
		pad: 1
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res4c_branch2b"
	top: "res4c_branch2b"
	name: "bn4c_branch2b"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4c_branch2b"
	top: "res4c_branch2b"
	name: "scale4c_branch2b"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4c_branch2b"
	top: "res4c_branch2b"
	name: "res4c_branch2b_relu"
	type: "ReLU"
}

layer {
	bottom: "res4c_branch2b"
	top: "res4c_branch2c"
	name: "res4c_branch2c"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 1024
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res4c_branch2c"
	top: "res4c_branch2c"
	name: "bn4c_branch2c"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4c_branch2c"
	top: "res4c_branch2c"
	name: "scale4c_branch2c"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4b"
	bottom: "res4c_branch2c"
	top: "res4c"
	name: "res4c"
	type: "Eltwise"
}

layer {
	bottom: "res4c"
	top: "res4c"
	name: "res4c_relu"
	type: "ReLU"
}

layer {
	bottom: "res4c"
	top: "res4d_branch2a"
	name: "res4d_branch2a"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 256
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res4d_branch2a"
	top: "res4d_branch2a"
	name: "bn4d_branch2a"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4d_branch2a"
	top: "res4d_branch2a"
	name: "scale4d_branch2a"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4d_branch2a"
	top: "res4d_branch2a"
	name: "res4d_branch2a_relu"
	type: "ReLU"
}

layer {
	bottom: "res4d_branch2a"
	top: "res4d_branch2b"
	name: "res4d_branch2b"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 256
		kernel_size: 3
		pad: 1
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res4d_branch2b"
	top: "res4d_branch2b"
	name: "bn4d_branch2b"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4d_branch2b"
	top: "res4d_branch2b"
	name: "scale4d_branch2b"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4d_branch2b"
	top: "res4d_branch2b"
	name: "res4d_branch2b_relu"
	type: "ReLU"
}

layer {
	bottom: "res4d_branch2b"
	top: "res4d_branch2c"
	name: "res4d_branch2c"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 1024
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res4d_branch2c"
	top: "res4d_branch2c"
	name: "bn4d_branch2c"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4d_branch2c"
	top: "res4d_branch2c"
	name: "scale4d_branch2c"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4c"
	bottom: "res4d_branch2c"
	top: "res4d"
	name: "res4d"
	type: "Eltwise"
}

layer {
	bottom: "res4d"
	top: "res4d"
	name: "res4d_relu"
	type: "ReLU"
}

layer {
	bottom: "res4d"
	top: "res4e_branch2a"
	name: "res4e_branch2a"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 256
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res4e_branch2a"
	top: "res4e_branch2a"
	name: "bn4e_branch2a"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4e_branch2a"
	top: "res4e_branch2a"
	name: "scale4e_branch2a"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4e_branch2a"
	top: "res4e_branch2a"
	name: "res4e_branch2a_relu"
	type: "ReLU"
}

layer {
	bottom: "res4e_branch2a"
	top: "res4e_branch2b"
	name: "res4e_branch2b"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 256
		kernel_size: 3
		pad: 1
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res4e_branch2b"
	top: "res4e_branch2b"
	name: "bn4e_branch2b"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4e_branch2b"
	top: "res4e_branch2b"
	name: "scale4e_branch2b"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4e_branch2b"
	top: "res4e_branch2b"
	name: "res4e_branch2b_relu"
	type: "ReLU"
}

layer {
	bottom: "res4e_branch2b"
	top: "res4e_branch2c"
	name: "res4e_branch2c"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 1024
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res4e_branch2c"
	top: "res4e_branch2c"
	name: "bn4e_branch2c"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4e_branch2c"
	top: "res4e_branch2c"
	name: "scale4e_branch2c"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4d"
	bottom: "res4e_branch2c"
	top: "res4e"
	name: "res4e"
	type: "Eltwise"
}

layer {
	bottom: "res4e"
	top: "res4e"
	name: "res4e_relu"
	type: "ReLU"
}

layer {
	bottom: "res4e"
	top: "res4f_branch2a"
	name: "res4f_branch2a"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 256
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res4f_branch2a"
	top: "res4f_branch2a"
	name: "bn4f_branch2a"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4f_branch2a"
	top: "res4f_branch2a"
	name: "scale4f_branch2a"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4f_branch2a"
	top: "res4f_branch2a"
	name: "res4f_branch2a_relu"
	type: "ReLU"
}

layer {
	bottom: "res4f_branch2a"
	top: "res4f_branch2b"
	name: "res4f_branch2b"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 256
		kernel_size: 3
		pad: 1
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res4f_branch2b"
	top: "res4f_branch2b"
	name: "bn4f_branch2b"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4f_branch2b"
	top: "res4f_branch2b"
	name: "scale4f_branch2b"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4f_branch2b"
	top: "res4f_branch2b"
	name: "res4f_branch2b_relu"
	type: "ReLU"
}

layer {
	bottom: "res4f_branch2b"
	top: "res4f_branch2c"
	name: "res4f_branch2c"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 1024
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res4f_branch2c"
	top: "res4f_branch2c"
	name: "bn4f_branch2c"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4f_branch2c"
	top: "res4f_branch2c"
	name: "scale4f_branch2c"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4e"
	bottom: "res4f_branch2c"
	top: "res4f"
	name: "res4f"
	type: "Eltwise"
}

layer {
	bottom: "res4f"
	top: "res4f"
	name: "res4f_relu"
	type: "ReLU"
}

layer {
	bottom: "res4f"
	top: "res5a_branch1"
	name: "res5a_branch1"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 2048
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res5a_branch1"
	top: "res5a_branch1"
	name: "bn5a_branch1"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res5a_branch1"
	top: "res5a_branch1"
	name: "scale5a_branch1"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res4f"
	top: "res5a_branch2a"
	name: "res5a_branch2a"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 512
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res5a_branch2a"
	top: "res5a_branch2a"
	name: "bn5a_branch2a"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res5a_branch2a"
	top: "res5a_branch2a"
	name: "scale5a_branch2a"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res5a_branch2a"
	top: "res5a_branch2a"
	name: "res5a_branch2a_relu"
	type: "ReLU"
}

layer {
	bottom: "res5a_branch2a"
	top: "res5a_branch2b"
	name: "res5a_branch2b"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 512
		kernel_size: 3
		pad: 2 dilation: 2
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res5a_branch2b"
	top: "res5a_branch2b"
	name: "bn5a_branch2b"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res5a_branch2b"
	top: "res5a_branch2b"
	name: "scale5a_branch2b"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res5a_branch2b"
	top: "res5a_branch2b"
	name: "res5a_branch2b_relu"
	type: "ReLU"
}

layer {
	bottom: "res5a_branch2b"
	top: "res5a_branch2c"
	name: "res5a_branch2c"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 2048
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res5a_branch2c"
	top: "res5a_branch2c"
	name: "bn5a_branch2c"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res5a_branch2c"
	top: "res5a_branch2c"
	name: "scale5a_branch2c"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res5a_branch1"
	bottom: "res5a_branch2c"
	top: "res5a"
	name: "res5a"
	type: "Eltwise"
}

layer {
	bottom: "res5a"
	top: "res5a"
	name: "res5a_relu"
	type: "ReLU"
}

layer {
	bottom: "res5a"
	top: "res5b_branch2a"
	name: "res5b_branch2a"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 512
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res5b_branch2a"
	top: "res5b_branch2a"
	name: "bn5b_branch2a"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res5b_branch2a"
	top: "res5b_branch2a"
	name: "scale5b_branch2a"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res5b_branch2a"
	top: "res5b_branch2a"
	name: "res5b_branch2a_relu"
	type: "ReLU"
}

layer {
	bottom: "res5b_branch2a"
	top: "res5b_branch2b"
	name: "res5b_branch2b"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 512
		kernel_size: 3
		pad: 2 dilation: 2
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res5b_branch2b"
	top: "res5b_branch2b"
	name: "bn5b_branch2b"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res5b_branch2b"
	top: "res5b_branch2b"
	name: "scale5b_branch2b"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res5b_branch2b"
	top: "res5b_branch2b"
	name: "res5b_branch2b_relu"
	type: "ReLU"
}

layer {
	bottom: "res5b_branch2b"
	top: "res5b_branch2c"
	name: "res5b_branch2c"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 2048
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res5b_branch2c"
	top: "res5b_branch2c"
	name: "bn5b_branch2c"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res5b_branch2c"
	top: "res5b_branch2c"
	name: "scale5b_branch2c"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res5a"
	bottom: "res5b_branch2c"
	top: "res5b"
	name: "res5b"
	type: "Eltwise"
}

layer {
	bottom: "res5b"
	top: "res5b"
	name: "res5b_relu"
	type: "ReLU"
}

layer {
	bottom: "res5b"
	top: "res5c_branch2a"
	name: "res5c_branch2a"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 512
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res5c_branch2a"
	top: "res5c_branch2a"
	name: "bn5c_branch2a"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res5c_branch2a"
	top: "res5c_branch2a"
	name: "scale5c_branch2a"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}
layer {
	bottom: "res5c_branch2a"
	top: "res5c_branch2a"
	name: "res5c_branch2a_relu"
	type: "ReLU"
}
layer {
	bottom: "res5c_branch2a"
	top: "res5c_branch2b"
	name: "res5c_branch2b"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 512
		kernel_size: 3
		pad: 2 dilation: 2
		stride: 1
		bias_term: false
	}
}
layer {
	bottom: "res5c_branch2b"
	top: "res5c_branch2b"
	name: "bn5c_branch2b"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}
layer {
	bottom: "res5c_branch2b"
	top: "res5c_branch2b"
	name: "scale5c_branch2b"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}
layer {
	bottom: "res5c_branch2b"
	top: "res5c_branch2b"
	name: "res5c_branch2b_relu"
	type: "ReLU"
}

layer {
	bottom: "res5c_branch2b"
	top: "res5c_branch2c"
	name: "res5c_branch2c"
	type: "Convolution"
    param { lr_mult: 1 }
	convolution_param {
		num_output: 2048
		kernel_size: 1
		pad: 0
		stride: 1
		bias_term: false
	}
}

layer {
	bottom: "res5c_branch2c"
	top: "res5c_branch2c"
	name: "bn5c_branch2c"
	type: "BatchNorm"
	batch_norm_param {
		use_global_stats: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res5c_branch2c"
	top: "res5c_branch2c"
	name: "scale5c_branch2c"
	type: "Scale"
	scale_param {
		bias_term: true
	}
    param { lr_mult: 0 decay_mult: 0 }
    param { lr_mult: 0 decay_mult: 0 }
}

layer {
	bottom: "res5b"
	bottom: "res5c_branch2c"
	top: "res5c"
	name: "res5c"
	type: "Eltwise"
}

layer {
	bottom: "res5c"
	top: "res5c"
	name: "res5c_relu"
	type: "ReLU"
}

#============== FPN ==============
layer {
  name: "fpn_pool5"
  type: "Convolution"
  bottom: "res5c"
  top: "fpn_conv5"
  param { lr_mult: 1 decay_mult: 1.0 }
  param { lr_mult: 2 decay_mult: 0.0 }
  convolution_param {
    num_output: 256
    kernel_size: 1
    stride: 1 pad: 0
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" std: 0 }
  }
}
layer {
  name: "fpn_P5"
  type: "Pooling"
  bottom: "fpn_conv5"
  top: "fpn_pool5"
  pooling_param {
     kernel_size: 2
     stride: 2
     pool: MAX
  }
}
layer {
  bottom: "fpn_pool5"
  top: "fpn_pool5"
  name: "fpn_pool5/gn"
  type: "GroupNorm"
} 
layer {
  name: "fpn_conv4"
  type: "Convolution"
  bottom: "res4f"
  top: "fpn_conv4"
  param { lr_mult: 1 }
  param { lr_mult: 2 }
  convolution_param {
    num_output: 256
    kernel_size: 1
    stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" std: 0 }
  }
}
layer { 
    name: "fpn_merge_conv4"
    bottom: "fpn_conv5"
    bottom: "fpn_conv4"
    top: "fpn_merge_conv4"
    type: "Eltwise"
}
layer {
  name: "fpn_pool4"
  type: "Convolution"
  bottom: "fpn_merge_conv4"
  top: "fpn_pool4"
  param { lr_mult: 1 }
  param { lr_mult: 2 }
  convolution_param {
    num_output: 256
    kernel_size: 3 stride: 1 pad: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" std: 0 }
  }
}
layer {
  bottom: "fpn_pool4"
  top: "fpn_pool4"
  name: "fpn_pool4/gn"
  type: "GroupNorm"
} 
layer {
  name: "fpn_upscore_conv4"
  type: "Upsample"
  bottom: "fpn_pool4"
  top: "fpn_upscore_conv4"
  upsample_param { scale: 2 }
}
layer {
  name: "fpn_conv3"
  type: "Convolution"
  bottom: "res3d"
  top: "fpn_conv3"
  param { lr_mult: 1 }
  param { lr_mult: 2 }
  convolution_param {
    num_output: 256 
    kernel_size: 1
    stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" std: 0 }
  }
}
layer {
  name: "fpn_upscore_conv4_crop"
  type: "Crop"
  bottom: "fpn_upscore_conv4"
  bottom: "fpn_conv3"
  top: "fpn_upscore_conv4_crop"
  crop_param { axis: 2 offset: 0 }
}
layer {
    name: "fpn_merge_conv3"
    bottom: "fpn_upscore_conv4_crop"
    bottom: "fpn_conv3"
    top: "fpn_merge_conv3"
    type: "Eltwise"
}
layer {
  name: "fpn_pool3"
  type: "Convolution"
  bottom: "fpn_merge_conv3"
  top: "fpn_pool3"
  param { lr_mult: 1 }
  param { lr_mult: 2 }
  convolution_param {
    num_output: 256
    kernel_size: 3 stride: 1 pad: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" std: 0 }
  }
}
layer {
  bottom: "fpn_pool3"
  top: "fpn_pool3"
  name: "fpn_pool3/gn"
  type: "GroupNorm"
} 
layer {
  name: "fpn_pool6"
  type: "Convolution"
  bottom: "res5c"
  top: "fpn_pool6"
  param { lr_mult: 1 }
  param { lr_mult: 2 }
  convolution_param {
    num_output: 256
    kernel_size: 3 stride: 4 pad: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" std: 0 }
  }
}
layer {
  bottom: "fpn_pool6"
  top: "fpn_pool6"
  name: "fpn_pool6/gn"
  type: "GroupNorm"
} 
layer {
   top: "fpn_relu6"
   bottom: "fpn_pool6"
   name: "fpn_relu6"
   type: "ReLU"
}

layer {
  name: "fpn_pool7"
  type: "Convolution"
  bottom: "fpn_relu6"
  top: "fpn_pool7"
  param { lr_mult: 1 }
  param { lr_mult: 2 }
  convolution_param {
    num_output: 256
    kernel_size: 3 stride: 2 pad: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" std: 0 }
  }
}
layer {
  bottom: "fpn_pool7"
  top: "fpn_pool7"
  name: "fpn_pool7/gn"
  type: "GroupNorm"
}

#============ RPN Pool3============
layer {
  name: "fpn_conv3x3_P3_CA1"
  type: "Convolution"
  bottom: "fpn_pool3"
  top: "fpn_conv3x3_P3_CA1"
  param { name: "fpn_conv3x3_cw1" lr_mult: 1.0 decay_mult: 1.0 }
  convolution_param {
    bias_term: false
    num_output: 256
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
  }
}
layer {
  name: "fpn_conv3x3_P3_CA1/gn"
  type: "GroupNorm"
  bottom: "fpn_conv3x3_P3_CA1"
  top: "fpn_conv3x3_P3_CA1"
}
layer {
  name: "fpn_conv3x3_P3_CA1/gn/scale"
  type: "Scale"
  bottom: "fpn_conv3x3_P3_CA1"
  top: "fpn_conv3x3_P3_CA1"
  scale_param {
    bias_term: true
    filler { type: "constant" value: 1 }
    bias_filler { type: "constant" value: 0 }
  }
  param { name: "fpn_conv3x3_cs1" lr_mult: 1.0 decay_mult: 0.0 }
  param { name: "fpn_conv3x3_cb1" lr_mult: 2.0 decay_mult: 0 }
}
layer {
  name: "fpn_relu3x3_P3_CA1"
  type: "ReLU"
  bottom: "fpn_conv3x3_P3_CA1"
  top: "fpn_conv3x3_P3_CA1"
}
layer {
  name: "fpn_conv3x3_P3_CA2"
  type: "Convolution"
  bottom: "fpn_conv3x3_P3_CA1"
  top: "fpn_conv3x3_P3_CA2"
  param { name: "fpn_conv3x3_cw2" lr_mult: 1.0 decay_mult: 1.0 }
  convolution_param {
    bias_term: false
    num_output: 256
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
  }
}
layer {
  name: "fpn_conv3x3_P3_CA2/gn"
  type: "GroupNorm"
  bottom: "fpn_conv3x3_P3_CA2"
  top: "fpn_conv3x3_P3_CA2"
}
layer {
  name: "fpn_conv3x3_P3_CA2/gn/scale"
  type: "Scale"
  bottom: "fpn_conv3x3_P3_CA2"
  top: "fpn_conv3x3_P3_CA2"
  scale_param {
    bias_term: true
    filler { type: "constant" value: 1 }
    bias_filler { type: "constant" value: 0 }
  }
  param { name: "fpn_conv3x3_cs2" lr_mult: 1.0 decay_mult: 0.0 }
  param { name: "fpn_conv3x3_cb2" lr_mult: 2.0 decay_mult: 0 }
}
layer {
  name: "fpn_relu3x3_P3_CA2"
  type: "ReLU"
  bottom: "fpn_conv3x3_P3_CA2"
  top: "fpn_conv3x3_P3_CA2"
}
layer {
  name: "fpn_conv3x3_P3_BA1"
  type: "Convolution"
  bottom: "fpn_pool3"
  top: "fpn_conv3x3_P3_BA1"
  param { name: "fpn_conv3x3_bw1" lr_mult: 1.0 decay_mult: 1.0 }
  convolution_param {
    bias_term: false
    num_output: 256
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
  }
}
layer {
  name: "fpn_conv3x3_P3_BA1/gn"
  type: "GroupNorm"
  bottom: "fpn_conv3x3_P3_BA1"
  top: "fpn_conv3x3_P3_BA1"
}
layer {
  name: "fpn_conv3x3_P3_BA1/gn/scale"
  type: "Scale"
  bottom: "fpn_conv3x3_P3_BA1"
  top: "fpn_conv3x3_P3_BA1"
  scale_param {
    bias_term: true
    filler { type: "constant" value: 1 }
    bias_filler { type: "constant" value: 0 }
  }
  param { name: "fpn_conv3x3_bs1" lr_mult: 1.0 decay_mult: 0.0 }
  param { name: "fpn_conv3x3_bb1" lr_mult: 2.0 decay_mult: 0 }
}
layer {
  name: "fpn_relu3x3_P3_BA1"
  type: "ReLU"
  bottom: "fpn_conv3x3_P3_BA1"
  top: "fpn_conv3x3_P3_BA1"
}
layer {
  name: "fpn_conv3x3_P3_BA2"
  type: "Convolution"
  bottom: "fpn_conv3x3_P3_BA1"
  top: "fpn_conv3x3_P3_BA2"
  param { name: "fpn_conv3x3_bw2" lr_mult: 1.0 decay_mult: 1.0 }
  convolution_param {
    bias_term: false
    num_output: 256
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
  }
}
layer {
  name: "fpn_conv3x3_P3_BA2/gn"
  type: "GroupNorm"
  bottom: "fpn_conv3x3_P3_BA2"
  top: "fpn_conv3x3_P3_BA2"
}
layer {
  name: "fpn_conv3x3_P3_BA2/gn/scale"
  type: "Scale"
  bottom: "fpn_conv3x3_P3_BA2"
  top: "fpn_conv3x3_P3_BA2"
  scale_param {
    bias_term: true
    filler { type: "constant" value: 1 }
    bias_filler { type: "constant" value: 0 }
  }
  param { name: "fpn_conv3x3_bs2" lr_mult: 1.0 decay_mult: 0.0 }
  param { name: "fpn_conv3x3_bb2" lr_mult: 2.0 decay_mult: 0 }
}
layer {
  name: "fpn_relu3x3_P3_BA2"
  type: "ReLU"
  bottom: "fpn_conv3x3_P3_BA2"
  top: "fpn_conv3x3_P3_BA2"
}
layer {
  name: "cls_score_P3"
  type: "Convolution"
  bottom: "fpn_conv3x3_P3_CA2"
  top: "cls_score_P3"
  param { name: "cls_score_w" lr_mult: 1.0 decay_mult: 1.0 }
  param { name: "cls_score_b" lr_mult: 2.0 decay_mult: 0.0 }
  convolution_param {
    num_output: 480   # 80 (classes) * 9(anchors)
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" value: -4.595 }
  }
}
layer {
  name: "bbox_pred_P3"
  type: "Convolution"
  bottom: "fpn_conv3x3_P3_BA2"
  top: "bbox_pred_P3"
  param { name: "bbox_pred_w" lr_mult: 1.0 decay_mult: 1.0 }
  param { name: "bbox_pred_b" lr_mult: 2.0 decay_mult: 0 }
  convolution_param {
    num_output: 24   # 4 * 9(anchors)
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" value: 0 }
  }
}

#============ RPN Pool4============
layer {
  name: "fpn_conv3x3_P4_CA1"
  type: "Convolution"
  bottom: "fpn_pool4"
  top: "fpn_conv3x3_P4_CA1"
  param { name: "fpn_conv3x3_cw1" lr_mult: 1.0 decay_mult: 1.0 }
  convolution_param {
    bias_term: false
    num_output: 256
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
  }
}
layer {
  name: "fpn_conv3x3_P4_CA1/gn"
  type: "GroupNorm"
  bottom: "fpn_conv3x3_P4_CA1"
  top: "fpn_conv3x3_P4_CA1"
}
layer {
  name: "fpn_conv3x3_P4_CA1/gn/scale"
  type: "Scale"
  bottom: "fpn_conv3x3_P4_CA1"
  top: "fpn_conv3x3_P4_CA1"
  scale_param {
    bias_term: true
    filler { type: "constant" value: 1 }
    bias_filler { type: "constant" value: 0 }
  }
  param { name: "fpn_conv3x3_cs1" lr_mult: 1.0 decay_mult: 0.0 }
  param { name: "fpn_conv3x3_cb1" lr_mult: 2.0 decay_mult: 0 }
}
layer {
  name: "fpn_relu3x3_P4_CA1"
  type: "ReLU"
  bottom: "fpn_conv3x3_P4_CA1"
  top: "fpn_conv3x3_P4_CA1"
}
layer {
  name: "fpn_conv3x3_P4_CA2"
  type: "Convolution"
  bottom: "fpn_conv3x3_P4_CA1"
  top: "fpn_conv3x3_P4_CA2"
  param { name: "fpn_conv3x3_cw2" lr_mult: 1.0 decay_mult: 1.0 }
  convolution_param {
    bias_term: false
    num_output: 256
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
  }
}
layer {
  name: "fpn_conv3x3_P4_CA2/gn"
  type: "GroupNorm"
  bottom: "fpn_conv3x3_P4_CA2"
  top: "fpn_conv3x3_P4_CA2"
}
layer {
  name: "fpn_conv3x3_P4_CA2/gn/scale"
  type: "Scale"
  bottom: "fpn_conv3x3_P4_CA2"
  top: "fpn_conv3x3_P4_CA2"
  scale_param {
    bias_term: true
    filler { type: "constant" value: 1 }
    bias_filler { type: "constant" value: 0 }
  }
  param { name: "fpn_conv3x3_cs2" lr_mult: 1.0 decay_mult: 0.0 }
  param { name: "fpn_conv3x3_cb2" lr_mult: 2.0 decay_mult: 0 }
}
layer {
  name: "fpn_relu3x3_P4_CA2"
  type: "ReLU"
  bottom: "fpn_conv3x3_P4_CA2"
  top: "fpn_conv3x3_P4_CA2"
}
layer {
  name: "fpn_conv3x3_P4_BA1"
  type: "Convolution"
  bottom: "fpn_pool4"
  top: "fpn_conv3x3_P4_BA1"
  param { name: "fpn_conv3x3_bw1" lr_mult: 1.0 decay_mult: 1.0 }
  convolution_param {
    bias_term: false
    num_output: 256
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
  }
}
layer {
  name: "fpn_conv3x3_P4_BA1/gn"
  type: "GroupNorm"
  bottom: "fpn_conv3x3_P4_BA1"
  top: "fpn_conv3x3_P4_BA1"
}
layer {
  name: "fpn_conv3x3_P4_BA1/gn/scale"
  type: "Scale"
  bottom: "fpn_conv3x3_P4_BA1"
  top: "fpn_conv3x3_P4_BA1"
  scale_param {
    bias_term: true
    filler { type: "constant" value: 1 }
    bias_filler { type: "constant" value: 0 }
  }
  param { name: "fpn_conv3x3_bs1" lr_mult: 1.0 decay_mult: 0.0 }
  param { name: "fpn_conv3x3_bb1" lr_mult: 2.0 decay_mult: 0 }
}
layer {
  name: "fpn_relu3x3_P4_BA1"
  type: "ReLU"
  bottom: "fpn_conv3x3_P4_BA1"
  top: "fpn_conv3x3_P4_BA1"
}
layer {
  name: "fpn_conv3x3_P4_BA2"
  type: "Convolution"
  bottom: "fpn_conv3x3_P4_BA1"
  top: "fpn_conv3x3_P4_BA2"
  param { name: "fpn_conv3x3_bw2" lr_mult: 1.0 decay_mult: 1.0 }
  convolution_param {
    bias_term: false
    num_output: 256
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
  }
}
layer {
  name: "fpn_conv3x3_P4_BA2/gn"
  type: "GroupNorm"
  bottom: "fpn_conv3x3_P4_BA2"
  top: "fpn_conv3x3_P4_BA2"
}
layer {
  name: "fpn_conv3x3_P4_BA2/gn/scale"
  type: "Scale"
  bottom: "fpn_conv3x3_P4_BA2"
  top: "fpn_conv3x3_P4_BA2"
  scale_param {
    bias_term: true
    filler { type: "constant" value: 1 }
    bias_filler { type: "constant" value: 0 }
  }
  param { name: "fpn_conv3x3_bs2" lr_mult: 1.0 decay_mult: 0.0 }
  param { name: "fpn_conv3x3_bb2" lr_mult: 2.0 decay_mult: 0 }
}
layer {
  name: "fpn_relu3x3_P4_BA2"
  type: "ReLU"
  bottom: "fpn_conv3x3_P4_BA2"
  top: "fpn_conv3x3_P4_BA2"
}
layer {
  name: "cls_score_P4"
  type: "Convolution"
  bottom: "fpn_conv3x3_P4_CA2"
  top: "cls_score_P4"
  param { name: "cls_score_w" lr_mult: 1.0 decay_mult: 1.0 }
  param { name: "cls_score_b" lr_mult: 2.0 decay_mult: 0.0 }
  convolution_param {
    num_output: 480   # 80 (classes) * 9(anchors)
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" value: -4.595 }
  }
}
layer {
  name: "bbox_pred_P4"
  type: "Convolution"
  bottom: "fpn_conv3x3_P4_BA2"
  top: "bbox_pred_P4"
  param { name: "bbox_pred_w" lr_mult: 1.0 decay_mult: 1.0 }
  param { name: "bbox_pred_b" lr_mult: 2.0 decay_mult: 0 }
  convolution_param {
    num_output: 24   # 4 * 9(anchors)
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" value: 0 }
  }
}

#============ RPN Pool5============
layer {
  name: "fpn_conv3x3_P5_CA1"
  type: "Convolution"
  bottom: "fpn_pool5"
  top: "fpn_conv3x3_P5_CA1"
  param { name: "fpn_conv3x3_cw1" lr_mult: 1.0 decay_mult: 1.0 }
  convolution_param {
    bias_term: false
    num_output: 256
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
  }
}
layer {
  name: "fpn_conv3x3_P5_CA1/gn"
  type: "GroupNorm"
  bottom: "fpn_conv3x3_P5_CA1"
  top: "fpn_conv3x3_P5_CA1"
}
layer {
  name: "fpn_conv3x3_P5_CA1/gn/scale"
  type: "Scale"
  bottom: "fpn_conv3x3_P5_CA1"
  top: "fpn_conv3x3_P5_CA1"
  scale_param {
    bias_term: true
    filler { type: "constant" value: 1 }
    bias_filler { type: "constant" value: 0 }
  }
  param { name: "fpn_conv3x3_cs1" lr_mult: 1.0 decay_mult: 0.0 }
  param { name: "fpn_conv3x3_cb1" lr_mult: 2.0 decay_mult: 0 }
}
layer {
  name: "fpn_relu3x3_P5_CA1"
  type: "ReLU"
  bottom: "fpn_conv3x3_P5_CA1"
  top: "fpn_conv3x3_P5_CA1"
}
layer {
  name: "fpn_conv3x3_P5_CA2"
  type: "Convolution"
  bottom: "fpn_conv3x3_P5_CA1"
  top: "fpn_conv3x3_P5_CA2"
  param { name: "fpn_conv3x3_cw2" lr_mult: 1.0 decay_mult: 1.0 }
  convolution_param {
    bias_term: false
    num_output: 256
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
  }
}
layer {
  name: "fpn_conv3x3_P5_CA2/gn"
  type: "GroupNorm"
  bottom: "fpn_conv3x3_P5_CA2"
  top: "fpn_conv3x3_P5_CA2"
}
layer {
  name: "fpn_conv3x3_P5_CA2/gn/scale"
  type: "Scale"
  bottom: "fpn_conv3x3_P5_CA2"
  top: "fpn_conv3x3_P5_CA2"
  scale_param {
    bias_term: true
    filler { type: "constant" value: 1 }
    bias_filler { type: "constant" value: 0 }
  }
  param { name: "fpn_conv3x3_cs2" lr_mult: 1.0 decay_mult: 0.0 }
  param { name: "fpn_conv3x3_cb2" lr_mult: 2.0 decay_mult: 0 }
}
layer {
  name: "fpn_relu3x3_P5_CA2"
  type: "ReLU"
  bottom: "fpn_conv3x3_P5_CA2"
  top: "fpn_conv3x3_P5_CA2"
}
layer {
  name: "fpn_conv3x3_P5_BA1"
  type: "Convolution"
  bottom: "fpn_pool5"
  top: "fpn_conv3x3_P5_BA1"
  param { name: "fpn_conv3x3_bw1" lr_mult: 1.0 decay_mult: 1.0 }
  convolution_param {
    bias_term: false
    num_output: 256
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
  }
}
layer {
  name: "fpn_conv3x3_P5_BA1/gn"
  type: "GroupNorm"
  bottom: "fpn_conv3x3_P5_BA1"
  top: "fpn_conv3x3_P5_BA1"
}
layer {
  name: "fpn_conv3x3_P5_BA1/gn/scale"
  type: "Scale"
  bottom: "fpn_conv3x3_P5_BA1"
  top: "fpn_conv3x3_P5_BA1"
  scale_param {
    bias_term: true
    filler { type: "constant" value: 1 }
    bias_filler { type: "constant" value: 0 }
  }
  param { name: "fpn_conv3x3_bs1" lr_mult: 1.0 decay_mult: 0.0 }
  param { name: "fpn_conv3x3_bb1" lr_mult: 2.0 decay_mult: 0 }
}
layer {
  name: "fpn_relu3x3_P5_BA1"
  type: "ReLU"
  bottom: "fpn_conv3x3_P5_BA1"
  top: "fpn_conv3x3_P5_BA1"
}
layer {
  name: "fpn_conv3x3_P5_BA2"
  type: "Convolution"
  bottom: "fpn_conv3x3_P5_BA1"
  top: "fpn_conv3x3_P5_BA2"
  param { name: "fpn_conv3x3_bw2" lr_mult: 1.0 decay_mult: 1.0 }
  convolution_param {
    bias_term: false
    num_output: 256
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
  }
}
layer {
  name: "fpn_conv3x3_P5_BA2/gn"
  type: "GroupNorm"
  bottom: "fpn_conv3x3_P5_BA2"
  top: "fpn_conv3x3_P5_BA2"
}
layer {
  name: "fpn_conv3x3_P5_BA2/gn/scale"
  type: "Scale"
  bottom: "fpn_conv3x3_P5_BA2"
  top: "fpn_conv3x3_P5_BA2"
  scale_param {
    bias_term: true
    filler { type: "constant" value: 1 }
    bias_filler { type: "constant" value: 0 }
  }
  param { name: "fpn_conv3x3_bs2" lr_mult: 1.0 decay_mult: 0.0 }
  param { name: "fpn_conv3x3_bb2" lr_mult: 2.0 decay_mult: 0 }
}
layer {
  name: "fpn_relu3x3_P5_BA2"
  type: "ReLU"
  bottom: "fpn_conv3x3_P5_BA2"
  top: "fpn_conv3x3_P5_BA2"
}
layer {
  name: "cls_score_P5"
  type: "Convolution"
  bottom: "fpn_conv3x3_P5_CA2"
  top: "cls_score_P5"
  param { name: "cls_score_w" lr_mult: 1.0 decay_mult: 1.0 }
  param { name: "cls_score_b" lr_mult: 2.0 decay_mult: 0.0 }
  convolution_param {
    num_output: 480   # 80 (classes) * 9(anchors)
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" value: -4.595 }
  }
}
layer {
  name: "bbox_pred_P5"
  type: "Convolution"
  bottom: "fpn_conv3x3_P5_BA2"
  top: "bbox_pred_P5"
  param { name: "bbox_pred_w" lr_mult: 1.0 decay_mult: 1.0 }
  param { name: "bbox_pred_b" lr_mult: 2.0 decay_mult: 0 }
  convolution_param {
    num_output: 24   # 4 * 9(anchors)
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" value: 0 }
  }
}

#============ RPN Pool6============
layer {
  name: "fpn_conv3x3_P6_CA1"
  type: "Convolution"
  bottom: "fpn_pool6"
  top: "fpn_conv3x3_P6_CA1"
  param { name: "fpn_conv3x3_cw1" lr_mult: 1.0 decay_mult: 1.0 }
  convolution_param {
    bias_term: false
    num_output: 256
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
  }
}
layer {
  name: "fpn_conv3x3_P6_CA1/gn"
  type: "GroupNorm"
  bottom: "fpn_conv3x3_P6_CA1"
  top: "fpn_conv3x3_P6_CA1"
}
layer {
  name: "fpn_conv3x3_P6_CA1/gn/scale"
  type: "Scale"
  bottom: "fpn_conv3x3_P6_CA1"
  top: "fpn_conv3x3_P6_CA1"
  scale_param {
    bias_term: true
    filler { type: "constant" value: 1 }
    bias_filler { type: "constant" value: 0 }
  }
  param { name: "fpn_conv3x3_cs1" lr_mult: 1.0 decay_mult: 0.0 }
  param { name: "fpn_conv3x3_cb1" lr_mult: 2.0 decay_mult: 0 }
}
layer {
  name: "fpn_relu3x3_P6_CA1"
  type: "ReLU"
  bottom: "fpn_conv3x3_P6_CA1"
  top: "fpn_conv3x3_P6_CA1"
}
layer {
  name: "fpn_conv3x3_P6_CA2"
  type: "Convolution"
  bottom: "fpn_conv3x3_P6_CA1"
  top: "fpn_conv3x3_P6_CA2"
  param { name: "fpn_conv3x3_cw2" lr_mult: 1.0 decay_mult: 1.0 }
  convolution_param {
    bias_term: false
    num_output: 256
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
  }
}
layer {
  name: "fpn_conv3x3_P6_CA2/gn"
  type: "GroupNorm"
  bottom: "fpn_conv3x3_P6_CA2"
  top: "fpn_conv3x3_P6_CA2"
}
layer {
  name: "fpn_conv3x3_P6_CA2/gn/scale"
  type: "Scale"
  bottom: "fpn_conv3x3_P6_CA2"
  top: "fpn_conv3x3_P6_CA2"
  scale_param {
    bias_term: true
    filler { type: "constant" value: 1 }
    bias_filler { type: "constant" value: 0 }
  }
  param { name: "fpn_conv3x3_cs2" lr_mult: 1.0 decay_mult: 0.0 }
  param { name: "fpn_conv3x3_cb2" lr_mult: 2.0 decay_mult: 0 }
}
layer {
  name: "fpn_relu3x3_P6_CA2"
  type: "ReLU"
  bottom: "fpn_conv3x3_P6_CA2"
  top: "fpn_conv3x3_P6_CA2"
}
layer {
  name: "fpn_conv3x3_P6_BA1"
  type: "Convolution"
  bottom: "fpn_pool6"
  top: "fpn_conv3x3_P6_BA1"
  param { name: "fpn_conv3x3_bw1" lr_mult: 1.0 decay_mult: 1.0 }
  convolution_param {
    bias_term: false
    num_output: 256
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
  }
}
layer {
  name: "fpn_conv3x3_P6_BA1/gn"
  type: "GroupNorm"
  bottom: "fpn_conv3x3_P6_BA1"
  top: "fpn_conv3x3_P6_BA1"
}
layer {
  name: "fpn_conv3x3_P6_BA1/gn/scale"
  type: "Scale"
  bottom: "fpn_conv3x3_P6_BA1"
  top: "fpn_conv3x3_P6_BA1"
  scale_param {
    bias_term: true
    filler { type: "constant" value: 1 }
    bias_filler { type: "constant" value: 0 }
  }
  param { name: "fpn_conv3x3_bs1" lr_mult: 1.0 decay_mult: 0.0 }
  param { name: "fpn_conv3x3_bb1" lr_mult: 2.0 decay_mult: 0 }
}
layer {
  name: "fpn_relu3x3_P6_BA1"
  type: "ReLU"
  bottom: "fpn_conv3x3_P6_BA1"
  top: "fpn_conv3x3_P6_BA1"
}
layer {
  name: "fpn_conv3x3_P6_BA2"
  type: "Convolution"
  bottom: "fpn_conv3x3_P6_BA1"
  top: "fpn_conv3x3_P6_BA2"
  param { name: "fpn_conv3x3_bw2" lr_mult: 1.0 decay_mult: 1.0 }
  convolution_param {
    bias_term: false
    num_output: 256
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
  }
}
layer {
  name: "fpn_conv3x3_P6_BA2/gn"
  type: "GroupNorm"
  bottom: "fpn_conv3x3_P6_BA2"
  top: "fpn_conv3x3_P6_BA2"
}
layer {
  name: "fpn_conv3x3_P6_BA2/gn/scale"
  type: "Scale"
  bottom: "fpn_conv3x3_P6_BA2"
  top: "fpn_conv3x3_P6_BA2"
  scale_param {
    bias_term: true
    filler { type: "constant" value: 1 }
    bias_filler { type: "constant" value: 0 }
  }
  param { name: "fpn_conv3x3_bs2" lr_mult: 1.0 decay_mult: 0.0 }
  param { name: "fpn_conv3x3_bb2" lr_mult: 2.0 decay_mult: 0 }
}
layer {
  name: "fpn_relu3x3_P6_BA2"
  type: "ReLU"
  bottom: "fpn_conv3x3_P6_BA2"
  top: "fpn_conv3x3_P6_BA2"
}
layer {
  name: "cls_score_P6"
  type: "Convolution"
  bottom: "fpn_conv3x3_P6_CA2"
  top: "cls_score_P6"
  param { name: "cls_score_w" lr_mult: 1.0 decay_mult: 1.0 }
  param { name: "cls_score_b" lr_mult: 2.0 decay_mult: 0.0 }
  convolution_param {
    num_output: 480   # 80 (classes) * 9(anchors)
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" value: -4.595 }
  }
}
layer {
  name: "bbox_pred_P6"
  type: "Convolution"
  bottom: "fpn_conv3x3_P6_BA2"
  top: "bbox_pred_P6"
  param { name: "bbox_pred_w" lr_mult: 1.0 decay_mult: 1.0 }
  param { name: "bbox_pred_b" lr_mult: 2.0 decay_mult: 0 }
  convolution_param {
    num_output: 24   # 4 * 9(anchors)
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" value: 0 }
  }
}

#============ RPN Pool7 ============
layer {
  name: "fpn_conv3x3_P7_CA1"
  type: "Convolution"
  bottom: "fpn_pool7"
  top: "fpn_conv3x3_P7_CA1"
  param { name: "fpn_conv3x3_cw1" lr_mult: 1.0 decay_mult: 1.0 }
  convolution_param {
    bias_term: false
    num_output: 256
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
  }
}
layer {
  name: "fpn_conv3x3_P7_CA1/gn"
  type: "GroupNorm"
  bottom: "fpn_conv3x3_P7_CA1"
  top: "fpn_conv3x3_P7_CA1"
}
layer {
  name: "fpn_conv3x3_P7_CA1/gn/scale"
  type: "Scale"
  bottom: "fpn_conv3x3_P7_CA1"
  top: "fpn_conv3x3_P7_CA1"
  scale_param {
    bias_term: true
    filler { type: "constant" value: 1 }
    bias_filler { type: "constant" value: 0 }
  }
  param { name: "fpn_conv3x3_cs1" lr_mult: 1.0 decay_mult: 0.0 }
  param { name: "fpn_conv3x3_cb1" lr_mult: 2.0 decay_mult: 0 }
}
layer {
  name: "fpn_relu3x3_P7_CA1"
  type: "ReLU"
  bottom: "fpn_conv3x3_P7_CA1"
  top: "fpn_conv3x3_P7_CA1"
}
layer {
  name: "fpn_conv3x3_P7_CA2"
  type: "Convolution"
  bottom: "fpn_conv3x3_P7_CA1"
  top: "fpn_conv3x3_P7_CA2"
  param { name: "fpn_conv3x3_cw2" lr_mult: 1.0 decay_mult: 1.0 }
  convolution_param {
    bias_term: false
    num_output: 256
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
  }
}
layer {
  name: "fpn_conv3x3_P7_CA2/gn"
  type: "GroupNorm"
  bottom: "fpn_conv3x3_P7_CA2"
  top: "fpn_conv3x3_P7_CA2"
}
layer {
  name: "fpn_conv3x3_P7_CA2/gn/scale"
  type: "Scale"
  bottom: "fpn_conv3x3_P7_CA2"
  top: "fpn_conv3x3_P7_CA2"
  scale_param {
    bias_term: true
    filler { type: "constant" value: 1 }
    bias_filler { type: "constant" value: 0 }
  }
  param { name: "fpn_conv3x3_cs2" lr_mult: 1.0 decay_mult: 0.0 }
  param { name: "fpn_conv3x3_cb2" lr_mult: 2.0 decay_mult: 0 }
}
layer {
  name: "fpn_relu3x3_P7_CA2"
  type: "ReLU"
  bottom: "fpn_conv3x3_P7_CA2"
  top: "fpn_conv3x3_P7_CA2"
}
layer {
  name: "fpn_conv3x3_P7_BA1"
  type: "Convolution"
  bottom: "fpn_pool7"
  top: "fpn_conv3x3_P7_BA1"
  param { name: "fpn_conv3x3_bw1" lr_mult: 1.0 decay_mult: 1.0 }
  convolution_param {
    bias_term: false
    num_output: 256
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
  }
}
layer {
  name: "fpn_conv3x3_P7_BA1/gn"
  type: "GroupNorm"
  bottom: "fpn_conv3x3_P7_BA1"
  top: "fpn_conv3x3_P7_BA1"
}
layer {
  name: "fpn_conv3x3_P7_BA1/gn/scale"
  type: "Scale"
  bottom: "fpn_conv3x3_P7_BA1"
  top: "fpn_conv3x3_P7_BA1"
  scale_param {
    bias_term: true
    filler { type: "constant" value: 1 }
    bias_filler { type: "constant" value: 0 }
  }
  param { name: "fpn_conv3x3_bs1" lr_mult: 1.0 decay_mult: 0.0 }
  param { name: "fpn_conv3x3_bb1" lr_mult: 2.0 decay_mult: 0 }
}
layer {
  name: "fpn_relu3x3_P7_BA1"
  type: "ReLU"
  bottom: "fpn_conv3x3_P7_BA1"
  top: "fpn_conv3x3_P7_BA1"
}
layer {
  name: "fpn_conv3x3_P7_BA2"
  type: "Convolution"
  bottom: "fpn_conv3x3_P7_BA1"
  top: "fpn_conv3x3_P7_BA2"
  param { name: "fpn_conv3x3_bw2" lr_mult: 1.0 decay_mult: 1.0 }
  convolution_param {
    bias_term: false
    num_output: 256
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
  }
}
layer {
  name: "fpn_conv3x3_P7_BA2/gn"
  type: "GroupNorm"
  bottom: "fpn_conv3x3_P7_BA2"
  top: "fpn_conv3x3_P7_BA2"
}
layer {
  name: "fpn_conv3x3_P7_BA2/gn/scale"
  type: "Scale"
  bottom: "fpn_conv3x3_P7_BA2"
  top: "fpn_conv3x3_P7_BA2"
  scale_param {
    bias_term: true
    filler { type: "constant" value: 1 }
    bias_filler { type: "constant" value: 0 }
  }
  param { name: "fpn_conv3x3_bs2" lr_mult: 1.0 decay_mult: 0.0 }
  param { name: "fpn_conv3x3_bb2" lr_mult: 2.0 decay_mult: 0 }
}
layer {
  name: "fpn_relu3x3_P7_BA2"
  type: "ReLU"
  bottom: "fpn_conv3x3_P7_BA2"
  top: "fpn_conv3x3_P7_BA2"
}
layer {
  name: "cls_score_P7"
  type: "Convolution"
  bottom: "fpn_conv3x3_P7_CA2"
  top: "cls_score_P7"
  param { name: "cls_score_w" lr_mult: 1.0 decay_mult: 1.0 }
  param { name: "cls_score_b" lr_mult: 2.0 decay_mult: 0.0 }
  convolution_param {
    num_output: 480   # 80 (classes) * 9(anchors)
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" value: -4.595 }
  }
}
layer {
  name: "bbox_pred_P7"
  type: "Convolution"
  bottom: "fpn_conv3x3_P7_BA2"
  top: "bbox_pred_P7"
  param { name: "bbox_pred_w" lr_mult: 1.0 decay_mult: 1.0 }
  param { name: "bbox_pred_b" lr_mult: 2.0 decay_mult: 0 }
  convolution_param {
    num_output: 24   # 4 * 9(anchors)
    kernel_size: 3 pad: 1 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" value: 0 }
  }
}

#================== output ==========================
layer {
  name: 'fpn_data_P3'
  type: 'AnchorTarget'
  bottom: 'cls_score_P3'
  bottom: 'gt_boxes'
  bottom: 'im_info'
  top: 'labels_P3'
  top: 'bbox_targets_P3'
  top: 'bbox_inside_weights_P3'
  top: 'bbox_outside_weights_P3'
  propagate_down: 0
  propagate_down: 0
  propagate_down: 0
  rpn_anchor_target_param {
    fg_thresh: 0.5 bg_thresh: 0.4 feat_stride: 8
  }
}
layer {
  name: "loss_cls_P3"
  type: "FocalLoss"
  bottom: "cls_score_P3"
  bottom: "labels_P3"
  propagate_down: 1
  propagate_down: 0
  top: "loss_cls_P3"
  loss_weight: 1
  focal_loss_param { mode: FULL gamma: 2.0 alpha: 0.25 }
  # focal_loss_param { mode: REDUCTION gamma: 2.0 beta: 1.0 }
  loss_param { ignore_label: -1 normalize: true }
}
layer {
  name: "loss_bbox_P3"
  type: "SmoothL1Loss"
  bottom: "bbox_pred_P3"
  bottom: "bbox_targets_P3"
  bottom: 'bbox_inside_weights_P3'
  bottom: 'bbox_outside_weights_P3'
  propagate_down: 1
  propagate_down: 0
  propagate_down: 0
  propagate_down: 0
  top: "loss_bbox_P3"
  smooth_l1_loss_param { sigma: 10.0 }
  loss_weight: 1
}
layer {
  name: 'fpn_data_P4'
  type: 'AnchorTarget'
  bottom: 'cls_score_P4'
  bottom: 'gt_boxes'
  bottom: 'im_info'
  top: 'labels_P4'
  top: 'bbox_targets_P4'
  top: 'bbox_inside_weights_P4'
  top: 'bbox_outside_weights_P4'
  propagate_down: 0
  propagate_down: 0
  propagate_down: 0
  rpn_anchor_target_param {
    fg_thresh: 0.5 bg_thresh: 0.4 feat_stride:  16
  }
}

layer {
  name: "loss_cls_P4"
  type: "FocalLoss"
  bottom: "cls_score_P4"
  bottom: "labels_P4"
  propagate_down: 1
  propagate_down: 0
  top: "loss_cls_P4"
  loss_weight: 1
  focal_loss_param { mode: FULL gamma: 2.0 alpha: 0.25 }
  loss_param { ignore_label: -1 normalize: true }
}
layer {
  name: "loss_bbox_P4"
  type: "SmoothL1Loss"
  bottom: "bbox_pred_P4"
  bottom: "bbox_targets_P4"
  bottom: 'bbox_inside_weights_P4'
  bottom: 'bbox_outside_weights_P4'
  propagate_down: 1
  propagate_down: 0
  propagate_down: 0
  propagate_down: 0
  top: "loss_bbox_P4"
  smooth_l1_loss_param { sigma: 10.0 }
  loss_weight: 1
}
layer {
  name: 'fpn_data_P5'
  type: 'AnchorTarget'
  bottom: 'cls_score_P5'
  bottom: 'gt_boxes'
  bottom: 'im_info'
  top: 'labels_P5'
  top: 'bbox_targets_P5'
  top: 'bbox_inside_weights_P5'
  top: 'bbox_outside_weights_P5'
  propagate_down: 0
  propagate_down: 0
  propagate_down: 0
  rpn_anchor_target_param {
    fg_thresh: 0.5 bg_thresh: 0.4 feat_stride:  32
  }
}
layer {
  name: "loss_cls_P5"
  type: "FocalLoss"
  bottom: "cls_score_P5"
  bottom: "labels_P5"
  propagate_down: 1
  propagate_down: 0
  top: "loss_cls_P5"
  loss_weight: 1
  focal_loss_param { mode: FULL gamma: 2.0 alpha: 0.25 }
  loss_param { ignore_label: -1 normalize: true }
}
layer {
  name: "loss_bbox_P5"
  type: "SmoothL1Loss"
  bottom: "bbox_pred_P5"
  bottom: "bbox_targets_P5"
  bottom: 'bbox_inside_weights_P5'
  bottom: 'bbox_outside_weights_P5'
  propagate_down: 1
  propagate_down: 0
  propagate_down: 0
  propagate_down: 0
  top: "loss_bbox_P5"
  smooth_l1_loss_param { sigma: 10.0 }
  loss_weight: 1
}
layer {
  name: 'fpn_data_P6'
  type: 'AnchorTarget'
  bottom: 'cls_score_P6'
  bottom: 'gt_boxes'
  bottom: 'im_info'
  top: 'labels_P6'
  top: 'bbox_targets_P6'
  top: 'bbox_inside_weights_P6'
  top: 'bbox_outside_weights_P6'
  propagate_down: 0
  propagate_down: 0
  propagate_down: 0
  rpn_anchor_target_param {
    fg_thresh: 0.5 bg_thresh: 0.4 feat_stride:  64
  }
}
layer {
  name: "loss_cls_P6"
  type: "FocalLoss"
  bottom: "cls_score_P6"
  bottom: "labels_P6"
  propagate_down: 1
  propagate_down: 0
  top: "loss_cls_P6"
  loss_weight: 1
  focal_loss_param { mode: FULL gamma: 2.0 alpha: 0.25 }
  loss_param { ignore_label: -1 normalize: true }
}
layer {
  name: "loss_bbox_P6"
  type: "SmoothL1Loss"
  bottom: "bbox_pred_P6"
  bottom: "bbox_targets_P6"
  bottom: 'bbox_inside_weights_P6'
  bottom: 'bbox_outside_weights_P6'
  propagate_down: 1
  propagate_down: 0
  propagate_down: 0
  propagate_down: 0
  top: "loss_bbox_P6"
  smooth_l1_loss_param { sigma: 10.0 }
  loss_weight: 1
}
layer {
  name: 'fpn_data_P7'
  type: 'AnchorTarget'
  bottom: 'cls_score_P7'
  bottom: 'gt_boxes'
  bottom: 'im_info'
  bottom: "data"
  top: 'labels_P7'
  top: 'bbox_targets_P7'
  top: 'bbox_inside_weights_P7'
  top: 'bbox_outside_weights_P7'
  propagate_down: 0
  propagate_down: 0
  propagate_down: 0
  propagate_down: 0
  rpn_anchor_target_param {
    fg_thresh: 0.5 bg_thresh: 0.4 feat_stride: 128
  }
}
layer {
  name: "loss_cls_P7"
  type: "FocalLoss"
  bottom: "cls_score_P7"
  bottom: "labels_P7"
  propagate_down: 1
  propagate_down: 0
  top: "loss_cls_P7"
  loss_weight: 1
  focal_loss_param { mode: FULL gamma: 2.0 alpha: 0.25 }
  loss_param { ignore_label: -1 normalize: true }
}
layer {
  name: "loss_bbox_P7"
  type: "SmoothL1Loss"
  bottom: "bbox_pred_P7"
  bottom: "bbox_targets_P7"
  bottom: 'bbox_inside_weights_P7'
  bottom: 'bbox_outside_weights_P7'
  propagate_down: 1
  propagate_down: 0
  propagate_down: 0
  propagate_down: 0
  top: "loss_bbox_P7"
  smooth_l1_loss_param { sigma: 10.0 }
  loss_weight: 1
}
layer {
  name: 'cls_score_P3_reshape'
  type: 'Reshape'
  bottom: 'cls_score_P3'
  top: 'cls_score_P3_reshape'
  reshape_param { shape {dim: 0 dim: 0 dim: -1 dim: 1} }
}
layer {
  name: 'cls_score_P4_reshape'
  type: 'Reshape'
  bottom: 'cls_score_P4'
  top: 'cls_score_P4_reshape'
  reshape_param { shape {dim: 0 dim: 0 dim: -1 dim: 1} }
}
layer {
  name: 'cls_score_P5_reshape'
  type: 'Reshape'
  bottom: 'cls_score_P5'
  top: 'cls_score_P5_reshape'
  reshape_param { shape {dim: 0 dim: 0 dim: -1 dim: 1} }
}
layer {
  name: 'cls_score_P6_reshape'
  type: 'Reshape'
  bottom: 'cls_score_P6'
  top: 'cls_score_P6_reshape'
  reshape_param { shape {dim: 0 dim: 0 dim: -1 dim: 1} }
}
layer {
  name: 'cls_score_P7_reshape'
  type: 'Reshape'
  bottom: 'cls_score_P7'
  top: 'cls_score_P7_reshape'
  reshape_param { shape {dim: 0 dim: 0 dim: -1 dim: 1} }
}
layer {
  name: 'labels_P3_reshape'
  type: 'Reshape'
  bottom: 'labels_P3'
  top: 'labels_P3_reshape'
  reshape_param { shape {dim: 0 dim: 0 dim: -1 dim: 1} }
}
layer {
  name: 'labels_P4_reshape'
  type: 'Reshape'
  bottom: 'labels_P4'
  top: 'labels_P4_reshape'
  reshape_param { shape {dim: 0 dim: 0 dim: -1 dim: 1} }
}
layer {
  name: 'labels_P5_reshape'
  type: 'Reshape'
  bottom: 'labels_P5'
  top: 'labels_P5_reshape'
  reshape_param { shape {dim: 0 dim: 0 dim: -1 dim: 1} }
}
layer {
  name: 'labels_P6_reshape'
  type: 'Reshape'
  bottom: 'labels_P6'
  top: 'labels_P6_reshape'
  reshape_param { shape {dim: 0 dim: 0 dim: -1 dim: 1} }
}
layer {
  name: 'labels_P7_reshape'
  type: 'Reshape'
  bottom: 'labels_P7'
  top: 'labels_P7_reshape'
  reshape_param { shape {dim: 0 dim: 0 dim: -1 dim: 1} }
}
layer {
  name: 'cls_score'
  type: 'Concat'
  bottom: 'cls_score_P3_reshape'
  bottom: 'cls_score_P4_reshape'
  bottom: 'cls_score_P5_reshape'
  bottom: 'cls_score_P6_reshape'
  bottom: 'cls_score_P7_reshape'
  top: 'cls_score'
  concat_param { axis: 2 }
}
layer {
  name: 'labels'
  type: 'Concat'
  bottom: 'labels_P3_reshape'
  bottom: 'labels_P4_reshape'
  bottom: 'labels_P5_reshape'
  bottom: 'labels_P6_reshape'
  bottom: 'labels_P7_reshape'
  top: 'labels'
  concat_param { axis: 2 }
}
layer {
  name: "cls_accuracy"
  type: "BalancedAccuracy"
  bottom: "cls_score"
  bottom: "labels"
  top: "cls_accuracy"
}

#============= refinement ==================
layer {
  name: "cls_score_P3_perm"
  type: "Permute"
  bottom: "cls_score_P3"
  top: "cls_score_P3_perm"
  permute_param { order: 0 order: 2 order: 3 order: 1 }
}
layer {
  name: "bbox_pred_P3_perm"
  type: "Permute"
  bottom: "bbox_pred_P3"
  top: "bbox_pred_P3_perm"
  permute_param { order: 0 order: 2 order: 3 order: 1 }
}
layer {
  name: 'proposal_P3'
  type: 'Proposal'
  bottom: 'cls_score_P3_perm'
  bottom: 'bbox_pred_P3_perm'
  bottom: 'im_info'
  top: 'dets_P3'
  top: 'det_scores_P3'
  propagate_down: false
  propagate_down: false
  propagate_down: false
  rpn_proposal_param {
    feat_stride: 8 
    pre_nms_top_k: 1000 
    thresh: -4.0 
    min_size: 4 
    keep_cls_info: false
    nms_thresh: 0.7
  }
}
layer {
  name: "cls_score_P4_perm"
  type: "Permute"
  bottom: "cls_score_P4"
  top: "cls_score_P4_perm"
  permute_param { order: 0 order: 2 order: 3 order: 1 }
}
layer {
  name: "bbox_pred_P4_perm"
  type: "Permute"
  bottom: "bbox_pred_P4"
  top: "bbox_pred_P4_perm"
  permute_param { order: 0 order: 2 order: 3 order: 1 }
}

layer {
  name: 'proposal_P4'
  type: 'Proposal'
  bottom: 'cls_score_P4_perm'
  bottom: 'bbox_pred_P4_perm'
  bottom: 'im_info'
  top: 'dets_P4'
  top: 'det_scores_P4'
  propagate_down: false
  propagate_down: false
  propagate_down: false
  rpn_proposal_param {
    feat_stride: 16 pre_nms_top_k: 1000 
    thresh: -4.0 min_size: 4
    keep_cls_info: false
    nms_thresh: 0.7
  }
}
layer {
  name: "cls_score_P5_perm"
  type: "Permute"
  bottom: "cls_score_P5"
  top: "cls_score_P5_perm"
  permute_param { order: 0 order: 2 order: 3 order: 1 }
}
layer {
  name: "bbox_pred_P5_perm"
  type: "Permute"
  bottom: "bbox_pred_P5"
  top: "bbox_pred_P5_perm"
  permute_param { order: 0 order: 2 order: 3 order: 1 }
}
layer {
  name: 'proposal_P5'
  type: 'Proposal'
  bottom: 'cls_score_P5_perm'
  bottom: 'bbox_pred_P5_perm'
  bottom: 'im_info'
  top: 'dets_P5'
  top: 'det_scores_P5'
  propagate_down: false
  propagate_down: false
  propagate_down: false
  rpn_proposal_param {
    feat_stride: 32 pre_nms_top_k: 1000 
    thresh: -4.0 min_size: 4
    keep_cls_info: false
    nms_thresh: 0.7
  }
}
layer {
  name: "cls_score_P6_perm"
  type: "Permute"
  bottom: "cls_score_P6"
  top: "cls_score_P6_perm"
  permute_param { order: 0 order: 2 order: 3 order: 1 }
}
layer {
  name: "bbox_pred_P6_perm"
  type: "Permute"
  bottom: "bbox_pred_P6"
  top: "bbox_pred_P6_perm"
  permute_param { order: 0 order: 2 order: 3 order: 1 }
}
layer {
  name: 'proposal_P6'
  type: 'Proposal'
  bottom: 'cls_score_P6_perm'
  bottom: 'bbox_pred_P6_perm'
  bottom: 'im_info'
  top: 'dets_P6'
  top: 'det_scores_P6'
  propagate_down: false
  propagate_down: false
  propagate_down: false
  rpn_proposal_param {
    feat_stride: 64 pre_nms_top_k: 1000 
    thresh: -4.0 min_size: 4
    keep_cls_info: false
    nms_thresh: 0.7
  }
}
layer {
  name: "cls_score_P7_perm"
  type: "Permute"
  bottom: "cls_score_P7"
  top: "cls_score_P7_perm"
  permute_param { order: 0 order: 2 order: 3 order: 1 }
}
layer {
  name: "bbox_pred_P7_perm"
  type: "Permute"
  bottom: "bbox_pred_P7"
  top: "bbox_pred_P7_perm"
  permute_param { order: 0 order: 2 order: 3 order: 1 }
}
layer {
  name: 'proposal_P7'
  type: 'Proposal'
  bottom: 'cls_score_P7_perm'
  bottom: 'bbox_pred_P7_perm'
  bottom: 'im_info'
  top: 'dets_P7'
  top: 'det_scores_P7'
  propagate_down: false
  propagate_down: false
  propagate_down: false
  rpn_proposal_param {
    feat_stride: 128 pre_nms_top_k: 1000 
    thresh: -4.0 min_size: 4
    keep_cls_info: false
    nms_thresh: 0.7
  }
}
layer {
   name: "det_rois_all"
   type: "Concat"
   bottom: "dets_P3"
   bottom: "dets_P4"
   bottom: "dets_P5"
   bottom: "dets_P6"
   bottom: "dets_P7"
   top: "det_rois_all"
   concat_param { axis: 0 }
}
layer {
   name: "det_scores_all"
   type: "Concat"
   bottom: "det_scores_P3"
   bottom: "det_scores_P4"
   bottom: "det_scores_P5"
   bottom: "det_scores_P6"
   bottom: "det_scores_P7"
   top: "det_scores_all"
   concat_param { axis: 0 }
}
layer { 
   name: "det_rois_slice"
   type: "Slice"
   bottom: "det_rois_all"
   top: "det_rois"
   top: "det_cls_scores"
   slice_param { axis: 1 slice_point: 5 }
}

layer {
  name: 'boxes_gt'
  type: 'RPNSliceAnno'
  bottom: 'im_info'
  bottom: 'gt_boxes'
  top: 'boxes_gt'
}


#============= data prepare for frcnn ===================
layer {
  bottom: "det_rois"
  bottom: "boxes_gt"
  top: "rois"
  top: "proposal_labels"
  top: "proposal_targets"
  top: "box_inside_weights"
  top: "box_outside_weights"
  top: "match_gt_boxes"
  name: "proposal_info"
  type: "ProposalTarget"
  include {
    phase: TRAIN
  }
  proposal_target_param {
    cls_num: 81
    batch_size: 256
    fg_fraction: 0.25
    num_img_per_batch: 1
    fg_thr: 0.5
    bg_thr_hg: 0.5
    bg_thr_lw: 0.0
    img_width: 600
    img_height: 600
  }
  bbox_reg_param {
    cls_aware: false
    bbox_mean: 0 bbox_mean: 0 bbox_mean: 0 bbox_mean: 0
    bbox_std: 0.1 bbox_std: 0.1 bbox_std: 0.2 bbox_std: 0.2
  }
  propagate_down: 0
  propagate_down: 0
}


#================== CASCADE 1 =====================
layer {
  name: "cas_roi_grid_P3S1"
  type: "ROIAlign"
  bottom: "fpn_pool3"
  bottom: "rois"
  top: "cas_roi_grid_P3S1"
  roi_pooling_param {
    pooled_w: 7
    pooled_h: 7
    spatial_scale: 0.125 # 1/8
  }
  propagate_down: 1
  propagate_down: 0
}
layer {
  name: "cas_roi_grid_P4S1"
  type: "ROIAlign"
  bottom: "fpn_pool4"
  bottom: "rois"
  top: "cas_roi_grid_P4S1"
  roi_pooling_param {
    pooled_w: 7
    pooled_h: 7
    spatial_scale: 0.0625 # 1/16
  }
  propagate_down: 1
  propagate_down: 0
}
layer {
  name: "cas_roi_grid_P5S1"
  type: "ROIAlign"
  bottom: "fpn_conv5"
  bottom: "rois"
  top: "cas_roi_grid_P5S1"
  roi_pooling_param {
    pooled_w: 7
    pooled_h: 7
    spatial_scale: 0.0625 # 1/16
  }
  propagate_down: 1
  propagate_down: 0
}
layer {
  bottom: "cas_roi_grid_P3S1"
  bottom: "cas_roi_grid_P4S1"
  bottom: "cas_roi_grid_P5S1"
  top: "cas_roi_grid_S1"
  name: "cas_roi_grid_S1"
  type: "Eltwise"
}
layer {
  name: "cas_conv1_3x3_S1"
  type: "Convolution"
  bottom: "cas_roi_grid_S1"
  top: "cas_conv1_3x3_S1"
  param { name: "cas_conv1_s1_w" lr_mult: 1.0 decay_mult: 1.0 }
  param { name: "cas_conv1_s1_b" lr_mult: 2.0 decay_mult: 0 }
  convolution_param {
    num_output: 1024
    kernel_size: 8 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" value: 0 }
  }
}
layer {
  name: "cas_conv1_3x3_S1/relu"
  type: "ReLU"
  bottom: "cas_conv1_3x3_S1"
  top: "cas_conv1_3x3_S1"
}
layer {
  name: "cas_conv2_3x3_S1"
  type: "Convolution"
  bottom: "cas_conv1_3x3_S1"
  top: "cas_conv2_3x3_S1"
  param { name: "cas_conv2_s1_w" lr_mult: 1.0 decay_mult: 1.0 }
  param { name: "cas_conv2_s1_b" lr_mult: 2.0 decay_mult: 0 }
  convolution_param {
    num_output: 1024
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" value: 0 }
  }
}
layer {
  name: "cas_conv2_3x3_S1/relu"
  type: "ReLU"
  bottom: "cas_conv2_3x3_S1"
  top: "cas_conv2_3x3_S1"
}
layer {
  name: "cas_conv3_3x3_S1"
  type: "Convolution"
  bottom: "cas_conv2_3x3_S1"
  top: "cas_conv3_3x3_S1"
  param { name: "cas_conv3_s1_w" lr_mult: 1.0 decay_mult: 1.0 }
  param { name: "cas_conv3_s1_b" lr_mult: 2.0 decay_mult: 0 }
  convolution_param {
    num_output: 512
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" value: 0 }
  }
}
layer {
  name: "cas_conv3_3x3_S1/relu"
  type: "ReLU"
  bottom: "cas_conv3_3x3_S1"
  top: "cas_conv3_3x3_S1"
}
layer {
  name: "cls_pred_1st_g1"
  type: "Convolution"
  bottom: "cas_conv2_3x3_S1"
  top: "cls_pred_1st_g1"
  param { name: "cls_pred_1st_w1" lr_mult: 1.0 }
  param { name: "cls_pred_1st_b1" lr_mult: 2.0 }
  convolution_param {
    num_output: 80
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: -1.0 }
  }
}
layer {
  name: "bbox_pred_1st_g1"
  type: "Convolution"
  bottom: "cas_conv2_3x3_S1"
  top: "bbox_pred_1st_g1"
  param { name: "bbox_pred_1st_w1" lr_mult: 1.0 }
  param { name: "bbox_pred_1st_b1" lr_mult: 2.0 }
  convolution_param {
    num_output: 8
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: 0.0 }
  }
}
layer {
  name: "cls_pred_1st_g2"
  type: "Convolution"
  bottom: "cas_conv2_3x3_S1"
  top: "cls_pred_1st_g2"
  param { name: "cls_pred_1st_w2" lr_mult: 1.0 }
  param { name: "cls_pred_1st_b2" lr_mult: 2.0 }
  convolution_param {
    num_output: 80
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: -1.0 }
  }
}
layer {
  name: "bbox_pred_1st_g2"
  type: "Convolution"
  bottom: "cas_conv2_3x3_S1"
  top: "bbox_pred_1st_g2"
  param { name: "bbox_pred_1st_w2" lr_mult: 1.0 }
  param { name: "bbox_pred_1st_b2" lr_mult: 2.0 }
  convolution_param {
    num_output: 8
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: 0.0 }
  }
}
layer {
  name: "cls_pred_1st_g3"
  type: "Convolution"
  bottom: "cas_conv2_3x3_S1"
  top: "cls_pred_1st_g3"
  param { name: "cls_pred_1st_w3" lr_mult: 1 }
  param { name: "cls_pred_1st_b3" lr_mult: 2 }
  convolution_param {
    num_output: 80
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: -1.0 }
  }
}
layer {
  name: "bbox_pred_1st_g3"
  type: "Convolution"
  bottom: "cas_conv2_3x3_S1"
  top: "bbox_pred_1st_g3"
  param { name: "bbox_pred_1st_w3" lr_mult: 1 }
  param { name: "bbox_pred_1st_b3" lr_mult: 2 }
  convolution_param {
    num_output: 8
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: 0.0 }
  }
}
layer {
  name: "cls_pred_1st_g4"
  type: "Convolution"
  bottom: "cas_conv3_3x3_S1"
  top: "cls_pred_1st_g4"
  param { name: "cls_pred_1st_w4" lr_mult: 1 }
  param { name: "cls_pred_1st_b4" lr_mult: 2 }
  convolution_param {
    num_output: 80
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: -1.0 }
  }
}
layer {
  name: "bbox_pred_1st_g4"
  type: "Convolution"
  bottom: "cas_conv3_3x3_S1"
  top: "bbox_pred_1st_g4"
  param { name: "bbox_pred_1st_w4" lr_mult: 1 }
  param { name: "bbox_pred_1st_b4" lr_mult: 1 }
  convolution_param {
    num_output: 8
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: 0.0 }
  }
}
layer {
  name: "loss_cls_1st_p1"
  bottom: "cls_pred_1st_g1"
  bottom: "proposal_labels"
  top: "loss_cls_1st_p1"
  type: "FocalLoss"
  loss_weight: 1
  propagate_down: 1
  propagate_down: 0
  focal_loss_param { mode: REDUCTION gamma: 2.0 beta: 1.0 }
  loss_param { ignore_label: -1 normalize: true normalization: BATCH_SIZE }
}
layer {
  name: "proposal_labels_r2"
  type: "AdditiveFocal"
  bottom: "cls_pred_1st_g1"
  bottom: "proposal_labels"
  top: "proposal_labels_r2"
  top: "proposal_weights_r2"
  focal_loss_param { mode: REDUCTION gamma: 2.0 beta: 1.0 }
}
layer {
  name: "loss_cls_1st_p2"
  bottom: "cls_pred_1st_g2"
  bottom: "proposal_labels_r2"
  bottom: "proposal_weights_r2"
  top: "loss_cls_1st_p2"
  type: "WeightL2Loss"
  loss_weight: 1
  propagate_down: 1
  propagate_down: 0
  propagate_down: 0
  loss_param { ignore_label: -1 normalize: true normalization: VALID }
}
layer {
  name: "cls_pred_1st_s2"
  bottom: "cls_pred_1st_g1"
  bottom: "cls_pred_1st_g2"
  top: "cls_pred_1st_s2"
  type: "Eltwise"
}
layer {
  name: "proposal_labels_r3"
  type: "AdditiveFocal"
  bottom: "cls_pred_1st_s2"
  bottom: "proposal_labels"
  top: "proposal_labels_r3"
  top: "proposal_weights_r3"
  focal_loss_param { mode: REDUCTION gamma: 2.0 beta: 1.0 }
}
layer {
  name: "loss_cls_1st_p3"
  bottom: "cls_pred_1st_g3"
  bottom: "proposal_labels_r3"
  bottom: "proposal_weights_r3"
  top: "loss_cls_1st_p3"
  type: "WeightL2Loss"
  loss_weight: 1
  propagate_down: 1
  propagate_down: 0
  propagate_down: 0
  loss_param { ignore_label: -1 normalize: true normalization: VALID }
}
layer {
  name: "cls_pred_1st_s3"
  bottom: "cls_pred_1st_s2"
  bottom: "cls_pred_1st_g3"
  top: "cls_pred_1st_s3"
  type: "Eltwise" 
} 
layer {
  name: "proposal_labels_r4"
  type: "AdditiveFocal"
  bottom: "cls_pred_1st_s3"
  bottom: "proposal_labels"
  top: "proposal_labels_r4"
  top: "proposal_weights_r4"
  focal_loss_param { mode: REDUCTION gamma: 2.0 beta: 1.0 }
}
layer {
  name: "loss_cls_1st_p4"
  bottom: "cls_pred_1st_g4"
  bottom: "proposal_labels_r4"
  bottom: "proposal_weights_r4"
  top: "loss_cls_1st_p4"
  type: "WeightL2Loss"
  loss_weight: 1
  propagate_down: 1
  propagate_down: 0
  propagate_down: 0
  loss_param { ignore_label: -1 normalize: true normalization: VALID }
}
layer {
  name: "cls_pred_1st"
  bottom: "cls_pred_1st_s3"
  bottom: "cls_pred_1st_g4"
  top: "cls_pred_1st"
  type: "Eltwise"
}
layer {
  name: "cls_accuracy_1st"
  type: "BalancedAccuracy"
  bottom: "cls_pred_1st"
  bottom: "proposal_labels"
  top: "cls_accuracy_1st"
}
layer {
  name: "loss_bbox_1st_p1"
  type: "SmoothL1Loss"
  bottom: "bbox_pred_1st_g1"
  bottom: "proposal_targets"
  bottom: "box_inside_weights"
  bottom: "box_outside_weights"
  top: "loss_bbox_1st_p1"
  loss_weight: 1
  propagate_down: 1
  propagate_down: 0
  propagate_down: 0
  propagate_down: 0
}
layer {
  name: "proposal_targets_r2"
  type: "AdditiveSmoothL1"
  bottom: "bbox_pred_1st_g1"
  bottom: "proposal_targets"
  top: "proposal_targets_r2"
}
layer {
  name: "loss_bbox_1st_p2"
  type: "SmoothL1Loss"
  bottom: "bbox_pred_1st_g2"
  bottom: "proposal_targets_r2"
  bottom: "box_inside_weights"
  bottom: "box_outside_weights"
  top: "loss_bbox_1st_p2"
  loss_weight: 1
  propagate_down: 1
  propagate_down: 0
  propagate_down: 0
  propagate_down: 0
}
layer {
  name: "bbox_pred_1st_s2"
  bottom: "bbox_pred_1st_g1"
  bottom: "bbox_pred_1st_g2"
  top: "bbox_pred_1st_s2"
  type: "Eltwise"
}
layer {
  name: "proposal_targets_r3"
  type: "AdditiveSmoothL1"
  bottom: "bbox_pred_1st_s2"
  bottom: "proposal_targets"
  top: "proposal_targets_r3"
}
layer {
  name: "loss_bbox_1st_p3"
  type: "SmoothL1Loss"
  bottom: "bbox_pred_1st_g3"
  bottom: "proposal_targets_r3"
  bottom: "box_inside_weights"
  bottom: "box_outside_weights"
  top: "loss_bbox_1st_p3"
  loss_weight: 1
  propagate_down: 1
  propagate_down: 0
  propagate_down: 0
  propagate_down: 0
}
layer {
  name: "bbox_pred_1st_s3"
  bottom: "bbox_pred_1st_g3"
  bottom: "bbox_pred_1st_s2"
  top: "bbox_pred_1st_s3"
  type: "Eltwise"
}
layer {
  name: "proposal_targets_r4"
  type: "AdditiveSmoothL1"
  bottom: "bbox_pred_1st_s3"
  bottom: "proposal_targets"
  top: "proposal_targets_r4"
}
layer {
  name: "loss_bbox_1st_p4"
  type: "SmoothL1Loss"
  bottom: "bbox_pred_1st_g4"
  bottom: "proposal_targets_r4"
  bottom: "box_inside_weights"
  bottom: "box_outside_weights"
  top: "loss_bbox_1st_p4"
  loss_weight: 1
  propagate_down: 1
  propagate_down: 0
  propagate_down: 0
  propagate_down: 0
}
layer {
  name: "bbox_pred_1st"
  bottom: "bbox_pred_1st_s3"
  bottom: "bbox_pred_1st_g4"
  top: "bbox_pred_1st"
  type: "Eltwise"
}
layer {
  name: "bbox_iou"
  type: "BboxAccuracy"
  bottom: "bbox_pred_1st"
  bottom: "rois"
  bottom: "match_gt_boxes"
  top: "bbox_iou"
  top: "bbox_iou_pre"
  bbox_reg_param {
    cls_aware: false
    bbox_mean: 0 bbox_mean: 0 bbox_mean: 0 bbox_mean: 0
    bbox_std: 0.1 bbox_std: 0.1 bbox_std: 0.2 bbox_std: 0.2
  }
}

#================== CASCADE 2 =====================
layer {
  name: "proposals_2nd"
  type: "DecodeBBox"
  bottom: "bbox_pred_1st"
  bottom: "rois"
  bottom: "match_gt_boxes"
  top: "proposals_2nd"
  bbox_reg_param {
    bbox_mean: 0 bbox_mean: 0 bbox_mean: 0 bbox_mean: 0
    bbox_std: 0.1 bbox_std: 0.1 bbox_std: 0.2 bbox_std: 0.2
  }
  propagate_down: 0
  propagate_down: 0
  propagate_down: 0
}

layer {
  bottom: "proposals_2nd"
  bottom: "boxes_gt"
  top: "rois_2nd"
  top: "proposal_labels_2nd"
  top: "proposal_targets_2nd"
  top: "box_inside_weights_2nd"
  top: "box_outside_weights_2nd"
  top: "match_gt_boxes_2nd"
  name: "proposal_info_2nd"
  type: "ProposalTarget"
  include {
    phase: TRAIN
  }
  proposal_target_param {
    cls_num: 81
    batch_size: -1
    fg_fraction: 0.25
    num_img_per_batch: 1
    fg_thr: 0.6
    bg_thr_hg: 0.6
    bg_thr_lw: 0.0
    img_width: 600
    img_height: 600
  }
  bbox_reg_param {
    cls_aware: false
    bbox_mean: 0 bbox_mean: 0 bbox_mean: 0 bbox_mean: 0
    bbox_std: 0.05 bbox_std: 0.05 bbox_std: 0.1 bbox_std: 0.1
  }
  propagate_down: 0
  propagate_down: 0
}
layer {
  name: "cas_roi_grid_P3S2"
  type: "ROIAlign"
  bottom: "fpn_pool3"
  bottom: "rois_2nd"
  top: "cas_roi_grid_P3S2"
  roi_pooling_param {
    pooled_w: 7
    pooled_h: 7
    spatial_scale: 0.125 # 1/8
  }
  propagate_down: 1
  propagate_down: 0
}
layer {
  name: "cas_roi_grid_P4S2"
  type: "ROIAlign"
  bottom: "fpn_pool4"
  bottom: "rois_2nd"
  top: "cas_roi_grid_P4S2"
  roi_pooling_param {
    pooled_w: 7
    pooled_h: 7
    spatial_scale: 0.0625 # 1/16
  }
  propagate_down: 1
  propagate_down: 0
}
layer {
  name: "cas_roi_grid_P5S2"
  type: "ROIAlign"
  bottom: "fpn_conv5"
  bottom: "rois_2nd"
  top: "cas_roi_grid_P5S2"
  roi_pooling_param {
    pooled_w: 7
    pooled_h: 7
    spatial_scale: 0.0625 # 1/16
  }
  propagate_down: 1
  propagate_down: 0
}
layer {
  bottom: "cas_roi_grid_P3S2"
  bottom: "cas_roi_grid_P4S2"
  bottom: "cas_roi_grid_P5S2"
  top: "cas_roi_grid_S2"
  name: "cas_roi_grid_S2"
  type: "Eltwise"
  # type: "Concat"
  # concat_param { axis: 1 }
}
layer {
  name: "cas_conv1_3x3_S2"
  type: "Convolution"
  bottom: "cas_roi_grid_S2"
  top: "cas_conv1_3x3_S2"
  param { name: "cas_conv1_s2_w" lr_mult: 2.0 decay_mult: 1.0 }
  param { name: "cas_conv1_s2_b" lr_mult: 4.0 decay_mult: 0 }
  convolution_param {
    num_output: 1024
    kernel_size: 8 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" value: 0 }
  }
}
layer {
  name: "cas_conv1_3x3_S2/relu"
  type: "ReLU"
  bottom: "cas_conv1_3x3_S2"
  top: "cas_conv1_3x3_S2"
}
layer {
  name: "cas_conv2_3x3_S2"
  type: "Convolution"
  bottom: "cas_conv1_3x3_S2"
  top: "cas_conv2_3x3_S2"
  param { name: "cas_conv2_s2_w" lr_mult: 2.0 decay_mult: 1.0 }
  param { name: "cas_conv2_s2_b" lr_mult: 4.0 decay_mult: 0 }
  convolution_param {
    num_output: 1024
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" value: 0 }
  }
}
layer {
  name: "cas_conv2_3x3_S2/relu"
  type: "ReLU"
  bottom: "cas_conv2_3x3_S2"
  top: "cas_conv2_3x3_S2"
}
layer {
  name: "cas_conv3_3x3_S2"
  type: "Convolution"
  bottom: "cas_conv2_3x3_S2"
  top: "cas_conv3_3x3_S2"
  param { name: "cas_conv3_s2_w" lr_mult: 2.0 decay_mult: 1.0 }
  param { name: "cas_conv3_s2_b" lr_mult: 4.0 decay_mult: 0 }
  convolution_param {
    num_output: 512
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" value: 0 }
  }
}
layer {
  name: "cas_conv3_3x3_S2/relu"
  type: "ReLU"
  bottom: "cas_conv3_3x3_S2"
  top: "cas_conv3_3x3_S2"
}
layer {
  name: "cls_pred_2nd_g1"
  type: "Convolution"
  bottom: "cas_conv2_3x3_S2"
  top: "cls_pred_2nd_g1"
  param { name: "cls_pred_2nd_w1" lr_mult: 2.0 }
  param { name: "cls_pred_2nd_b1" lr_mult: 4.0 }
  convolution_param {
    num_output: 80
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: -1.0 }
  }
}
layer {
  name: "bbox_pred_2nd_g1"
  type: "Convolution"
  bottom: "cas_conv2_3x3_S2"
  top: "bbox_pred_2nd_g1"
  param { name: "bbox_pred_2nd_w1" lr_mult: 2.0 }
  param { name: "bbox_pred_2nd_b1" lr_mult: 4.0 }
  convolution_param {
    num_output: 8
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: 0.0 }
  }
}
layer {
  name: "cls_pred_2nd_g2"
  type: "Convolution"
  bottom: "cas_conv2_3x3_S2"
  top: "cls_pred_2nd_g2"
  param { name: "cls_pred_2nd_w2" lr_mult: 2.0 }
  param { name: "cls_pred_2nd_b2" lr_mult: 4.0 }
  convolution_param {
    num_output: 80
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: -1.0 }
  }
}
layer {
  name: "bbox_pred_2nd_g2"
  type: "Convolution"
  bottom: "cas_conv2_3x3_S2"
  top: "bbox_pred_2nd_g2"
  param { name: "bbox_pred_2nd_w2" lr_mult: 2.0 }
  param { name: "bbox_pred_2nd_b2" lr_mult: 4.0 }
  convolution_param {
    num_output: 8
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: 0.0 }
  }
}
layer {
  name: "cls_pred_2nd_g3"
  type: "Convolution"
  bottom: "cas_conv2_3x3_S2"
  top: "cls_pred_2nd_g3"
  param { name: "cls_pred_2nd_w3" lr_mult: 2 }
  param { name: "cls_pred_2nd_b3" lr_mult: 4 }
  convolution_param {
    num_output: 80
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: -1.0 }
  }
}
layer {
  name: "bbox_pred_2nd_g3"
  type: "Convolution"
  bottom: "cas_conv2_3x3_S2"
  top: "bbox_pred_2nd_g3"
  param { name: "bbox_pred_2nd_w3" lr_mult: 2 }
  param { name: "bbox_pred_2nd_b3" lr_mult: 4 }
  convolution_param {
    num_output: 8
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: 0.0 }
  }
}
layer {
  name: "cls_pred_2nd_g4"
  type: "Convolution"
  bottom: "cas_conv3_3x3_S2"
  top: "cls_pred_2nd_g4"
  param { name: "cls_pred_2nd_w4" lr_mult: 2 }
  param { name: "cls_pred_2nd_b4" lr_mult: 4 }
  convolution_param {
    num_output: 80
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: -1.0 }
  }
}
layer {
  name: "bbox_pred_2nd_g4"
  type: "Convolution"
  bottom: "cas_conv3_3x3_S2"
  top: "bbox_pred_2nd_g4"
  param { name: "bbox_pred_2nd_w4" lr_mult: 2 }
  param { name: "bbox_pred_2nd_b4" lr_mult: 4 }
  convolution_param {
    num_output: 8
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: 0.0 }
  }
}
layer {
  name: "loss_cls_2nd_p1"
  bottom: "cls_pred_2nd_g1"
  bottom: "proposal_labels_2nd"
  top: "loss_cls_2nd_p1"
  # type: "SigmoidCrossEntropyLoss"
  type: "FocalLoss"
  loss_weight: 0.5
  propagate_down: 1
  propagate_down: 0
  focal_loss_param { mode: REDUCTION gamma: 2.0 beta: 1.0 }
  loss_param { ignore_label: -1 normalize: true normalization: BATCH_SIZE }
}
layer {
  name: "proposal_labels_2nd_r2"
  type: "AdditiveFocal"
  bottom: "cls_pred_2nd_g1"
  bottom: "proposal_labels_2nd"
  top: "proposal_labels_2nd_r2"
  top: "proposal_weights_2nd_r2"
  focal_loss_param { mode: REDUCTION gamma: 2.0 beta: 1.0 }
}
layer {
  name: "loss_cls_2nd_p2"
  bottom: "cls_pred_2nd_g2"
  bottom: "proposal_labels_2nd_r2"
  bottom: "proposal_weights_2nd_r2"
  top: "loss_cls_2nd_p2"
  type: "WeightL2Loss"
  loss_weight: 0.5
  propagate_down: 1
  propagate_down: 0
  propagate_down: 0
  loss_param { ignore_label: -1 normalize: true normalization: VALID }
}
layer {
  name: "cls_pred_2nd_s2"
  bottom: "cls_pred_2nd_g1"
  bottom: "cls_pred_2nd_g2"
  top: "cls_pred_2nd_s2"
  type: "Eltwise"
}
layer {
  name: "proposal_labels_2nd_r3"
  type: "AdditiveFocal"
  bottom: "cls_pred_2nd_s2"
  bottom: "proposal_labels_2nd"
  top: "proposal_labels_2nd_r3"
  top: "proposal_weights_2nd_r3"
  focal_loss_param { mode: REDUCTION gamma: 2.0 beta: 1.0 }
}
layer {
  name: "loss_cls_2nd_p3"
  bottom: "cls_pred_2nd_g3"
  bottom: "proposal_labels_2nd_r3"
  bottom: "proposal_weights_2nd_r3"
  top: "loss_cls_2nd_p3"
  type: "WeightL2Loss"
  loss_weight: 0.5
  propagate_down: 1
  propagate_down: 0
  propagate_down: 0
  loss_param { ignore_label: -1 normalize: true normalization: VALID }
}
layer {
  name: "cls_pred_2nd_s3"
  bottom: "cls_pred_2nd_s2"
  bottom: "cls_pred_2nd_g3"
  top: "cls_pred_2nd_s3"
  type: "Eltwise" 
} 
layer {
  name: "proposal_labels_2nd_r4"
  type: "AdditiveFocal"
  bottom: "cls_pred_2nd_s3"
  bottom: "proposal_labels_2nd"
  top: "proposal_labels_2nd_r4"
  top: "proposal_weights_2nd_r4"
  focal_loss_param { mode: REDUCTION gamma: 2.0 beta: 1.0 }
}
layer {
  name: "loss_cls_2nd_p4"
  bottom: "cls_pred_2nd_g4"
  bottom: "proposal_labels_2nd_r4"
  bottom: "proposal_weights_2nd_r4"
  top: "loss_cls_2nd_p4"
  type: "WeightL2Loss"
  loss_weight: 0.5
  propagate_down: 1
  propagate_down: 0
  propagate_down: 0
  loss_param { ignore_label: -1 normalize: true normalization: VALID }
}
layer {
  name: "cls_pred_2nd"
  bottom: "cls_pred_2nd_s3"
  bottom: "cls_pred_2nd_g4"
  top: "cls_pred_2nd"
  type: "Eltwise"
}
layer {
  name: "cls_accuracy_2nd"
  type: "BalancedAccuracy"
  bottom: "cls_pred_2nd"
  bottom: "proposal_labels_2nd"
  top: "cls_accuracy_2nd"
}
layer {
  name: "loss_bbox_2nd_p1"
  type: "SmoothL1Loss"
  bottom: "bbox_pred_2nd_g1"
  bottom: "proposal_targets_2nd"
  bottom: "box_inside_weights_2nd"
  bottom: "box_outside_weights_2nd"
  top: "loss_bbox_2nd_p1"
  loss_weight: 0.5
  propagate_down: 1
  propagate_down: 0
  propagate_down: 0
  propagate_down: 0
}
layer {
  name: "proposal_targets_2nd_r2"
  type: "AdditiveSmoothL1"
  bottom: "bbox_pred_2nd_g1"
  bottom: "proposal_targets_2nd"
  top: "proposal_targets_2nd_r2"
}
layer {
  name: "loss_bbox_2nd_p2"
  type: "SmoothL1Loss"
  bottom: "bbox_pred_2nd_g2"
  bottom: "proposal_targets_2nd_r2"
  bottom: "box_inside_weights_2nd"
  bottom: "box_outside_weights_2nd"
  top: "loss_bbox_2nd_p2"
  loss_weight: 0.5
  propagate_down: 1
  propagate_down: 0
  propagate_down: 0
  propagate_down: 0
}
layer {
  name: "bbox_pred_2nd_s2"
  bottom: "bbox_pred_2nd_g1"
  bottom: "bbox_pred_2nd_g2"
  top: "bbox_pred_2nd_s2"
  type: "Eltwise"
}
layer {
  name: "proposal_targets_2nd_r3"
  type: "AdditiveSmoothL1"
  bottom: "bbox_pred_2nd_s2"
  bottom: "proposal_targets_2nd"
  top: "proposal_targets_2nd_r3"
} 
layer {
  name: "loss_bbox_2nd_p3"
  type: "SmoothL1Loss"
  bottom: "bbox_pred_2nd_g3"
  bottom: "proposal_targets_2nd_r3"
  bottom: "box_inside_weights_2nd"
  bottom: "box_outside_weights_2nd"
  top: "loss_bbox_2nd_p3"
  loss_weight: 0.5
  propagate_down: 1
  propagate_down: 0
  propagate_down: 0
  propagate_down: 0
} 
layer {
  name: "bbox_pred_2nd_s3"
  bottom: "bbox_pred_2nd_s2"
  bottom: "bbox_pred_2nd_g3"
  top: "bbox_pred_2nd_s3"
  type: "Eltwise"
}
layer {
  name: "proposal_targets_2nd_r4"
  type: "AdditiveSmoothL1"
  bottom: "bbox_pred_2nd_s3"
  bottom: "proposal_targets_2nd"
  top: "proposal_targets_2nd_r4"
}
layer {
  name: "loss_bbox_2nd_p4"
  type: "SmoothL1Loss"
  bottom: "bbox_pred_2nd_g4"
  bottom: "proposal_targets_2nd_r4"
  bottom: "box_inside_weights_2nd"
  bottom: "box_outside_weights_2nd"
  top: "loss_bbox_2nd_p4"
  loss_weight: 0.5
  propagate_down: 1
  propagate_down: 0
  propagate_down: 0
  propagate_down: 0
}
layer { 
  name: "bbox_pred_2nd"
  bottom: "bbox_pred_2nd_s3"
  bottom: "bbox_pred_2nd_g4"
  top: "bbox_pred_2nd"
  type: "Eltwise" 
}
layer {
  name: "bbox_iou_2nd"
  type: "BboxAccuracy"
  bottom: "bbox_pred_2nd"
  bottom: "rois_2nd"
  bottom: "match_gt_boxes_2nd"
  top: "bbox_iou_2nd"
  top: "bbox_iou_pre_2nd"
  bbox_reg_param {
    cls_aware: false
    bbox_mean: 0 bbox_mean: 0 bbox_mean: 0 bbox_mean: 0
    bbox_std: 0.05 bbox_std: 0.05 bbox_std: 0.1 bbox_std: 0.1
  }
}

#=================== CASCADE 3 ======================
layer {
  name: "proposals_3rd"
  type: "DecodeBBox"
  bottom: "bbox_pred_2nd"
  bottom: "rois_2nd"
  bottom: "match_gt_boxes_2nd"
  top: "proposals_3rd"
  bbox_reg_param {
    bbox_mean: 0 bbox_mean: 0 bbox_mean: 0 bbox_mean: 0
    bbox_std: 0.05 bbox_std: 0.05 bbox_std: 0.1 bbox_std: 0.1
  }
  propagate_down: 0
  propagate_down: 0
  propagate_down: 0
}

layer {
  bottom: "proposals_3rd"
  bottom: "boxes_gt"
  top: "rois_3rd"
  top: "proposal_labels_3rd"
  top: "proposal_targets_3rd"
  top: "box_inside_weights_3rd"
  top: "box_outside_weights_3rd"
  top: "match_gt_boxes_3rd"
  name: "proposal_info_3rd"
  type: "ProposalTarget"
  include {
    phase: TRAIN
  }
  proposal_target_param {
    cls_num: 81
    batch_size: -1
    fg_fraction: 0.25
    num_img_per_batch: 1
    fg_thr: 0.7
    bg_thr_hg: 0.7
    bg_thr_lw: 0.0
    img_width: 600
    img_height: 600
  }
  bbox_reg_param {
    cls_aware: false
    bbox_mean: 0 bbox_mean: 0 bbox_mean: 0 bbox_mean: 0
    bbox_std: 0.033 bbox_std: 0.033 bbox_std: 0.067 bbox_std: 0.067
  }
  propagate_down: 0
  propagate_down: 0
}

layer {
  name: "cas_roi_grid_P3S3"
  type: "ROIAlign"
  bottom: "fpn_pool3"
  bottom: "rois_3rd"
  top: "cas_roi_grid_P3S3"
  roi_pooling_param {
    pooled_w: 7
    pooled_h: 7
    spatial_scale: 0.125 # 1/8
  }
  propagate_down: 1
  propagate_down: 0
}
layer {
  name: "cas_roi_grid_P4S3"
  type: "ROIAlign"
  bottom: "fpn_pool4"
  bottom: "rois_3rd"
  top: "cas_roi_grid_P4S3"
  roi_pooling_param {
    pooled_w: 7
    pooled_h: 7
    spatial_scale: 0.0625 # 1/16
  }
  propagate_down: 1
  propagate_down: 0
}
layer {
  name: "cas_roi_grid_P5S3"
  type: "ROIAlign"
  bottom: "fpn_conv5"
  bottom: "rois_3rd"
  top: "cas_roi_grid_P5S3"
  roi_pooling_param {
    pooled_w: 7
    pooled_h: 7
    spatial_scale: 0.0625 # 1/16
  }
  propagate_down: 1
  propagate_down: 0
}
layer {
  bottom: "cas_roi_grid_P3S3"
  bottom: "cas_roi_grid_P4S3"
  bottom: "cas_roi_grid_P5S3"
  top: "cas_roi_grid_S3"
  name: "cas_roi_grid_S3"
  type: "Eltwise"
  # type: "Concat"
  # concat_param { axis: 1 }
}
layer {
  name: "cas_conv1_3x3_S3"
  type: "Convolution"
  bottom: "cas_roi_grid_S3"
  top: "cas_conv1_3x3_S3"
  param { name: "cas_conv1_s3_w" lr_mult: 4.0 decay_mult: 1.0 }
  param { name: "cas_conv1_s3_b" lr_mult: 8.0 decay_mult: 0 }
  convolution_param {
    num_output: 1024
    kernel_size: 8 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" value: 0 }
  }
}
layer {
  name: "cas_conv1_3x3_S3/relu"
  type: "ReLU"
  bottom: "cas_conv1_3x3_S3"
  top: "cas_conv1_3x3_S3"
}
layer {
  name: "cas_conv2_3x3_S3"
  type: "Convolution"
  bottom: "cas_conv1_3x3_S3"
  top: "cas_conv2_3x3_S3"
  param { name: "cas_conv2_s3_w" lr_mult: 4.0 decay_mult: 1.0 }
  param { name: "cas_conv2_s3_b" lr_mult: 8.0 decay_mult: 0 }
  convolution_param {
    num_output: 1024
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" value: 0 }
  }
}
layer {
  name: "cas_conv2_3x3_S3/relu"
  type: "ReLU"
  bottom: "cas_conv2_3x3_S3"
  top: "cas_conv2_3x3_S3"
}
layer {
  name: "cas_conv3_3x3_S3"
  type: "Convolution"
  bottom: "cas_conv2_3x3_S3"
  top: "cas_conv3_3x3_S3"
  param { name: "cas_conv3_s3_w" lr_mult: 4.0 decay_mult: 1.0 }
  param { name: "cas_conv3_s3_b" lr_mult: 8.0 decay_mult: 0 }
  convolution_param {
    num_output: 512
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.01 }
    bias_filler { type: "constant" value: 0 }
  }
}
layer {
  name: "cas_conv3_3x3_S3/relu"
  type: "ReLU"
  bottom: "cas_conv3_3x3_S3"
  top: "cas_conv3_3x3_S3"
}
layer {
  name: "cls_pred_3rd_g1"
  type: "Convolution"
  bottom: "cas_conv2_3x3_S3"
  top: "cls_pred_3rd_g1"
  param { name: "cls_pred_3rd_w1" lr_mult: 4.0 }
  param { name: "cls_pred_3rd_b1" lr_mult: 8.0 }
  convolution_param {
    num_output: 80
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: -1.0 }
  }
}
layer {
  name: "bbox_pred_3rd_g1"
  type: "Convolution"
  bottom: "cas_conv2_3x3_S3"
  top: "bbox_pred_3rd_g1"
  param { name: "bbox_pred_3rd_w1" lr_mult: 4.0 }
  param { name: "bbox_pred_3rd_b1" lr_mult: 8.0 }
  convolution_param {
    num_output: 8
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: 0.0 }
  }
}
layer {
  name: "cls_pred_3rd_g2"
  type: "Convolution"
  bottom: "cas_conv2_3x3_S3"
  top: "cls_pred_3rd_g2"
  param { name: "cls_pred_3rd_w2" lr_mult: 4.0 }
  param { name: "cls_pred_3rd_b2" lr_mult: 8.0 }
  convolution_param {
    num_output: 80
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: -1.0 }
  }
}
layer {
  name: "bbox_pred_3rd_g2"
  type: "Convolution"
  bottom: "cas_conv2_3x3_S3"
  top: "bbox_pred_3rd_g2"
  param { name: "bbox_pred_3rd_w2" lr_mult: 4.0 }
  param { name: "bbox_pred_3rd_b2" lr_mult: 8.0 }
  convolution_param {
    num_output: 8
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: 0.0 }
  }
}
layer {
  name: "cls_pred_3rd_g3"
  type: "Convolution"
  bottom: "cas_conv2_3x3_S3"
  top: "cls_pred_3rd_g3"
  param { name: "cls_pred_3rd_w3" lr_mult: 4 }
  param { name: "cls_pred_3rd_b3" lr_mult: 8 }
  convolution_param {
    num_output: 80
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: -1.0 }
  }
}
layer {
  name: "bbox_pred_3rd_g3"
  type: "Convolution"
  bottom: "cas_conv2_3x3_S3"
  top: "bbox_pred_3rd_g3"
  param { name: "bbox_pred_3rd_w3" lr_mult: 4 }
  param { name: "bbox_pred_3rd_b3" lr_mult: 8 }
  convolution_param {
    num_output: 8
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: 0.0 }
  }
}
layer {
  name: "cls_pred_3rd_g4"
  type: "Convolution"
  bottom: "cas_conv3_3x3_S3"
  top: "cls_pred_3rd_g4"
  param { name: "cls_pred_3rd_w4" lr_mult: 4 }
  param { name: "cls_pred_3rd_b4" lr_mult: 8 }
  convolution_param {
    num_output: 80
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: -1.0 }
  }
}
layer {
  name: "bbox_pred_3rd_g4"
  type: "Convolution"
  bottom: "cas_conv3_3x3_S3"
  top: "bbox_pred_3rd_g4"
  param { name: "bbox_pred_3rd_w4" lr_mult: 4 }
  param { name: "bbox_pred_3rd_b4" lr_mult: 8 }
  convolution_param {
    num_output: 8
    kernel_size: 1 pad: 0 stride: 1
    weight_filler { type: "gaussian" std: 0.001 }
    bias_filler { type: "constant" value: 0.0 }
  }
}
layer {
  name: "loss_cls_3rd_p1"
  bottom: "cls_pred_3rd_g1"
  bottom: "proposal_labels_3rd"
  top: "loss_cls_3rd_p1"
  # type: "SigmoidCrossEntropyLoss"
  type: "FocalLoss"
  loss_weight: 0.25
  propagate_down: 1
  propagate_down: 0
  focal_loss_param { mode: REDUCTION gamma: 2.0 beta: 1.0 }
  loss_param { ignore_label: -1 normalize: true normalization: BATCH_SIZE }
}
layer {
  name: "proposal_labels_3rd_r2"
  type: "AdditiveFocal"
  bottom: "cls_pred_3rd_g1"
  bottom: "proposal_labels_3rd"
  top: "proposal_labels_3rd_r2"
  top: "proposal_weights_3rd_r2"
  focal_loss_param { mode: REDUCTION gamma: 2.0 beta: 1.0 }
}
layer {
  name: "loss_cls_3rd_p2"
  bottom: "cls_pred_3rd_g2"
  bottom: "proposal_labels_3rd_r2"
  bottom: "proposal_weights_3rd_r2"
  top: "loss_cls_3rd_p2"
  type: "WeightL2Loss"
  loss_weight: 0.25
  propagate_down: 1
  propagate_down: 0
  propagate_down: 0
  loss_param { ignore_label: -1 normalize: true normalization: VALID }
}
layer {
  name: "cls_pred_3rd_s2"
  bottom: "cls_pred_3rd_g1"
  bottom: "cls_pred_3rd_g2"
  top: "cls_pred_3rd_s2"
  type: "Eltwise"
}
layer {
  name: "proposal_labels_3rd_r3"
  type: "AdditiveFocal"
  bottom: "cls_pred_3rd_s2"
  bottom: "proposal_labels_3rd"
  top: "proposal_labels_3rd_r3"
  top: "proposal_weights_3rd_r3"
  focal_loss_param { mode: REDUCTION gamma: 2.0 beta: 1.0 }
}
layer {
  name: "loss_cls_3rd_p3"
  bottom: "cls_pred_3rd_g3"
  bottom: "proposal_labels_3rd_r3"
  bottom: "proposal_weights_3rd_r3"
  top: "loss_cls_3rd_p3"
  type: "WeightL2Loss"
  loss_weight: 0.25
  propagate_down: 1
  propagate_down: 0
  propagate_down: 0
  loss_param { ignore_label: -1 normalize: true normalization: VALID }
}
layer {
  name: "cls_pred_3rd_s3"
  bottom: "cls_pred_3rd_s2"
  bottom: "cls_pred_3rd_g3"
  top: "cls_pred_3rd_s3"
  type: "Eltwise" 
} 
layer {
  name: "proposal_labels_3rd_r4"
  type: "AdditiveFocal"
  bottom: "cls_pred_3rd_s3"
  bottom: "proposal_labels_3rd"
  top: "proposal_labels_3rd_r4"
  top: "proposal_weights_3rd_r4"
  focal_loss_param { mode: REDUCTION gamma: 2.0 beta: 1.0 }
}
layer {
  name: "loss_cls_3rd_p4"
  bottom: "cls_pred_3rd_g4"
  bottom: "proposal_labels_3rd_r4"
  bottom: "proposal_weights_3rd_r4"
  top: "loss_cls_3rd_p4"
  type: "WeightL2Loss"
  loss_weight: 0.25
  propagate_down: 1
  propagate_down: 0
  propagate_down: 0
  loss_param { ignore_label: -1 normalize: true normalization: VALID }
}
layer {
  name: "cls_pred_3rd"
  bottom: "cls_pred_3rd_s3"
  bottom: "cls_pred_3rd_g4"
  top: "cls_pred_3rd"
  type: "Eltwise"
}
layer {
  name: "cls_accuracy_3rd"
  type: "BalancedAccuracy"
  bottom: "cls_pred_3rd"
  bottom: "proposal_labels_3rd"
  top: "cls_accuracy_3rd"
}
layer {
  name: "loss_bbox_3rd_p1"
  type: "SmoothL1Loss"
  bottom: "bbox_pred_3rd_g1"
  bottom: "proposal_targets_3rd"
  bottom: "box_inside_weights_3rd"
  bottom: "box_inside_weights_3rd"
  top: "loss_bbox_3rd_p1"
  loss_weight: 0.25
  propagate_down: 1
  propagate_down: 0
  propagate_down: 0
  propagate_down: 0
}
layer {
  name: "proposal_targets_3rd_r2"
  type: "AdditiveSmoothL1"
  bottom: "bbox_pred_3rd_g1"
  bottom: "proposal_targets_3rd"
  top: "proposal_targets_3rd_r2"
}
layer {
  name: "loss_bbox_3rd_p2"
  type: "SmoothL1Loss"
  bottom: "bbox_pred_3rd_g2"
  bottom: "proposal_targets_3rd_r2"
  bottom: "box_inside_weights_3rd"
  bottom: "box_outside_weights_3rd"
  top: "loss_bbox_3rd_p2"
  loss_weight: 0.25
  propagate_down: 1
  propagate_down: 0
  propagate_down: 0
  propagate_down: 0
} 
layer {
  name: "bbox_pred_3rd_s2"
  bottom: "bbox_pred_3rd_g1"
  bottom: "bbox_pred_3rd_g2"
  top: "bbox_pred_3rd_s2"
  type: "Eltwise"
}
layer {
  name: "proposal_targets_3rd_r3"
  type: "AdditiveSmoothL1"
  bottom: "bbox_pred_3rd_s2"
  bottom: "proposal_targets_3rd"
  top: "proposal_targets_3rd_r3"
}
layer {
  name: "loss_bbox_3rd_p3"
  type: "SmoothL1Loss"
  bottom: "bbox_pred_3rd_g3"
  bottom: "proposal_targets_3rd_r3"
  bottom: "box_inside_weights_3rd"
  bottom: "box_outside_weights_3rd"
  top: "loss_bbox_3rd_p3"
  loss_weight: 0.25
  propagate_down: 1
  propagate_down: 0
  propagate_down: 0
  propagate_down: 0
} 
layer {
  name: "bbox_pred_3rd_s3"
  bottom: "bbox_pred_3rd_s2"
  bottom: "bbox_pred_3rd_g3"
  top: "bbox_pred_3rd_s3"
  type: "Eltwise"
}
layer {
  name: "proposal_targets_3rd_r4"
  type: "AdditiveSmoothL1"
  bottom: "bbox_pred_3rd_s3"
  bottom: "proposal_targets_3rd"
  top: "proposal_targets_3rd_r4"
}
layer {
  name: "loss_bbox_3rd_p4"
  type: "SmoothL1Loss"
  bottom: "bbox_pred_3rd_g4"
  bottom: "proposal_targets_3rd_r4"
  bottom: "box_inside_weights_3rd"
  bottom: "box_outside_weights_3rd"
  top: "loss_bbox_3rd_p4"
  loss_weight: 0.25
  propagate_down: 1
  propagate_down: 0
  propagate_down: 0
  propagate_down: 0
} 
layer {
  name: "bbox_pred_3rd"
  bottom: "bbox_pred_3rd_s3"
  bottom: "bbox_pred_3rd_g4"
  top: "bbox_pred_3rd"
  type: "Eltwise"
}
layer {
  name: "bbox_iou_3rd"
  type: "BboxAccuracy"
  bottom: "bbox_pred_3rd"
  bottom: "rois_3rd"
  bottom: "match_gt_boxes_3rd"
  top: "bbox_iou_3rd"
  top: "bbox_iou_pre_3rd"
  bbox_reg_param {
    cls_aware: false
    bbox_mean: 0 bbox_mean: 0 bbox_mean: 0 bbox_mean: 0
    bbox_std: 0.033 bbox_std: 0.033 bbox_std: 0.067 bbox_std: 0.067
  }
}

layer {
  name: 'silence'
  type: 'Silence'
  bottom: "det_cls_scores"
  bottom: "det_scores_all"
  bottom: "others"
}

